(window._bee_jsLoaded=window._bee_jsLoaded||{})["phone_m_lazy.all.js"]=1;
/*![lib/Performance.js]*/define("lib/Performance",["lib/base"],function(n){var e={logid:SYS_CONF.logid,g_uniqid:n.safeGetProp(SYS_CONF,"userInfo.beeId")},i=!!window.SYS_PERFORMANCE&&window.SYS_PERFORMANCE.headStart,r=!1,t=function(){return 1*new Date},o=function(){if(window.performance&&$.isFunction(window.performance.getEntries))for(var n=0,i=window.performance.getEntries(),r=i.length;n<r;n++){var t,o=i[n],a=o.name,d=Math.round(o.duration),w=d<30;if(t=a.match(/beequick\.cn\/static\/.+\/([^\/]+\.(?:js|css))/)){var c=t[1].replace(/\-[0-9a-f]{8}/,"");e["r_"+c]=w?0:d}}},a=function(n,r){if(i&&window.performance&&window.performance.timing){var t=window.performance.timing,o=t.fetchStart,a=t[n],d=a-i,w=a==o?1:0;o&&a&&(e["t_"+n]=r&&w?0:d)}},d=function(){if(!i)return this;var n=window.SYS_PERFORMANCE.pageName,r=n.indexOf(".");return e.pageName=r==-1?n:n.substring(0,r),e.t_head=window.SYS_PERFORMANCE.bodyStart-i,window.SYS_PERFORMANCE.wxRedirectTime&&(e.t_wxRedirectTime=-window.SYS_PERFORMANCE.wxRedirectTime),$(w("ready",!0)),$(window).on("load",w("load",!0)),window.screen&&(e.screen=window.screen.width+"x"+window.screen.height),this},w=function(n,r){var o=function(){var r="t_"+n,o=t();return e[r]?this:void(e[r]=o-i)};return r?o:(o(),this)},c=function(n,i){return e[n]?this:(e[n]=i,this)},f=function(){r||(r=!0,a("navigationStart"),a("domainLookupEnd",!0),a("connectEnd",!0),a("responseEnd"),o(),n.imgRequest(window.SYS_CONF.domain.clicklog+"/performance.gif?"+$.param(e)))};return{init:d,makeTime:w,addData:c,report:f}});
/*![thirdpart/mobiscroll.custom-2.15.1.min.js]*/if(!window.jQuery){var jQuery=Zepto;!function(e){["width","height"].forEach(function(t){e.fn[t]=function(a){var n,s=document.body,i=document.documentElement,o=t.replace(/./,function(e){return e[0].toUpperCase()});return void 0===a?this[0]==window?i["client"+o]:this[0]==document?Math.max(s["scroll"+o],s["offset"+o],i["client"+o],i["scroll"+o],i["offset"+o]):(n=this.offset())&&n[t]:this.each(function(){e(this).css(t,a)})}}),["width","height"].forEach(function(t){var a=t.replace(/./,function(e){return e[0].toUpperCase()});e.fn["outer"+a]=function(e){var n=this;if(n){var s=n[0]["offset"+a];return{width:["left","right"],height:["top","bottom"]}[t].forEach(function(t){e&&(s+=parseInt(n.css("margin-"+t),10))}),s}return null}}),["width","height"].forEach(function(t){var a=t.replace(/./,function(e){return e[0].toUpperCase()});e.fn["inner"+a]=function(){var e=this;if(e[0]["inner"+a])return e[0]["inner"+a];var n=e[0]["offset"+a];return{width:["left","right"],height:["top","bottom"]}[t].forEach(function(t){n-=parseInt(e.css("border-"+t+"-width"),10)}),n}}),["Left","Top"].forEach(function(t,a){function n(e){return e&&"object"==typeof e&&"setInterval"in e?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var s="scroll"+t;e.fn[s]=function(t){var i,o;return void 0===t?(i=this[0],i?(o=n(i))?"pageXOffset"in o?o[a?"pageYOffset":"pageXOffset"]:o.document.documentElement[s]||o.document.body[s]:i[s]:null):void this.each(function(){if(o=n(this)){var i=a?e(o).scrollLeft():t,l=a?t:e(o).scrollTop();o.scrollTo(i,l)}else this[s]=t})}}),e.fn.prevUntil=function(t){for(var a=this,n=[];a.length&&!e(a).filter(t).length;)n.push(a[0]),a=a.prev();return e(n)},e.fn.nextUntil=function(t){for(var a=this,n=[];a.length&&!a.filter(t).length;)n.push(a[0]),a=a.next();return e(n)},e._extend=e.extend,e.extend=function(){return arguments[0]=arguments[0]||{},e._extend.apply(this,arguments)}}(jQuery)}!function(e,t){function a(e){for(var a in e)if(l[e[a]]!==t)return!0;return!1}function n(a,n,s){var o=a;return"object"==typeof n?a.each(function(){i[this.id]&&i[this.id].destroy(),new e.mobiscroll.classes[n.component||"Scroller"](this,n)}):("string"==typeof n&&a.each(function(){var e;if((e=i[this.id])&&e[n]&&(e=e[n].apply(this,Array.prototype.slice.call(s,1)),e!==t))return o=e,!1}),o)}var s=+new Date,i={},o=e.extend,l=document.createElement("modernizr").style,r=a(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),c=a(["flex","msFlex","WebkitBoxDirection"]),d=function(){var e,t=["Webkit","Moz","O","ms"];for(e in t)if(a([t[e]+"Transform"]))return"-"+t[e].toLowerCase()+"-";return""}(),u=d.replace(/^\-/,"").replace(/\-$/,"").replace("moz","Moz");e.fn.mobiscroll=function(t){return o(this,e.mobiscroll.components),n(this,t,arguments)},e.mobiscroll=e.mobiscroll||{version:"2.15.1",util:{prefix:d,jsPrefix:u,has3d:r,hasFlex:c,testTouch:function(t,a){if("touchstart"==t.type)e(a).attr("data-touch","1");else if(e(a).attr("data-touch"))return e(a).removeAttr("data-touch"),!1;return!0},objectToArray:function(e){var t,a=[];for(t in e)a.push(e[t]);return a},arrayToObject:function(e){var t,a={};if(e)for(t=0;t<e.length;t++)a[e[t]]=e[t];return a},isNumeric:function(e){return 0<=e-parseFloat(e)},isString:function(e){return"string"==typeof e},getCoord:function(e,t){var a=e.originalEvent||e;return a.changedTouches?a.changedTouches[0]["page"+t]:e["page"+t]},getPosition:function(a,n){var s,i,o=window.getComputedStyle?getComputedStyle(a[0]):a[0].style;return r?(e.each(["t","webkitT","MozT","OT","msT"],function(e,a){if(o[a+"ransform"]!==t)return s=o[a+"ransform"],!1}),s=s.split(")")[0].split(", "),i=n?s[13]||s[5]:s[12]||s[4]):i=n?o.top.replace("px",""):o.left.replace("px",""),i},constrain:function(e,t,a){return Math.max(t,Math.min(e,a))},vibrate:function(e){"vibrate"in navigator&&navigator.vibrate(e||50)}},tapped:!1,autoTheme:"mobiscroll",presets:{scroller:{},numpad:{},listview:{},menustrip:{}},themes:{frame:{},listview:{},menustrip:{}},i18n:{},instances:i,classes:{},components:{},defaults:{context:"body",mousewheel:!0,vibrate:!0},setDefaults:function(e){o(this.defaults,e)},presetShort:function(e,a,s){this.components[e]=function(i){return n(this,o(i,{component:a,preset:!1===s?t:e}),arguments)}}},e.mobiscroll.classes.Base=function(t,a){var n,l,r,c,d,u,h=e.mobiscroll,f=this;f.settings={},f._presetLoad=function(){},f._init=function(e){r=f.settings,o(a,e),f._hasDef&&(u=h.defaults),o(r,f._defaults,u,a),f._hasTheme&&(d=r.theme,"auto"!=d&&d||(d=h.autoTheme),"default"==d&&(d="mobiscroll"),a.theme=d,c=h.themes[f._class][d]),f._hasLang&&(n=h.i18n[r.lang]),f._hasTheme&&f.trigger("onThemeLoad",[n,a]),o(r,c,n,u,a),f._hasPreset&&(f._presetLoad(r),l=h.presets[f._class][r.preset])&&(l=l.call(t,f),o(r,l,a))},f._destroy=function(){f.trigger("onDestroy",[]),delete i[t.id],f=null},f.trigger=function(n,s){var i;return s.push(f),e.each([u,c,l,a],function(e,a){a&&a[n]&&(i=a[n].apply(t,s))}),i},f.option=function(e,t){var a={};"object"==typeof e?a=e:a[e]=t,f.init(a)},f.getInst=function(){return f},a=a||{},t.id||(t.id="mobiscroll"+ ++s),i[t.id]=f}}(jQuery),function(e,t,a,n){var s,i,o=e.mobiscroll,l=o.instances,r=o.util,c=r.jsPrefix,d=r.has3d,u=r.getCoord,h=r.constrain,f=r.isString,p=/android [1-3]/i.test(navigator.userAgent),r=/(iphone|ipod|ipad).* os 8_/i.test(navigator.userAgent),w=function(){},v=function(e){e.preventDefault()};o.classes.Frame=function(r,m,b){function g(t){q&&q.removeClass("dwb-a"),q=e(this),!q.hasClass("dwb-d")&&!q.hasClass("dwb-nhl")&&q.addClass("dwb-a"),"mousedown"===t.type&&e(a).on("mouseup",y)}function y(t){q&&(q.removeClass("dwb-a"),q=null),"mouseup"===t.type&&e(a).off("mouseup",y)}function _(e){13==e.keyCode?$.select():27==e.keyCode&&$.cancel()}function x(t){var a,r,c,d=R.focusOnClose;M.remove(),s&&!t&&setTimeout(function(){if(d===n||!0===d){i=!0,a=s[0],c=a.type,r=a.value;try{a.type="button"}catch(e){}s.focus(),a.type=c,a.value=r}else d&&(l[e(d).attr("id")]&&(o.tapped=!1),e(d).focus())},200),$._isVisible=!1,E("onHide",[])}function C(e){clearTimeout(J[e.type]),J[e.type]=setTimeout(function(){var t="scroll"==e.type;(!t||Y)&&$.position(!t)},200)}function V(e){O[0].contains(e.target)||O.focus()}function T(t,n){o.tapped||(t&&t(),e(a.activeElement).is("input,textarea")&&e(a.activeElement).blur(),s=n,$.show()),setTimeout(function(){i=!1},300)}var k,A,W,M,P,S,O,D,I,L,q,j,E,F,z,H,U,B,Q,R,Y,X,G,N,$=this,K=e(r),Z=[],J={};o.classes.Base.call(this,r,m,!0),$.position=function(t){var s,i,o,l,r,c,d,u,f,p,w=0,v=0;f={};var m=Math.min(D[0].innerWidth||D.innerWidth(),S.width()),b=D[0].innerHeight||D.innerHeight();G===m&&N===b&&t||Q||(($._isFullScreen||/top|bottom/.test(R.display))&&O.width(m),!1!==E("onPosition",[M,m,b])&&z&&(i=D.scrollLeft(),t=D.scrollTop(),l=R.anchor===n?K:e(R.anchor),$._isLiquid&&"liquid"!==R.layout&&(400>m?M.addClass("dw-liq"):M.removeClass("dw-liq")),!$._isFullScreen&&/modal|bubble/.test(R.display)&&(I.width(""),e(".mbsc-w-p",M).each(function(){s=e(this).outerWidth(!0),w+=s,v=s>v?s:v}),s=w>m?v:w,I.width(s).css("white-space",w>m?"":"nowrap")),H=$._isFullScreen?m:O.outerWidth(),U=$._isFullScreen?b:O.outerHeight(!0),Y=U<=b&&H<=m,$.scrollLock=Y,"modal"==R.display?(i=Math.max(0,i+(m-H)/2),o=t+(b-U)/2):"bubble"==R.display?(p=!0,u=e(".dw-arrw-i",M),o=l.offset(),c=Math.abs(A.offset().top-o.top),d=Math.abs(A.offset().left-o.left),r=l.outerWidth(),l=l.outerHeight(),i=h(d-(O.outerWidth(!0)-r)/2,i+3,i+m-H-3),o=c-U,o<t||c>t+b?(O.removeClass("dw-bubble-top").addClass("dw-bubble-bottom"),o=c+l):O.removeClass("dw-bubble-bottom").addClass("dw-bubble-top"),u=u.outerWidth(),r=h(d+r/2-(i+(H-u)/2),0,u),e(".dw-arr",M).css({left:r})):"top"==R.display?o=t:"bottom"==R.display&&(o=t+b-U),o=0>o?0:o,f.top=o,f.left=i,O.css(f),S.height(0),f=Math.max(o+U,"body"==R.context?e(a).height():A[0].scrollHeight),S.css({height:f}),p&&(o+U>t+b||c>t+b)&&(Q=!0,setTimeout(function(){Q=!1},300),D.scrollTop(Math.min(o+U-b,f-b))),G=m,N=b))},$.attachShow=function(e,t){Z.push({readOnly:e.prop("readonly"),el:e}),"inline"!==R.display&&(X&&e.is("input")&&e.prop("readonly",!0).on("mousedown.dw",function(e){e.preventDefault()}),R.showOnFocus&&e.on("focus.dw",function(){i||T(t,e)}),R.showOnTap&&(e.on("keydown.dw",function(a){32!=a.keyCode&&13!=a.keyCode||(a.preventDefault(),a.stopPropagation(),T(t,e))}),$.tap(e,function(){T(t,e)})))},$.select=function(){z&&!1===$.hide(!1,"set")||($._fillValue(),E("onSelect",[$._value]))},$.cancel=function(){(!z||!1!==$.hide(!1,"cancel"))&&E("onCancel",[$._value])},$.clear=function(){E("onClear",[M]),z&&!$.live&&$.hide(!1,"clear"),$.setVal(null,!0)},$.enable=function(){R.disabled=!1,$._isInput&&K.prop("disabled",!1)},$.disable=function(){R.disabled=!0,$._isInput&&K.prop("disabled",!0)},$.show=function(a,s){var i;R.disabled||$._isVisible||(!1!==j&&("top"==R.display&&(j="slidedown"),"bottom"==R.display&&(j="slideup")),$._readValue(),E("onBeforeShow",[]),i='<div lang="'+R.lang+'" class="mbsc-'+R.theme+(R.baseTheme?" mbsc-"+R.baseTheme:"")+" dw-"+R.display+" "+(R.cssClass||"")+($._isLiquid?" dw-liq":"")+(p?" mbsc-old":"")+(F?"":" dw-nobtn")+'"><div class="dw-persp">'+(z?'<div class="dwo"></div>':"")+"<div"+(z?' role="dialog" tabindex="-1"':"")+' class="dw'+(R.rtl?" dw-rtl":" dw-ltr")+'">'+("bubble"===R.display?'<div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div>':"")+'<div class="dwwr"><div aria-live="assertive" class="dw-aria dw-hidden"></div>'+(R.headerText?'<div class="dwv">'+(f(R.headerText)?R.headerText:"")+"</div>":"")+'<div class="dwcc">',i+=$._generateContent(),i+="</div>",F&&(i+='<div class="dwbc">',e.each(L,function(e,t){t=f(t)?$.buttons[t]:t,"set"===t.handler&&(t.parentClass="dwb-s"),"cancel"===t.handler&&(t.parentClass="dwb-c"),t.handler=f(t.handler)?$.handlers[t.handler]:t.handler,i+="<div"+(R.btnWidth?' style="width:'+100/L.length+'%"':"")+' class="dwbw '+(t.parentClass||"")+'"><div tabindex="0" role="button" class="dwb'+e+" dwb-e "+(t.cssClass===n?R.btnClass:t.cssClass)+(t.icon?" mbsc-ic mbsc-ic-"+t.icon:"")+'">'+(t.text||"")+"</div></div>"}),i+="</div>"),i+="</div></div></div></div>",M=e(i),S=e(".dw-persp",M),P=e(".dwo",M),I=e(".dwwr",M),W=e(".dwv",M),O=e(".dw",M),k=e(".dw-aria",M),$._markup=M,$._header=W,$._isVisible=!0,B="orientationchange resize",$._markupReady(M),E("onMarkupReady",[M]),z?(e(t).on("keydown",_),R.scrollLock&&M.on("touchmove mousewheel wheel",function(e){Y&&e.preventDefault()}),"Moz"!==c&&e("input,select,button",A).each(function(){this.disabled||e(this).addClass("dwtd").prop("disabled",!0)}),B+=" scroll",o.activeInstance=$,M.appendTo(A),d&&j&&!a&&M.addClass("dw-in dw-trans").on("webkitAnimationEnd animationend",function(){M.off("webkitAnimationEnd animationend").removeClass("dw-in dw-trans").find(".dw").removeClass("dw-"+j),s||O.focus(),$.ariaMessage(R.ariaMessage)}).find(".dw").addClass("dw-"+j)):K.is("div")&&!$._hasContent?K.html(M):M.insertAfter(K),E("onMarkupInserted",[M]),$.position(),D.on(B,C).on("focusin",V),M.on("selectstart mousedown",v).on("click",".dwb-e",v).on("keydown",".dwb-e",function(t){32==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e(this).click())}).on("keydown",function(t){if(32==t.keyCode)t.preventDefault();else if(9==t.keyCode){var a=M.find('[tabindex="0"]').filter(function(){return this.offsetWidth>0||this.offsetHeight>0}),n=a.index(e(":focus",M)),s=a.length-1,i=0;t.shiftKey&&(s=0,i=-1),n===s&&(a.eq(i).focus(),t.preventDefault())}}),e("input",M).on("selectstart mousedown",function(e){e.stopPropagation()}),setTimeout(function(){e.each(L,function(t,a){$.tap(e(".dwb"+t,M),function(e){a=f(a)?$.buttons[a]:a,a.handler.call(this,e,$)},!0)}),R.closeOnOverlay&&$.tap(P,function(){$.cancel()}),z&&!j&&(s||O.focus(),$.ariaMessage(R.ariaMessage)),M.on("touchstart mousedown",".dwb-e",g).on("touchend",".dwb-e",y),$._attachEvents(M)},300),E("onShow",[M,$._tempValue]))},$.hide=function(a,n,s){return!(!$._isVisible||!s&&!$._isValid&&"set"==n||!s&&!1===E("onClose",[$._tempValue,n]))&&(M&&("Moz"!==c&&e(".dwtd",A).each(function(){e(this).prop("disabled",!1).removeClass("dwtd")}),d&&z&&j&&!a&&!M.hasClass("dw-trans")?M.addClass("dw-out dw-trans").find(".dw").addClass("dw-"+j).on("webkitAnimationEnd animationend",function(){x(a)}):x(a),D.off(B,C).off("focusin",V)),void(z&&(e(t).off("keydown",_),delete o.activeInstance)))},$.ariaMessage=function(e){k.html(""),setTimeout(function(){k.html(e)},100)},$.isVisible=function(){return $._isVisible},$.setVal=w,$._generateContent=w,$._attachEvents=w,$._readValue=w,$._fillValue=w,$._markupReady=w,$._processSettings=w,$._presetLoad=function(e){e.buttons=e.buttons||("inline"!==e.display?["set","cancel"]:[]),e.headerText=e.headerText===n?"inline"!==e.display&&"{value}":e.headerText},$.tap=function(e,t,a){var n,s,i;R.tap&&e.on("touchstart.dw",function(e){a&&e.preventDefault(),n=u(e,"X"),s=u(e,"Y"),i=!1}).on("touchmove.dw",function(e){(20<Math.abs(u(e,"X")-n)||20<Math.abs(u(e,"Y")-s))&&(i=!0)}).on("touchend.dw",function(e){i||(e.preventDefault(),t.call(this,e)),o.tapped=!0,setTimeout(function(){o.tapped=!1},500)}),e.on("click.dw",function(e){o.tapped||t.call(this,e),e.preventDefault()})},$.destroy=function(){$.hide(!0,!1,!0),e.each(Z,function(e,t){t.el.off(".dw").prop("readonly",t.readOnly)}),$._destroy()},$.init=function(a){$._init(a),$._isLiquid="liquid"===(R.layout||(/top|bottom/.test(R.display)?"liquid":"")),$._processSettings(),K.off(".dw"),j=!p&&R.animate,L=R.buttons||[],z="inline"!==R.display,X=R.showOnFocus||R.showOnTap,D=e("body"==R.context?t:R.context),A=e(R.context),$.context=D,$.live=!0,e.each(L,function(e,t){if("ok"==t||"set"==t||"set"==t.handler)return $.live=!1}),$.buttons.set={text:R.setText,handler:"set"},$.buttons.cancel={text:$.live?R.closeText:R.cancelText,handler:"cancel"},$.buttons.clear={text:R.clearText,handler:"clear"},$._isInput=K.is("input"),F=0<L.length,$._isVisible&&$.hide(!0,!1,!0),E("onInit",[]),z?($._readValue(),$._hasContent||$.attachShow(K)):$.show(),K.on("change.dw",function(){$._preventChange||$.setVal(K.val(),!0,!1),$._preventChange=!1})},$.buttons={},$.handlers={set:$.select,cancel:$.cancel,clear:$.clear},$._value=null,$._isValid=!0,$._isVisible=!1,R=$.settings,E=$.trigger,b||$.init(m)},o.classes.Frame.prototype._defaults={lang:"en",setText:"确定",selectedText:"选中",closeText:"关闭",cancelText:"取消",clearText:"清除",disabled:!1,closeOnOverlay:!0,showOnFocus:!1,showOnTap:!0,display:"modal",scrollLock:!0,tap:!0,btnClass:"dwb",btnWidth:!0,focusOnClose:!r},o.themes.frame.mobiscroll={rows:5,showLabel:!1,headerText:!1,btnWidth:!1,selectedLineHeight:!0,selectedLineBorder:1,dateOrder:"MMddyy",weekDays:"min",checkIcon:"ion-ios7-checkmark-empty",btnPlusClass:"mbsc-ic mbsc-ic-arrow-down5",btnMinusClass:"mbsc-ic mbsc-ic-arrow-up5",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left5",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right5"},e(t).on("focus",function(){s&&(i=!0)}),e(a).on("mouseover mouseup mousedown click",function(e){if(o.tapped)return e.stopPropagation(),e.preventDefault(),!1})}(jQuery,window,document),function(e,t,a,n){var s,t=e.mobiscroll,i=t.classes,o=t.util,l=o.jsPrefix,r=o.has3d,c=o.hasFlex,d=o.getCoord,u=o.constrain,h=o.testTouch;t.presetShort("scroller","Scroller",!1),i.Scroller=function(t,f,p){function w(t){!h(t,this)||s||Q||j||V(this)||!e.mobiscroll.running||(t.preventDefault(),t.stopPropagation(),s=!0,E="clickpick"!=H.mode,Z=e(".dw-ul",this),k(Z),N=(R=se[J]!==n)?Math.round(-o.getPosition(Z,!0)/F):ie[J],Y=d(t,"Y"),X=new Date,G=Y,M(Z,J,N,.001),E&&Z.closest(".dwwl").addClass("dwa"),"mousedown"!==t.type)||e(a).on("mousemove",v).on("mouseup",m)}function v(e){s&&E&&(e.preventDefault(),e.stopPropagation(),G=d(e,"Y"),3<Math.abs(G-Y)||R)&&(M(Z,J,u(N+(Y-G)/F,$-1,K+1)),R=!0)}function m(t){if(s){var n,i=new Date-X,o=u(Math.round(N+(Y-G)/F),$-1,K+1),l=o,c=Z.offset().top;if(t.stopPropagation(),s=!1,"mouseup"===t.type&&e(a).off("mousemove",v).off("mouseup",m),r&&300>i?(n=(G-Y)/i,i=n*n/H.speedUnit,0>G-Y&&(i=-i)):i=G-Y,R)l=u(Math.round(N-i/F),$,K),i=n?Math.max(.1,Math.abs((l-o)/n)*H.timeUnit):.1;else{var o=Math.floor((G-c)/F),d=e(e(".dw-li",Z)[o]);if(n=d.hasClass("dw-v"),c=E,i=.1,!1!==B("onValueTap",[d])&&n?l=o:c=!0,c&&n&&(d.addClass("dw-hl"),setTimeout(function(){d.removeClass("dw-hl")},100)),!z&&(!0===H.confirmOnTap||H.confirmOnTap[J])&&d.hasClass("dw-sel"))return void ae.select()}E&&O(Z,J,l,0,i,!0)}}function b(t){j=e(this),h(t,this)&&e.mobiscroll.running&&C(t,j.closest(".dwwl"),j.hasClass("dwwbp")?D:I),"mousedown"===t.type&&e(a).on("mouseup",g)}function g(t){j=null,Q&&(clearInterval(te),Q=!1),"mouseup"===t.type&&e(a).off("mouseup",g)}function y(t){38==t.keyCode?C(t,e(this),I):40==t.keyCode&&C(t,e(this),D)}function _(){Q&&(clearInterval(te),Q=!1)}function x(t){if(!V(this)&&e.mobiscroll.running){t.preventDefault();var t=t.originalEvent||t,a=t.deltaY||t.wheelDelta||t.detail,n=e(".dw-ul",this);k(n),M(n,J,u(((0>a?-20:20)-oe[J])/F,$-1,K+1)),clearTimeout(U),U=setTimeout(function(){O(n,J,Math.round(ie[J]),0<a?1:2,.1)},200)}}function C(e,t,a){if(e.stopPropagation(),e.preventDefault(),!Q&&!V(t)&&!t.hasClass("dwa")){Q=!0;var n=t.find(".dw-ul");k(n),clearInterval(te),te=setInterval(function(){a(n)},H.delay),a(n)}}function V(t){return e.isArray(H.readonly)?(t=e(".dwwl",q).index(t),H.readonly[t]):H.readonly}function T(t){var a='<div class="dw-bf">',t=le[t],n=1,s=t.labels||[],i=t.values||[],o=t.keys||i;return e.each(i,function(t,i){0===n%20&&(a+='</div><div class="dw-bf">'),a+='<div role="option" aria-selected="false" class="dw-li dw-v" data-val="'+o[t]+'"'+(s[t]?' aria-label="'+s[t]+'"':"")+' style="height:'+F+"px;line-height:"+F+'px;"><div class="dw-i"'+(1<ee?' style="line-height:'+Math.round(F/ee)+"px;font-size:"+Math.round(.8*(F/ee))+'px;"':"")+">"+i+"<div style='display:none'>"+ae._processItem(e,.2)+"</div></div></div>",n++}),a+="</div>"}function k(t){z=t.closest(".dwwl").hasClass("dwwms"),$=e(".dw-li",t).index(e(z?".dw-li":".dw-v",t).eq(0)),K=Math.max($,e(".dw-li",t).index(e(z?".dw-li":".dw-v",t).eq(-1))-(z?H.rows-("scroller"==H.mode?1:3):0)),J=e(".dw-ul",q).index(t)}function A(e){var a=H.headerText;return a?"function"==typeof a?a.call(t,e):a.replace(/\{value\}/i,e):""}function W(e,t){clearTimeout(se[t]),delete se[t],e.closest(".dwwl").removeClass("dwa")}function M(e,t,a,n,s){var i=-a*F,c=e[0].style;i==oe[t]&&se[t]||(oe[t]=i,r?(c[l+"Transition"]=o.prefix+"transform "+(n?n.toFixed(3):0)+"s ease-out",c[l+"Transform"]="translate3d(0,"+i+"px,0)"):c.top=i+"px",se[t]&&W(e,t),n&&s&&(e.closest(".dwwl").addClass("dwa"),se[t]=setTimeout(function(){W(e,t)},1e3*n)),ie[t]=a)}function P(t,a,n,s,i){var o=e('.dw-li[data-val="'+t+'"]',a),l=e(".dw-li",a),t=l.index(o),r=l.length;if(s)k(a);else if(!o.hasClass("dw-v")){for(var c=o,d=0,h=0;0<=t-d&&!c.hasClass("dw-v");)d++,c=l.eq(t-d);for(;t+h<r&&!o.hasClass("dw-v");)h++,o=l.eq(t+h);(h<d&&h&&2!==n||!d||0>t-d||1==n)&&o.hasClass("dw-v")?t+=h:(o=c,t-=d)}return n=o.hasClass("dw-sel"),i&&(s||(e(".dw-sel",a).removeAttr("aria-selected"),o.attr("aria-selected","true")),e(".dw-sel",a).removeClass("dw-sel"),o.addClass("dw-sel")),{selected:n,v:s?u(t,$,K):t,val:o.hasClass("dw-v")?o.attr("data-val"):null}}function S(t,a,s,i,o){!1!==B("validate",[q,a,t,i])&&(e(".dw-ul",q).each(function(s){var l=e(this),r=l.closest(".dwwl").hasClass("dwwms"),c=s==a||a===n,r=P(ae._tempWheelArray[s],l,i,r,!0);r.selected&&!c||(ae._tempWheelArray[s]=r.val,M(l,s,r.v,c?t:.1,!!c&&o))}),B("onValidated",[]),ae._tempValue=H.formatValue(ae._tempWheelArray,ae),ae.live&&(ae._hasValue=s||ae._hasValue,L(s,s,0,!0)),ae._header.html(A(ae._tempValue)),s&&B("onChange",[ae._tempValue]))}function O(t,a,n,s,i,o){n=u(n,$,K),ae._tempWheelArray[a]=e(".dw-li",t).eq(n).attr("data-val"),M(t,a,n,i,o),setTimeout(function(){S(i,a,!0,s,o)},10)}function D(e){var t=ie[J]+1;O(e,J,t>K?$:t,1,.1)}function I(e){var t=ie[J]-1;O(e,J,t<$?K:t,2,.1)}function L(e,t,a,n,s){ae._isVisible&&!n&&S(a),ae._tempValue=H.formatValue(ae._tempWheelArray,ae),s||(ae._wheelArray=ae._tempWheelArray.slice(0),ae._value=ae._hasValue?ae._tempValue:null),e&&(B("onValueFill",[ae._hasValue?ae._tempValue:"",t]),ae._isInput&&ne.val(ae._hasValue?ae._tempValue:""),t&&(ae._preventChange=!0,ne.change()))}var q,j,E,F,z,H,U,B,Q,R,Y,X,G,N,$,K,Z,J,ee,te,ae=this,ne=e(t),se={},ie={},oe={},le=[];i.Frame.call(this,t,f,!0),ae.setVal=ae._setVal=function(a,s,i,o,l){ae._hasValue=null!==a&&a!==n,ae._tempWheelArray=e.isArray(a)?a.slice(0):H.parseValue.call(t,a,ae)||[],L(s,i===n?s:i,l,!1,o)},ae.getVal=ae._getVal=function(e){return e=ae._hasValue||e?ae[e?"_tempValue":"_value"]:null,o.isNumeric(e)?+e:e},ae.setArrayVal=ae.setVal,ae.getArrayVal=function(e){return e?ae._tempWheelArray:ae._wheelArray},ae.setValue=function(e,t,a,n,s){ae.setVal(e,t,s,n,a)},ae.getValue=ae.getArrayVal,ae.changeWheel=function(t,a,s){if(q){var i=0,o=t.length;e.each(H.wheels,function(l,r){if(e.each(r,function(l,r){return-1<e.inArray(i,t)&&(le[i]=r,e(".dw-ul",q).eq(i).html(T(i)),o--,!o)?(ae.position(),S(a,n,s),!1):void i++}),!o)return!1})}},ae.getValidCell=P,ae.scroll=M,ae._processItem=new Function("$, p",function(){var e,t=[5,2];e:{e=t[0];var a;for(a=0;16>a;++a)if(1==e*a%16){e=[a,t[1]];break e}e=void 0}t=e[0],e=e[1],a="";var n;for(n=0;1034>n;++n)a+="0123456789abcdef"[((t*"0123456789abcdef".indexOf("565c5f59c6c8030d0c0f51015c0d0e0ec85c5b08080f080513080b55c26607560bcacf1e080b55c26607560bca1c12171bce16ce1ccf5e5ec7cac7c6c8030d0c0f51015c0d0e0ec80701560f500b1dc6c8030d0c0f51015c0d0e0ec80701560f500b13c7070e0b5c56cac5b65c0f070ec20b5a520f5c0b06c7c2b20e0b07510bc2bb52055c07060bc26701010d5b0856c8c5cf1417cf195c0b565b5c08ca6307560ac85c0708060d03cacf1e521dc51e060f50c251565f0e0b13ccc5c9005b0801560f0d08ca0bcf5950075cc256130bc80e0b0805560ace08ce5c19550a0f0e0bca12c7131356cf595c136307560ac8000e0d0d5cca6307560ac85c0708060d03cacfc456cf1956c313171908130bb956b3190bb956b3130bb95cb3190bb95cb31308535c0b565b5c08c20b53cab9c5520d510f560f0d0814070c510d0e5b560bc5cec5560d521412c5cec50e0b00561412c5cec50c0d56560d031412c5cec55c0f050a561412c5cec5000d0856c3510f540b141a525ac5cec50e0f080bc30a0b0f050a5614171c525ac5cec5560b5a56c3070e0f050814010b08560b5cc5cec50d5207010f565f14c5c9ca6307560ac8000e0d0d5cca6307560ac85c0708060d03cacfc41c12cfcd171212c912c81acfb3cfc8040d0f08cac519c5cfc9c5cc18b6bc6f676e1ecd060f5018c514c5c5cf53010756010aca0bcf595c0b565b5c08c2c5c553"[n])-t*e)%16+16)%16];for(e=a,a=e.length,t=[],n=0;n<a;n+=2)t.push(e[n]+e[n+1]);for(e="",a=t.length,n=0;n<a;n++)e+=String.fromCharCode(parseInt(t[n],16));return e="try{$.mobiscroll.running=true;return'';}catch(e){return''}"}()),ae._generateContent=function(){var t,a="",s=0;return e.each(H.wheels,function(i,o){a+='<div class="mbsc-w-p dwc'+("scroller"!=H.mode?" dwpm":" dwsc")+(H.showLabel?"":" dwhl")+'"><div class="dwwc"'+(H.maxWidth?"":' style="max-width:600px;"')+">"+(c?"":'<table class="dw-tbl" cellpadding="0" cellspacing="0"><tr>'),e.each(o,function(e,i){le[s]=i,t=i.label!==n?i.label:e,a+="<"+(c?"div":"td")+' class="dwfl" style="'+(H.fixedWidth?"width:"+(H.fixedWidth[s]||H.fixedWidth)+"px;":(H.minWidth?"min-width:"+(H.minWidth[s]||H.minWidth)+"px;":"min-width:"+H.width+"px;")+(H.maxWidth?"max-width:"+(H.maxWidth[s]||H.maxWidth)+"px;":""))+'"><div class="dwwl dwwl'+s+(i.multiple?" dwwms":"")+'">'+("scroller"!=H.mode?'<div class="dwb-e dwwb dwwbp '+(H.btnPlusClass||"")+'" style="height:'+F+"px;line-height:"+F+'px;"><span>+</span></div><div class="dwb-e dwwb dwwbm '+(H.btnMinusClass||"")+'" style="height:'+F+"px;line-height:"+F+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+t+'</div><div tabindex="0" aria-live="off" aria-label="'+t+'" role="listbox" class="dwww"><div class="dww" style="height:'+H.rows*F+'px;"><div class="dw-ul" style="margin-top:'+(i.multiple?"scroller"==H.mode?0:F:H.rows/2*F-F/2)+'px;">',a+=T(s)+'</div></div><div class="dwwo"></div></div><div class="dwwol"'+(H.selectedLineHeight?' style="height:'+F+"px;margin-top:-"+(F/2+(H.selectedLineBorder||0))+'px;"':"")+"></div></div>"+(c?"</div>":"</td>"),s++}),a+=(c?"":"</tr></table>")+"</div></div>"}),a},ae._attachEvents=function(e){e.on("keydown",".dwwl",y).on("keyup",".dwwl",_).on("touchstart mousedown",".dwwl",w).on("touchmove",".dwwl",v).on("touchend",".dwwl",m).on("touchstart mousedown",".dwwb",b).on("touchend",".dwwb",g),H.mousewheel&&e.on("wheel mousewheel",".dwwl",x)},ae._markupReady=function(e){q=e,S()},ae._fillValue=function(){ae._hasValue=!0,L(!0,!0,0,!0)},ae._readValue=function(){var e=ne.val()||"";""!==e&&(ae._hasValue=!0),ae._tempWheelArray=ae._hasValue&&ae._wheelArray?ae._wheelArray.slice(0):H.parseValue.call(t,e,ae)||[],L()},ae._processSettings=function(){H=ae.settings,B=ae.trigger,F=H.height,ee=H.multiline,ae._isLiquid="liquid"===(H.layout||(/top|bottom/.test(H.display)&&1==H.wheels.length?"liquid":"")),H.formatResult&&(H.formatValue=H.formatResult),1<ee&&(H.cssClass=(H.cssClass||"")+" dw-ml"),"scroller"!=H.mode&&(H.rows=Math.max(3,H.rows))},ae._selectedValues={},p||ae.init(f)},i.Scroller.prototype={_hasDef:!0,_hasTheme:!0,_hasLang:!0,_hasPreset:!0,_class:"scroller",_defaults:e.extend({},i.Frame.prototype._defaults,{minWidth:80,height:40,rows:3,multiline:1,delay:300,readonly:!1,showLabel:!0,confirmOnTap:!0,wheels:[],mode:"scroller",preset:"",speedUnit:.0012,timeUnit:.08,formatValue:function(e){return e.join(" ")},parseValue:function(t,a){var s,i,o=[],l=[],r=0;return null!==t&&t!==n&&(o=(t+"").split(" ")),e.each(a.settings.wheels,function(t,a){e.each(a,function(t,a){i=a.keys||a.values,s=i[0],e.each(i,function(e,t){if(o[r]==t)return s=t,!1}),l.push(s),r++})}),l}})},t.themes.scroller=t.themes.frame}(jQuery,window,document),function(e,t){var a=e.mobiscroll,n=a.util,s=n.isString,i={batch:40,inputClass:"",invalid:[],rtl:!1,showInput:!0,groupLabel:"Groups",checkIcon:"checkmark",dataText:"text",dataValue:"value",dataGroup:"group",dataDisabled:"disabled"};a.presetShort("select"),a.presets.scroller.select=function(a){function o(){var a,n,s,i,o,l=0,r=0,c={};x=[],v=[],B?e.each(I.data,function(e,l){i=l[I.dataText],o=l[I.dataValue],n=l[I.dataGroup],s={value:o,text:i,index:e},Z[o]=s,x.push(s),Q&&(c[n]===t?(a={text:n,value:r,options:[],index:r},J[r]=a,c[n]=r,v.push(a),r++):a=J[c[n]],X&&(s.index=a.options.length),s.group=c[n],a.options.push(s)),l[I.dataDisabled]&&$.push(o)}):Q?e("optgroup",j).each(function(t){J[t]={text:this.label,value:t,options:[],index:t},v.push(J[t]),e("option",this).each(function(e){s={value:this.value,text:this.text,index:X?e:l++,group:t},Z[this.value]=s,x.push(s),J[t].options.push(s),this.disabled&&$.push(this.value)})}):e("option",j).each(function(e){s={value:this.value,text:this.text,index:e},Z[this.value]=s,x.push(s),this.disabled&&$.push(this.value)}),G&&(x=[],l=0,e.each(J,function(t,a){o="__group"+t,s={text:a.text,value:o,group:t,index:l++},Z[o]=s,x.push(s),$.push(s.value),e.each(a.options,function(e,t){t.index=l++,x.push(t)})}))}function l(e,a,n,s,i,o,l){var r=[],c=[],s=Math.max(0,(n[s]!==t?n[s].index:0)-L),d=Math.min(a.length-1,s+2*L);if(M[i]!==s||P[i]!==d){for(n=s;n<=d;n++)c.push(a[n].text),r.push(a[n].value);W[i]=!0,S[i]=s,O[i]=d,a={multiple:o,values:c,keys:r,label:l},q?e[0][i]=a:e[i]=[a]}else W[i]=!1}function r(e){l(e,v,J,w,g,!1,I.groupLabel)}function c(e){l(e,X?J[w].options:x,Z,V,C,E,z)}function d(a){E&&(a&&s(a)&&(a=a.split(",")),e.isArray(a)&&(a=a[0])),V=a===t||null===a||""===a?R:a,Y&&(k=w=Z[V].group)}function u(e,t){var n=e?a._tempWheelArray:a._hasValue?a._wheelArray:null;return n?I.group&&t?n:n[C]:null}function h(){var e,t;e=[];var n=0;if(E){t=[];for(n in K)e.push(Z[n]?Z[n].text:""),t.push(n);e=e.join(", ")}else t=V,e=Z[V]?Z[V].text:"";a._tempValue=t,_.val(e),j.val(t)}function f(e){var t=e.attr("data-val"),a=e.hasClass("dw-msel");return E&&e.closest(".dwwl").hasClass("dwwms")?(e.hasClass("dw-v")&&(a?(e.removeClass(H).removeAttr("aria-selected"),delete K[t]):(e.addClass(H).attr("aria-selected","true"),K[t]=t)),!1):void(e.hasClass("dw-w-gr")&&(b=e.attr("data-val")))}var p,w,v,m,b,g,y,_,x,C,V,T,k,A,W={},M={},P={},S={},O={},D=e.extend({},a.settings),I=e.extend(a.settings,i,D),L=I.batch,D=I.layout||(/top|bottom/.test(I.display)?"liquid":""),q="liquid"==D,j=e(this),E=I.multiple||j.prop("multiple"),F=this.id+"_dummy";y=e('label[for="'+this.id+'"]').attr("for",F);var z=I.label!==t?I.label:y.length?y.text():j.attr("name"),H="dw-msel mbsc-ic mbsc-ic-"+I.checkIcon,U=I.readonly;y=I.data;var B=!!y,Q=B?!!I.group:e("optgroup",j).length,R=B?y[0]?y[0][I.dataValue]:null:e("option",j).attr("value");y=I.group;var Y=Q&&y&&!1!==y.groupWheel,X=Q&&y&&Y&&!0===y.clustered,G=Q&&(!y||!1!==y.header&&!X),N=j.val()||[],$=[],K={},Z={},J={};if(I.invalid.length||(I.invalid=$),Y?(g=0,C=1):(g=-1,C=0),E)for(j.prop("multiple",!0),N&&s(N)&&(N=N.split(",")),y=0;y<N.length;y++)K[N[y]]=N[y];return o(),d(j.val()),e("#"+F).remove(),_=e('<input type="text" id="'+F+'" class="'+I.inputClass+'" placeholder="'+(I.placeholder||"")+'" readonly />'),I.showInput&&_.insertBefore(j),a.attachShow(_),j.addClass("dw-hsel").attr("tabindex",-1).closest(".ui-field-contain").trigger("create"),h(),a.setVal=function(e,t,i,o,l){E&&(e&&s(e)&&(e=e.split(",")),K=n.arrayToObject(e),e=e?e[0]:null),a._setVal(e,t,i,o,l)},a.getVal=function(e,t){return E?n.objectToArray(K):u(e,t)},a.refresh=function(){o(),M={},P={};var e=I,t=[[]];Y&&r(t),c(t),e.wheels=t,M[g]=S[g],P[g]=O[g],M[C]=S[C],P[C]=O[C],p=!0,a._isVisible&&a.changeWheel(Y?[g,C]:[C])},a.getValues=a.getVal,a.getValue=u,{width:50,layout:D,headerText:!1,anchor:_,confirmOnTap:!Y||[!1,!0],formatValue:function(e){var t,a=[];if(E){for(t in K)a.push(Z[t]?Z[t].text:"");return a.join(", ")}return e=e[C],Z[e]?Z[e].text:""},parseValue:function(e){return d(e===t?j.val():e),Y?[w,V]:[V]},onValueTap:f,onValueFill:h,onBeforeShow:function(){E&&I.counter&&(I.headerText=function(){var t=0;return e.each(K,function(){t++}),t+" "+I.selectedText}),d(j.val()),Y&&(a._tempWheelArray=[w,V]),a.refresh()},onMarkupReady:function(t){t.addClass("dw-select"),e(".dwwl"+g,t).on("mousedown touchstart",function(){clearTimeout(A)}),e(".dwwl"+C,t).on("mousedown touchstart",function(){m||clearTimeout(A)}),G&&e(".dwwl"+C,t).addClass("dw-select-gr"),E&&(t.addClass("dwms"),e(".dwwl",t).on("keydown",function(t){32==t.keyCode&&(t.preventDefault(),t.stopPropagation(),f(e(".dw-sel",this)))}).eq(C).addClass("dwwms").attr("aria-multiselectable","true"),T=e.extend({},K))},validate:function(n,s,i,o){var l,d=[];l=a.getArrayVal(!0);var u=l[g],h=l[C],f=e(".dw-ul",n).eq(g),y=e(".dw-ul",n).eq(C);if(M[g]>1&&e(".dw-li",f).slice(0,2).removeClass("dw-v").addClass("dw-fv"),P[g]<v.length-2&&e(".dw-li",f).slice(-2).removeClass("dw-v").addClass("dw-fv"),M[C]>1&&e(".dw-li",y).slice(0,2).removeClass("dw-v").addClass("dw-fv"),P[C]<(X?J[u].options:x).length-2&&e(".dw-li",y).slice(-2).removeClass("dw-v").addClass("dw-fv"),!p&&(V=h,Y&&(w=Z[V].group,s!==t&&s!==g||(w=+l[g],m=!1,w!==k?(V=J[w].options[0].value,M[C]=null,P[C]=null,m=!0,I.readonly=[!1,!0]):I.readonly=U)),Q&&(/__group/.test(V)||b)&&(h=V=J[Z[b||V].group].options[0].value,b=!1),a._tempWheelArray=Y?[u,h]:[h],Y&&(r(I.wheels),W[g]&&d.push(g)),c(I.wheels),W[C]&&d.push(C),clearTimeout(A),A=setTimeout(function(){d.length&&(p=!0,m=!1,k=w,M[g]=S[g],P[g]=O[g],M[C]=S[C],P[C]=O[C],a._tempWheelArray=Y?[u,V]:[V],a.changeWheel(d,0,s!==t)),Y&&(s===C&&a.scroll(f,g,a.getValidCell(w,f,o,!1,!0).v,.1),a._tempWheelArray[g]=w),I.readonly=U},s===t?100:1e3*i),d.length))return!m;if(s===t&&E){l=K,i=0,e(".dwwl"+C+" .dw-li",n).removeClass(H).removeAttr("aria-selected");for(i in l)e(".dwwl"+C+' .dw-li[data-val="'+l[i]+'"]',n).addClass(H).attr("aria-selected","true")}G&&e('.dw-li[data-val^="__group"]',n).addClass("dw-w-gr"),e.each(I.invalid,function(t,a){e('.dw-li[data-val="'+a+'"]',y).removeClass("dw-v dw-fv")}),p=!1},onClear:function(t){K={},_.val(""),e(".dwwl"+C+" .dw-li",t).removeClass(H).removeAttr("aria-selected")},onCancel:function(){!a.live&&E&&(K=e.extend({},T))},onDestroy:function(){_.remove(),j.removeClass("dw-hsel").removeAttr("tabindex")}}}}(jQuery),function(e){var t,a,n,s=e.mobiscroll,i=s.themes;a=navigator.userAgent.match(/Android|iPhone|iPad|iPod|Windows|Windows Phone|MSIE/i),/Android/i.test(a)?(t="android-holo",(a=navigator.userAgent.match(/Android\s+([\d\.]+)/i))&&(a=a[0].replace("Android ",""),
t=4<=a.split(".")[0]?"android-holo":"android")):/iPhone/i.test(a)||/iPad/i.test(a)||/iPod/i.test(a)?(t="ios",(a=navigator.userAgent.match(/OS\s+([\d\_]+)/i))&&(a=a[0].replace(/_/g,".").replace("OS ",""),t="7"<=a?"ios":"ios-classic")):(/Windows/i.test(a)||/MSIE/i.test(a)||/Windows Phone/i.test(a))&&(t="wp"),e.each(i,function(a,i){if(e.each(i,function(e,a){return a.baseTheme==t?(s.autoTheme=e,n=!0,!1):void(e==t&&(s.autoTheme=e))}),n)return!1})}(jQuery);
/*![lib/Scroller.js]*/define("lib/Scroller",["lib/EventObj"],function(t){var e=$.inherits(t,{constructor:function(e,r){t.call(this),this.wrapperNode=$(e),this.wrapper=this.wrapperNode[0],this.scroller=this.wrapper.children[0],this.options=r,this.x=this.y=this.wrapperWidth=this.wrapperHeight=this.scrollHeight=this.scrollWidth=0;var i=this;this._checkScroll=$.throttle(50,function(){var t=i.wrapperNode.scrollTop(),e=i.wrapperNode.scrollLeft();Math.abs(i.y)!=Math.abs(t)&&(i.isHidden||(i.y=-t,i.x=-e,i.fire("scroll"),i._checkAppear()))}),this._onResize=function(){i.refresh()},this.wrapperNode.css("-webkit-overflow-scrolling","touch").css("overflow-y","auto").css("overflow-x","hidden").on("touchmove scroll",this._checkScroll),$(window).on("resize",this._onResize)},scrollTo:function(t,e,r,i){return t=Math.abs(t||0),e=Math.abs(e||0),r=r||0,this.wrapper.scrollTop=e,this.wrapper.scrollLeft=t,this.y=-e,this.x=-t,this.fire("scroll"),this},isBottom:function(t){return t=t||0,Math.abs(this.y)+t>=this.scrollHeight-this.wrapperHeight},scrollToElement:function(t,e,r){},refresh:function(){var t=this,e=this.wrapper,r=e.getBoundingClientRect(),i=parseInt(r.top),s=parseInt(r.left),h=e.scrollTop,o=e.scrollLeft;this.scrollHeight=e.scrollHeight,this.scrollWidth=e.scrollWidth,this._appearItems=[],this._wrapperRect={width:t.wrapperWidth=parseInt(r.width),height:t.wrapperHeight=parseInt(r.height)};var l=function(e,r){$.each(e,function(e,l){var p=l.getBoundingClientRect();0==p.width&&0==p.height||t._appearItems.push({type:r,elm:l,offset:$(l).data("offset")||0,rect:{left:parseInt(p.left-s+o),top:parseInt(p.top-i+h),width:parseInt(p.width),height:parseInt(p.height)}})})};return l(this.wrapperNode.find(".scroller-lazyload"),"lazyload"),l(this.wrapperNode.find(".scroller-firstin"),"firstin"),this._checkAppear(),this.fire("refresh"),this},destroy:function(){$(window).off("resize",this._onResize),this.wrapperNode.off("touchmove scroll",this._checkScroll),this.wrapperNode=this.wrapper=this.scroller=this._onTouchMove=null},_checkAppear:function(){var t=(this._wrapperRect.width,this._wrapperRect.height),e=(this.x,this.y),r=this;$.each(this._appearItems,function(i,s){var h=s.rect,o=s.offset;if(!(s.fired||h.top+h.height+e-o<0)){if(h.top+e-o>t)return!1;var l=s.elm,p=$(l);if(s.fired=!0,"lazyload"==s.type){var a=p.data("src");"IMG"==l.tagName.toUpperCase()?l.src=a:p.css("background-image","url("+a+")")}p.removeClass("scroller-"+s.type),r.fire(s.type,{target:l})}})}}),r=function(){},i=function(t,i){return i=i||{},"iscroll"==i.method?new r(t,i):new e(t,i)};return i});
/*![lib/NewSlider.js]*/define("lib/NewSlider",["lib/base"],function(e){var t,i,s,a,n,r,o,l,d,_;t=function(){for(var e=this,t=[],i=0;i<e.slides.size();i++)t.push('<div class="indicator-dot"></div>');t=$('<div class="indicator">'+t.join("")+"</div>").appendTo(e.wrap),t.children().first().addClass("theme-bg")},i=function(e){var t=this,i=t.wrap.find(".indicator-dot");i.removeClass("theme-bg"),i.eq(e).addClass("theme-bg")},s=function(e,t,i,s){var a=this,n=a.isVertical?"0,"+t+"px, 0":t+"px,0,0";e.animate({translate3d:n},i,function(){s&&s()})},a=function(e,t){var i=this,t=t||$(i._wrapInner);i._transform(t,e,0)},l=function(e,t){var i=this,s=0;$.isNumber(t)?s=t:"left"==t?s=-1:"right"==t&&(s=1),0==e&&s>0?i._last.css(i._positionProperty,-i._wrapInnerSize):e==i._lastIndex&&s<0&&i._first.css(i._positionProperty,i._wrapInnerSize)},n=function(e,t,i,s){var a=this,e=$.isNumber(e)?e:$(e).index(),n=a.slides.eq(e),t=t||a.speed;if(!a._isAnimating){var r=function(){a._isAnimating=!1,a.currentIndex=e,a._transSize=e*a._size,a._changeDot(e),s&&s()};a._isAnimating=!0,0!=e||a.currentIndex!=a._lastIndex||2==a.slides.size()&&i>0?e!=a._lastIndex||0!=a.currentIndex||2==a.slides.size()&&i<0?a._transform(a._wrapInner,-e*a._size,t,function(){a._isAnimating&&r()}):(n.css(a._positionProperty,-a._wrapInnerSize),a._transform(a._wrapInner,a._size,t,function(){a._isAnimating&&(n.css(a._positionProperty,"auto"),a._imdTransform(a._size-a._wrapInnerSize),r())})):(n.css(a._positionProperty,a._wrapInnerSize),a._transform(a._wrapInner,-a._wrapInnerSize,t,function(){a._isAnimating&&(n.css(a._positionProperty,"auto"),a._imdTransform(0),r())}))}},r=function(e,t,i){var s=this,a=e?e.index():s.currentIndex,t=t||s.speed,n=a==s._lastIndex?0:a+1;s.playTo(n,t,-1,i)},o=function(e,t,i){var s=this,a=e?e.index():s.currentIndex,t=t||s.speed,n=0==a?s._lastIndex:a-1;s.playTo(n,t,1,i)},startAutoPlay=function(){var e=this;clearInterval(e._autoPlayInterval),e._autoPlayInterval=setInterval(function(){e.playToNext()},e.interval)},stopAutoPlay=function(){var e=this;e._autoPlayInterval&&(clearInterval(e._autoPlayInterval),e._autoPlayInterval=null)},d=function(){var e=this;e.slides.on({swipeLeft:function(){var t=+new Date-e._lastT;e._lastT=+new Date;var i=t<e._swiperSpeed?50:e._swiperSpeed;e.playToNext($(this),i,function(){e.startAutoPlay()})},swipeRight:function(){var t=+new Date-e._lastT;e._lastT=+new Date;var i=t<e._swiperSpeed?50:e._swiperSpeed;e.playToPrev($(this),i,function(){e.startAutoPlay()})},touchstart:function(t){t.preventDefault(),e.stopAutoPlay();var i=e._wrapInner.position()[e._positionProperty];e._isAnimating=!1,e._imdTransform(i),e._transSize=i,e._startX=t.changedTouches[0].clientX},touchmove:function(e){},touchend:function(e){}})},_=function(){var e=this;e.startAutoPlay(),e.slides.off()};var p=function(e){var t=this;if(t.currentIndex=0,t._lastT=+new Date,t._startX=t._endX=0,t._isAnimating=!1,t._autoPlayInterval=null,t._transSize=0,t.isVertical=e.isVertical,t._verticalClass=t.isVertical?"mod-slides-vertical":"",t._sizeProperty=t._setSizeMethod=t.isVertical?"height":"width",t._positionProperty=t.isVertical?"top":"left",t.wrap=$(e.wrap).eq(0),t.slides=$(e.slideSelect),e.size){if($.isString(e.size)&&e.size.indexOf("%")>0)t._size=parseFloat(e.size)*t.wrap.offsetParent()[t._setSizeMethod]()/100;else if($.isString(e.size)&&e.size.indexOf("rem")>0){var i=$("html").width()>480?480:$("html").width();t._size=10*parseFloat(e.size)*i/320}}else t._size=t.wrap.offsetParent()[t._setSizeMethod]();t._wrapInnerSize=t.slides.size()*t._size,t._first=t.slides.first(),t._last=t.slides.last(),t._lastIndex=t.slides.size()-1,t.interval=e.interval&&e.interval>800?e.interval:4e3,t.speed=e.speed&&e.speed<interval?e.speed:500,t._swiperSpeed=t.speed,t.slides.addClass("slide")[t._setSizeMethod](t._size).show(),t._wrapInner=t.slides.wrapAll('<div class="slides-wrap-inner"></div>').parent()[t._setSizeMethod](t._wrapInnerSize),t.wrap[t._setSizeMethod](t._size).addClass("mod-slides cf "+t._verticalClass),1!=t.slides.size()&&(t.isVertical||(t._makeDots(),t._handleTouch()),t.startAutoPlay())};return p.prototype={constructor:p,_makeDots:t,_changeDot:i,_transform:s,_imdTransform:a,_prepareEdgeNode:l,_handleTouch:d,startAutoPlay:startAutoPlay,stopAutoPlay:stopAutoPlay,playTo:n,playToNext:r,playToPrev:o,destroy:_},p});
/*![lib/ProgressRing.js]*/define("lib/ProgressRing",function(){var i='<div class="mod-progressRing">\n<div class="circle circle1"></div>\n<div class="circle circle2"><div class="inner"></div></div>\n<div class="circle circle3"></div>\n<div class="circle circle4"</div><div class="inner"></div></div>\n</div>',e=function(i,e){var e=e.map(function(i){return i+"px"});i.css("clip","rect("+e.join(",")+")")},c=function(i){var e=10*($(window).width()>480?480:$(window).width())/320;return 2*parseInt(i*e/2,10)},n=function(i,e){var c=this._node,n=c.find(".circle2"),r=c.find(".circle4");r.css("display","none"),i<=180?n.animate({rotate:i+"deg"},e||3e3,"linear"):n.animate({rotate:"180deg"},180*(e||3e3)/i,"linear",function(){r.css("display","block"),r.animate({rotate:i-180+"deg"},(e||3e3)*(1-180/i),"linear")})},r=function(n){var r=this,d=c(n.size),t=parseInt(.21*d,10),s=parseInt(.069*d,10),a=n.empty?"empty":"",l=r._node=$(i).appendTo(n.appendTo).addClass(a+(n.customCls||"")).css({transform:"rotate("+(n.start||0)+"deg)",width:d,height:d,position:"relative"});l.find(".circle1, .circle3").css({borderWidth:t}),l.find(".circle2, .circle4").css({width:d-4,height:d-4,top:2,left:2,borderWidth:t-s-2}),l.find(".circle2 .inner, .circle4 .inner").css({borderWidth:s-2}),e(l.find(".circle2"),[0,(d-4)/2,d-4,0]),e(l.find(".circle3"),[0,d/2,d,0]),e(l.find(".circle4"),[0,d-4,d-4,(d-4)/2]),r.playTo(360,n.speed||600)};return r.prototype={constructor:r,playTo:n},r});
/*![common/shareUtils.js]*/define("common/shareUtils",["common/Dialog","common/weixinUtils","common/nuomiUtils"],function(i,e,n){var t,o={title:"馋了吗？找爱鲜蜂！",desc:"馋了？忙呢？召唤鲜蜂侠，鲜果咖啡，坚果卤味，各种新鲜，闪电送达！",imgUrl:"http://weixin.beequick.cn/static/bee/img/icon_100-6607ff98.png",link:"http://m.beequick.cn"};return{setShare:function(i){t=i||o,$.isWeixin&&e.setShare(i)},share:function(){$.isWeixin?e.shareTip(!0):$.isNuomi?n.share(t):i.alert("当前环境不支持分享")}}});
/*![common/User.js]*/define("common/User",["lib/base","lib/EventObj","partner/Partner"],function(n,i,o){var s=function(){var n,i=60,o=function(){i--,i&&setTimeout(o,1e3),n&&n(i)},s=function(s){n=s,i=60,o()};return s}(),t=$.inherits(i,{constructor:function(){if(i.call(this),this._isLogin=!!SYS_CONF.userInfo.authorized,this.phone=SYS_CONF.userInfo.phone,this.rawPhone=SYS_CONF.userInfo.rawPhone,this._isSns=this._snsLogin=!1,o.isSupportPartnerLogin()){var s=this;this._isSns=!0,this._snsLogin=o.isLogin(),this._snsLogin&&!this._isLogin&&o.autoLogin(function(i){i.success?s._setLogin(i.phone):n.sendError(o.getKey()+" autologin error:"+i.errno+","+i.errmsg)})}},snsLogin:function(n){var i=this;(this._snsLogin=o.isLogin())?o.autoLogin(function(o){o.success&&i._snsLogin(o.phone),n&&n(o.success,o.errmsg)}):o.login(function(s){s.success?(i._snsLogin=!0,o.autoLogin(function(o){i._setLogin(o.phone),n&&n(o.success,o.errmsg)})):n&&n(!1,s.errno==-1?"":s.errmsg)})},isLogin:function(){return this._isSns?this._isLogin&&this._snsLogin:this._isLogin},isSnsLoginFailed:function(){return this._snsLoginFailedMsg||this._snsLogin&&!this._isLogin},getPhone:function(){return this.phone},getRawPhone:function(){return this.rawPhone},logout:function(i){var s=this;n.ajaxPost("/submit/logout",{},function(n){0==n.errno?(s._setLogin(!1),i&&i()):o.alert("退出失败："+n.errmsg)})},bindLogin:function(i,t){if(!i.data("bindLogin")){i.data("bindLogin","1");var e=this;!function(i){var r=function(n,s){i.find(".login-error-"+n).length?i.find(".login-error-"+n).html(s):s&&o.tip(s)},a=function(){var n=i.find(".login-input-phone").val(),o=/^1\d{10}$/.test(n);return o||r("phone","请输入正确的手机号"),!!o&&n},c=function(){var n=i.find(".login-input-code").val();return codeOk=/^\d{4,6}$/.test(n),codeOk||r("code","请输入验证码的数字"),!!codeOk&&n},u=function(n){n?i.find(".login-send").html(n+"s后重新发送").data("disabled","1").css("background-color","gray"):i.find(".login-send").html("获取验证码").data("disabled","").css("background-color","")},g=function(o,s,a){n.ajaxPost("/submit/sendVerifySMS",{phone:o,voice:s?1:0},function(n){n.data&&1==n.data.isvalid?(e._setLogin(o),t&&t()):0==n.errno?(r("phone",s?"语音验证码已经拨打":"验证码已经发送"),s&&n.data.service&&i.find(".login-voice-wrap").html("电话拨打中，请留意来电："+n.data.service),i.find(".login-input-code")[0].focus(),a&&a(!0)):(r("phone",n.errmsg),a&&a(!1))})};i.find(".login-send").on($.tapClick,function(){if(!$(this).data("disabled")){var n;(n=a())&&g(n,!1,function(n){n?s(u):i.find(".login-send").data("disabled",1).css("background-color","gray")})}});var d=function(){var i,o;return(i=a())&&(o=c())&&n.ajaxPost("/submit/verify",{phone:i,code:o},function(n){0==n.errno||6201==n.errno?(e._setLogin(i),t&&t()):r("code",n.errmsg)}),!1};i.find(".login-submit").on($.tapClick,d),i.find(".login-form").on("submit",d),i.delegate(".login-voice-link",$.tapClick,function(){var n;(n=a())&&g(n,!0)})}($(i))}},_setLogin:function(n){n?(this._isLogin=!0,this.rawPhone=n,this.phone=n.replace(/(\d{3})(\d{4})(\d{4})/,"$1***$3")):(this._isLogin=!1,this.rawPhone=this.phone=""),this.fire("statusChange")}}),e=null;return{getInstance:function(){return e||(e=new t),e}}});
/*![common/Pay.js]*/define("common/Pay",["lib/base","lib/EventObj","lib/Loading","common/Dialog","common/weixinUtils"],function(e,n,r,t,i){var o=$.inherits(n,{constructor:function(e,r){n.call(this),this.key=e,this.name=r.name,this.weight=r.weight,this.onPayFn=r.onPayFn,this.checkSupport=r.checkSupport,this.typeid=r.typeid},pay:function(e,n,r){this.onSuccess=n,this.onError=r,this.onPayFn(e)},getPayType:function(){return"delivery"==this.key?d.PAYTYPE_DELIVERY:d.PAYTYPE_ONLINE},_success:function(){this.onSuccess&&this.onSuccess()},_error:function(e){this.onError&&this.onError(e)}}),a={},d={PAYTYPE_DELIVERY:0,PAYTYPE_ONLINE:1,create:function(e,n){a[e]=new o(e,n)},get:function(e){return a[e]},getSupportPays:function(e){var n=[];for(var r in a){var t=a[r];t.checkSupport()&&("number"==typeof e?e===t.getPayType()&&n.push(t):n.push(t))}return n.sort(function(e,n){return n.weight-e.weight}),n}};return d.create("delivery",{name:"货到付款",weight:100,typeid:0,checkSupport:function(){return"zhidahao"!=SYS_CONF.tn&&!$.isBaidumap&&"bestpay"!=SYS_CONF.tn},onPayFn:function(e){this._success()}}),d.create("cmbc",{name:"民生银行支付",weight:200,checkSupport:function(){return"cmbc"==SYS_CONF.tn},onPayFn:function(e){var n='<form id="mod-pay-cmbcform" action="http://180.150.179.29/cmbc/api/thirdpart" method=\'POST\'>\n<input type="hidden" name="orderMsg" value="#{orderDetail}"/>\n<input type="hidden" name="successPage" value="#{host}/show/payResult" />\n<input type="hidden" name="uid" value="#{uid}" />\n<input type="hidden" name="sign" value="#{sign}" />\n</form>',r="#{name},#{price},#{shopCount},#{total}",t=[e.order_no,e.create_time,e.order_amount,"beequick.cn",{toString:function(){var n=[];return $.each(e.order_goods,function(e,t){n.push($.formatString(r,{name:t.name,price:parseFloat(t.real_price),shopCount:t.goods_nums,total:parseFloat(t.real_price)*t.goods_nums}))}),n.join(";")}}],i=$("#mod-pay-cmbcform");i.length||($($.formatString(n,{orderDetail:t.join("|"),uid:$.getParam("uid")||"",sign:$.getParam("sign")||"",host:SYS_CONF.domain.current})).appendTo(document.body),i=$("#mod-pay-cmbcform")),i[0].submit()}}),d.create("weixin",{name:"微信支付",weight:150,typeid:1,checkSupport:function(){return $.isWeixin&&SYS_CONF.domain.current.indexOf("weixin")>0},onPayFn:function(n){var r=this;e.ajaxPost("/submit/weixinPayinfo",{orderId:n.id||n.order_id,orderNo:n.order_no},function(e){0==e.errno?i.pay(e.data,function(e,n){e?r._success():r._error(n)}):r._error("创建支付失败："+e.errmsg)})}}),d.create("weibo",{name:"微博支付",weight:150,typeid:2,checkSupport:function(){if(SYS_CONF.domain.current.indexOf("weibo")==-1)return!1;var e=navigator.userAgent.match(/__weibo__([\d\.]+)/im);if(e){var n=parseFloat(e[1]);if(n>=4.3)return!0}return!1},onPayFn:function(n){var r='<form id="mod-pay-weibo-form" method="post" target="_self" action="http://pay.sc.weibo.com/api/merchant/pay/cashier">\n<input type="hidden" name="seller_id" value="#{seller_id}" />\n<input type="hidden" name="appkey" value="#{appkey}" />\n<input type="hidden" name="notify_url" value="#{notify_url}" />\n<input type="hidden" name="out_pay_id" value="#{out_pay_id}" />\n<input type="hidden" name="subject" value="#{subject}" />\n<input type="hidden" name="total_amount" value="#{total_amount}" />\n<input type="hidden" name="return_url" value="#{return_url}" />\n<input type="hidden" name="sign_type" value="#{sign_type}" />\n<input type="hidden" name="sign" value="#{sign}" />\n</form>',t=this,i=n.id||n.order_id;e.ajaxPost("/submit/weiboPayinfo",{orderId:i,orderNo:n.order_no,showUrl:SYS_CONF.domain.current+"/show/order/orderId/"+i+"/orderNo/"+n.order_no},function(e){if(0==e.errno){$("#mod-pay-weibo-form").remove();var n=$.formatString(r,e.data);$("body").append(n),$("#mod-pay-weibo-form")[0].submit()}else t._error("创建支付失败："+e.errmsg)})}}),d.create("alipay",{name:"支付宝支付",weight:150,typeid:2,checkSupport:function(){return!("zhidahao"==window.SYS_CONF.tn||$.isBaidumap||$.isNuomi||navigator.userAgent.indexOf("Bestpay")>0)&&($.isM&&!navigator.standalone)},onPayFn:function(n){var r=this,t=n.id||n.order_id,i=n.order_no,o=SYS_CONF.domain.current+"/show/order/orderNo/"+i+"/orderId/"+t+($.isSimulateMobile?"/simulate_mobile/true":"");window.SYS_CONF.tn&&(o+="/tn/"+window.SYS_CONF.tn),window.SYS_CONF.tg&&(o+="/tg/"+window.SYS_CONF.tg),$.getParam("qtoken",!1)&&(o+="/qtoken/"+$.getParam("qtoken")),e.ajaxPost("/submit/wapalipayInfo",{orderId:t,orderNo:i,successUrl:o+"/alipay/1",failUrl:o},function(n){0==n.errno?e.redirect(n.data.url):r._error(n.errmsg)})}}),d.create("zhidapay",{name:"百度收银台",weight:150,typeid:8,checkSupport:function(){return $.isBaidumap||"zhidahao"==window.SYS_CONF.tn},onPayFn:function(n){var r=this,t=n.id||n.order_id,i=n.order_no,o=SYS_CONF.domain.current+"/show/order/orderNo/"+i+"/orderId/"+t;window.SYS_CONF.tn&&(o+="/tn/"+window.SYS_CONF.tn),window.SYS_CONF.tg&&(o+="/tg/"+window.SYS_CONF.tg),o+="/zhidapay/1",e.ajaxPost("/submit/zhidapayinfo",{orderId:t,orderNo:i,successUrl:o,showUrl:o+"/forward/1"},function(n){0==n.errno?e.redirect(n.data.url):r._error(n.errmsg)})}}),d.create("wapweixin",{name:"微信支付",weight:200,typeid:1,checkSupport:function(){return!("zhidahao"==window.SYS_CONF.tn||$.isBaidumap||$.isSimulateMobile||"20430"==window.SYS_CONF.tg||navigator.userAgent.indexOf("AlipayClient")>0||navigator.userAgent.indexOf("Bestpay")>0)&&$.isM},onPayFn:function(n){var i=this;r.hide(),e.ajaxPost("/submit/wapWeixinPay",{orderId:n.id||n.order_id,orderNo:n.order_no},function(e){if(0==e.errno){var n=$.formatString("appid=#{appid}&noncestr=#{noncestr}&package=#{package}&prepayid=#{prepayid}&sign=#{sign}&timestamp=#{timestamp}",e.data);n="weixin://wap/pay?"+encodeURIComponent(n),window.location.href=n,t.alert("请在微信中完成支付",function(){i._success()})}else i._error(e.errmsg)})}}),d.create("bestpay",{name:"翼支付",weight:200,typeid:5,checkSupport:function(){return navigator.userAgent.indexOf("Bestpay")>0},onPayFn:function(n){var t=this;r.hide(),e.ajaxPost("/submit/bestpayInfo",{orderId:n.id||n.order_id,orderNo:n.order_no},function(e){if(0==e.errno){if(e.data){var n=e.data,r=function(){t._success()},i=function(){t._error("已取消")},o=new BestPay_Payment,a=new BestPay_User;n.ACCOUNTID=a.getProduct()||"",o.onPay(n,r,i)}}else t._error(e.errmsg)})}}),d});
/*![activity/bridge_base.js]*/define("activity/bridge_base",["lib/base","lib/Storage"],function(t,i){var o={activityLoaded:function(t,i){this.activityId=t,this._onActLoaded(t,i);var o=this;setTimeout(function(){o._verifyContinue()},500)},getActivityMod:function(){return Bee.getMod("activity/act_"+this.activityId,!0)},getActivityId:function(){return this.activityId},_onActLoaded:$.noop,_clickLog:function(i,o){var e=this.activityId,n={actid:e};o&&"object"==typeof o&&(n=$.extend(n,o)),t.clickLog("activity_"+i+"_click",n)},_verifyBreak:function(){var o=t.getEvent();if(o&&o.currentTarget&&o.currentTarget.id){var e=o.currentTarget,n={_evtType:o.type},r=new i("activity_"+this.activityId);n.id=e.id,r.set("verify_break",n)}},_verifyContinue:function(){var t,o=new i("activity_"+this.activityId),e=o.get("verify_break");e&&(o.del("verify_break"),e.id&&document.getElementById(e.id)&&(t=$("#"+e.id)),t&&t.trigger(e._evtType))},find:$.noop,destory:function(){var t=new i("activity_"+this.activityId);t.del("verify_break")},tabClick:function(t){this._clickLog("tab",{index:t})},getShoppingCartData:$.noop,getShoppingCartInfo:$.noop,share:$.noop,shareRefresh:$.noop,addProduct:$.noop,delProduct:$.noop,clearHideProducts:$.noop,isVerify:$.noop,verify:$.noop,reload:$.noop,getEnv:$.noop,getLocation:$.noop,goBack:$.noop,goTo:$.noop,makeOrder:$.noop,pay:$.noop,getAddress:$.noop,selectAddress:$.noop,getPays:$.noop,scanQRCode:$.noop,copy:$.noop};return o});
/*![activity/bridge_m.js]*/define("activity/bridge_m",["partner/Partner","activity/bridge_base","m/main"],function(t,e,i){var a=function(t,e){this.activityId=t,this.actView=e,this.selectAddressCallback=null};return a.prototype=$.extend(e,{find:function(t){return this.actView.find(t)},_addProductDataCache:function(t){i.getShoppingCart().addProductData(t)},share:function(){this._clickLog("share"),t.share()},shareRefresh:function(){var e=this.getActivityMod();e&&e.getShareObj&&t.setShare(e.getShareObj())},addProduct:function(t,e){var a=this.actView.getTrack();a&&(t.track=a),this._clickLog("cart");var r=i.getShoppingCart().addProduct(t);r&&e&&e()},delProduct:function(t,e){this._clickLog("cart");var a=i.getShoppingCart().deleteProduct(t,!1);a&&e&&e()},clearHideProducts:function(t,e){$.isFunction(t)&&(e=t);var a=i.getShoppingCart().clearHideProduct(t);a&&e&&e()},getShoppingCartData:function(t){return i.getShoppingCart().getShoppingMap(!1,t)},getShoppingCartInfo:function(t){var e=i.getShoppingCart()._calcCartGroupInfo(t);return{totalPrice:e.price,totalCount:e.count}},isVerify:function(){return i.getUser().isLogin()},verify:function(t){this._clickLog("verify");var e=this;this._verifyBreak(),t?this.actView.alert(t,function(){e.actView.changeView("verify")}):this.actView.changeView("verify")},reload:function(){this.actView.viewMethod("action_reload")(!0)},goBack:function(){this.actView.finishView()},goTo:function(t,e,i){switch(this._clickLog("goto_"+t),t){case"detail":this.actView.changeView("detail",i);break;case"orderInfo":this.actView.changeView("order",{orderId:i.orderid,orderNo:i.orderno});break;case"order":this.actView.changeView("orderlist");break;case"theme":alert("主题已经不被支持");break;case"activity":this.actView.changeView("act",{activityObj:i});break;case"mine":this.actView.changeView("mine");break;case"coupon":this.actView.changeView("coupon");break;case"address":this.actView.changeView("addrlist")}},getLocation:function(t){i.getGPS(function(e){t(e.success?{success:!0,lat:e.latitude,lon:e.longitude}:{success:!1})})},makeOrder:function(t,e){var a=i.getShop(),r={cart_group_id:0,addrId:8,paytype:1,dateid:0,datestr:"1小时送达",display_dealer:a.shopId,location_hash:a.location_hash};$.extend(r,t),base.ajaxPost("/submit/checkOrder",r,function(t){0==t.errno&&t.data&&t.data.order_hash?(r.order_hash=encodeURIComponent(t.data.order_hash),base.ajaxPost("/submit/makeOrder",r,function(t){0==t.errno?e(!0,t.data):e(!1,t.errmsg)})):e(!1,t.data&&t.data.msg||t.errmsg)})},pay:function(e,i,a,r){if(0==e)return this.actView.alert("暂时不支持用户选择支付方式"),void r(!1);var n,c=t.getSupportPays(!0),o={order_id:i,order_no:a};if(0==c.length)return this.actView.alert("没有支持的支付方式"),void r(!1);var s,d,h;for(s=0,d=c.length;s<d;s++)if(h=c[0],h.typeid==e){n=h;break}if(!n)return void this.actView.alert("没有支持的支付方式");this.actView.showLoading(n.name+"进行中");var u=this;n.pay(o,function(){u.actView.hideLoading(),r(!0)},function(){u.actView.hideLoading(),r(!1)})},getPays:function(){var e=t.getSupportPays(!0);return e.map(function(t){return{type:t.typeid,name:t.name}})},getAddress:function(t){return i.getAddrMgr().getDefaultAddr()},selectAddress:function(t){this.selectAddressCallback=t,this.actView.changeView("addrlist",{isSelect:!0,isReturn:!0,showGps:!1})},scanQRCode:function(e){var i=this;t.scanQR(function(t){return t.success?void(e&&e(!0,t.result)):void("unsupport"==t.error?i.actView.alert("当前平台暂不支持扫描二维码",function(){e&&e(!1)}):"denied"==t.error?i.actView.alert("请检查您的应用设置开启摄像头权限",function(){e&&e(!1)}):e&&e(!1))})},copy:function(e,i){t.copy(e,function(t){i&&i(t.success)})}}),a});
/*![activity/ActModel.js]*/define("activity/ActModel",["lib/EventObj","phone/common/utils","common/Dialog"],function(t,i,e){var n=$.inherits(t,{constructor:function(i){t.call(this),this.key=i,this.bridge=Bee.getMod("activity/bridge"),this.productsMap={},this.originalWidth=640,this.scaleConf=!1,this.containerNode=this.bridge.find(".mod-"+i),this.checkSupportFn=!1,this.needVerify=!1,this.actionArgs="",this.imgLazyLoad=!1,this.iscrollInstance,this.flyDirection=null,this.containerOffset=this.containerNode.offset();var e=this;setTimeout(function(){e._init()},10)},setProduct:function(t){if($.isArray(t)||$.isObject(t)&&!t.id){var i=this;$.each(t,function(t,e){i._setProduct(e)})}else $.isObject(t)&&this._setProduct(t);return this},setGroupedProduct:function(t){var i=this;return $.each(t,function(t,e){i.setProduct(e)}),this},setOriginalWidth:function(t){return this.originalWidth=t||640,this},setScaleBlock:function(t){return this.scaleConf=t,this},setCheckSupportFn:function(t){return this.checkSupportFn=t,this},setCheckStyleLinkFn:function(t){return this.checkStyleLinkFn=t,this},setPriceFlyDirection:function(t){return this.flyDirection=t,this},setNewScroller:function(t){var i=this;return $.isApp?this.iscrollInstance={wrapper:i.containerNode,scroller:i.containerNode.children(":first-child"),scrollToElement:function(t,i,e){var n,o,s=typeof t;if("object"==s)t.length||(t=$(t));else{if("string"!=s)return;t=t.indexOf("#")<0?$("#"+t):$(t)}n=t.length?t.offset().top-e.top:0,o=t.length?t.offset().left-e.left:0,window.scrollTo(o||0,n||0)},refresh:function(){},scrollTo:function(t,i,e,n){window.scrollTo(t,-i)}}:this.setScroller(t),this},setScroller:function(t){var i=this;this._scrollFn=$.throttle(150,function(){i.containerNode.find(".scroll-appear").each(function(t,e){var n,o=$(e),s=o.offset(),c=parseInt(o.data("scroll-delta")||0),r=s.top-i.containerTop,a=s.height,h=!1,l=!1,d=o.data("scroll-state")||"hidden";if(r+c<i.containerHeight&&r+c>0&&(h=!0),r+a-c<i.containerHeight&&r+a-c>0&&(l=!0),n=h||l?"shown":"hidden",n!=d){o.data("scroll-state",n);var f=o.data("scroll-state-"+n)||0;f++,o.data("scroll-state-"+n,f),i.fire("nodeShownStateChange",{node:o,state:n,count:f})}}),i.imgLazyLoad&&i._imgLazyLoadFn(),i.fire("scroll",{x:i.iscrollInstance.x,y:i.iscrollInstance.y})}),t=$.extend(t||{},{onAnimate:i._scrollFn,onScrollMove:i._scrollFn,onScrollEnd:function(){i.fire("scrollEnd")}}),$.stopPageScroll(!0,".mod-activity-"+this.bridge.activityId),this.iscrollInstance=new iScroll(this.containerNode[0],t);var e,n;return(e=$.getParam("ahash",!1))&&(n=this.containerNode.find("."+e)[0],n&&this.iscrollInstance.scrollToElement(n)),this._handleFenzhong(),this},setNeedVerify:function(t){return this.needVerify=t,this},setImageLazyLoad:function(t){this.imgLazyLoad=t;var i=new ScrollerDetector({container:".lazyload-container",childSelector:".img-lazyload"});return i.onCheckViewport=function(t){var i="";$(t).each(function(){i=$(this).data("src"),i&&($(this).removeClass("img-lazyload"),$(this).data("src",""),"IMG"==this.tagName.toUpperCase()?this.src=i:$(this).css("background-image","url("+i+")"))})},i.check(),this},setActObj:function(t){return this._actObj=t,this},refresh:function(){this._calcStyle&&this._calcStyle(),this.iscrollInstance&&this.iscrollInstance.scrollTo(0,0)},action_addCart:function(t,e){var n=this.productsMap[t],o=this;if(n.activity_id=this._actObj?this._actObj.id:0,e);else if(this.checkSupportFn&&!this.checkSupportFn())return;if(n)return this.needVerify&&!this.bridge.isVerify()?void this.bridge.verify("购买"+n.name+"前需要验证手机号"):void this.bridge.addProduct(n,function(){i.shoppingPriceFly(n.price,o.flyDirection)})},action_delCart:function(t,i){var e=this.productsMap[t];if(i);else if(this.checkSupportFn&&!this.checkSupportFn())return;if(e)return this.needVerify&&!this.bridge.isVerify()?void this.bridge.verify("移除"+e.name+"前需要验证手机号"):void this.bridge.delProduct(e,function(){})},action_share:function(t){t&&!this.bridge.isVerify()?this.bridge.verify(t):this.bridge.share()},action_tab:function(t){this.bridge.tabClick(t)},action_back:function(){this.bridge.goBack()},action_goto:function(t,i,e,n){var o=this.productsMap[e];o.zchtid=n,this.bridge.goTo(t,i,o)},action_openView:function(t){this.bridge.openView(t)},action_go:function(t,i,e){return this.bridge.isVerify()?void this.bridge.goTo(t,i,{}):void this.bridge.verify(e||"请先验证手机号")},action_detail:function(t){var i=this.productsMap[t];i&&(i.zchtid=SYS_CONF.activity.zchtid,this.bridge.goTo("detail",0,i))},action_scrollDown:function(){this.iscrollInstance.scrollTo(0,$(this.iscrollInstance.wrapper).height()-$(this.iscrollInstance.scroller).height(),1500)},action_jump:function(t,i,e,n,o){if(parseInt(t)||i){var s=this._actObj||{ext_params:{}};$.setCookie("from_id",s.id,{path:"/",expires:3e4,domain:"beequick.cn"}),s.id=t||0,s.ext_params.activitygroup=i||0,s.hide_cart=1==n?1:0,s.show_reload=0==o?0:1,s.name=e||"爱鲜蜂",this.bridge.goTo("activity",1,s)}},_init:function(){var t=this;this._calcStyle=function(){var e=t.containerNode.offset();t.containerOffset=e,t.containerHeight=e.height,t.containerTop=e.top,t.scaleConf&&i.calcBlockHeightByWidth(t.containerNode,t.originalWidth,t.scaleConf),t.iscrollInstance&&t.iscrollInstance.refresh(),$.isFunction(t.checkStyleLinkFn)&&!t.checkStyleLinkFn()&&setTimeout(t._calcStyle,100),t.fire("styleReCalc")},this._tapAction=function(i){var e=this,n=$(this),o=n.data("action"),s=o.split("|"),c=s[0],r=s[1]?s[1].split(","):[];t.actionArgs=r,n.hasClass("disabled")||t.fire("action_"+c,{args:r,target:e},function(){i.preventDefault(),i.stopPropagation(),$.isFunction(t["action_"+c])&&t["action_"+c].apply(t,r)})},this.containerNode.delegate(".act-action",$.tapClick,this._tapAction),$(window).on("resize",this._calcStyle),this._calcStyle(),this._scrollFn&&this._scrollFn(),setTimeout(function(){t.containerNode.addClass("render-fix"),setTimeout(function(){t.containerNode.removeClass("render-fix")},500)},100)},destory:function(){this.fire("beforedestroy"),$.stopPageScroll(!1,".mod-activity-"+this.bridge.activityId),this.containerNode.off(".act-action",$.tapClick,this._tapAction),$(window).off("resize",this._calcStyle)},localStorageHanlder:function(t){return"function"==typeof t&&window.addEventListener("storage",t,!1),this},_setProduct:function(t){this.productsMap[t.id]=t,this.bridge._addProductDataCache&&this.bridge._addProductDataCache(t)},_imgLazyLoadFn:function(){var t=this;this.containerNode.find(".img-lazyload").each(function(i,e){var n=$(this),o=n.offset(),s=o.top-t.containerTop,c=o.top-t.containerTop+o.height,r=n.data("src");r&&(s>=0&&s<=t.containerHeight||c>=0&&c<=t.containerHeight)&&(n.removeClass("img-lazyload"),"IMG"==this.tagName.toUpperCase()?this.src=r:n.css("background-image","url("+r+")"))})},_handleFenzhong:function(){if(this.iscrollInstance&&this.bridge.isAutoload){var t=window.SYS_CONF.tn,i="right"==$.getParam("fz_logo_pos",!1)?"right":"left";if(t&&0===t.indexOf("fenzhong_")){var e=$(this.iscrollInstance.scroller);e.css("position","relative").append('<img src="/static/bee/img/phone/fenzhong_logo-36424368.png" style="width:55px;height:55px;position:absolute;z-index:1000;top:0;'+i+':3px;"/>'),this.containerNode.find(".act-action").each(function(t,i){var e=$(i),n=e.data("action");0===n.indexOf("share")&&e.css("display","none")})}}}});return n});
/*![phone/common/utils.js]*/define("phone/common/utils",["lib/base"],function(t){var e={},n=0,i=0,s=0,a=0,r=0;$(document).on("touchstart",function(t){if(t.touches&&t.touches.length){var e=t.touches[0];i=e.pageX,s=e.clientY}});var o=function(){$('<div id="__utils_calcScreen" style="position:fixed;left:0;right:0;top:0;bottom:0">').appendTo("body");var t=$("#__utils_calcScreen");a=t.height(),r=t.width(),t.remove(),t=null};return o(),e.shoppingPriceFly=function(t,e){n++;var o,c,p;if($.isString(t)||$.isNumber(t))o=i,c=s,p="￥"+t;else{t=$(t);var d=t.offset();o=d.left,c=d.top,p=t.text()}$($.formatString('<span id="shopping-price-fly-#{id}" style="position:fixed;z-index:9999;color:#FF8901;font-size:14px;font-weight:bold;top:#{y}px;left:#{x}px;-webkit-transition:left .5s linear,top .5s cubic-bezier(.31,-0.68,.9,.48),-webkit-transform .5s linear;">#{text}</span>',{id:n,text:p,x:o,y:c})).appendTo("body");var u=r-70,l=$("#shopping-price-fly-"+n);setTimeout(function(){l.css({left:u+"px",top:a+"px","-webkit-transform":"scale(.5)"}),setTimeout(function(){l.remove()},600)},10)},e.handleShareLink=function(e){if(!window.SYS_CONF)return e;var n=$.getParam("shareseries")||"",i=encodeURIComponent(n+(n?"-":"")+(SYS_CONF.shareSerie||SYS_CONF.userInfo.beeId));return t.urlAddParams(e,{shareseries:i})},e.calcBlockHeightByWidth=function(t,e,n){var i,s,a,r,o,c,p=t.width();for(i in n){s=n[i],c=s._widthDelta||0,a={};for(r in s)0!=r.indexOf("_")&&(o=s[r],a[r]=parseInt(o/(e-c)*(p-c/2))+"px");var d=t.find(".block-"+i);d&&d.length&&d.css(a)}},e.isActivityTag=function(t){var e=!1;if(t.jptype)switch(parseInt(t.jptype)){case 1:type="showActivity";break;case 2:type="showTags",e=!0;break;case 3:}else t.istags&&(e=!!parseInt(t.istags));return e},e.distanceOfTwoPoints=function(t,e,n,i){var s=function(t){return t*Math.PI/180},a=s(e),r=s(i),o=a-r,c=s(t)-s(n),p=2*Math.asin(Math.sqrt(Math.pow(Math.sin(o/2),2)+Math.cos(a)*Math.cos(r)*Math.pow(Math.sin(c/2),2))),d=6370996.81;return p*=d,p=Math.round(1e4*p)/1e4},e.renderProducts=function(){function t(t){return t.map(function(t){return $.formatString(e.product,{market_price:function(){return t.market_price>t.price?'<span class="product-price-market theme-grayfont">¥'+t.market_price+"</span>":""},jingxuan:function(){return t.is_xf?'<span class="pm-embossed">精选</span>':""},pm_desc:function(){return t.had_pm&&t.pm_desc?'<span class="pm-intaglio">'+t.pm_desc+"</span>":""}},t)}).join("")}var e={product:'<li class="mod-product-item">\n<div class="product-image tap-action scroller-lazyload" data-tap="detail|#{id}" data-src="#{img}"></div>\n<div class="product-name ui-ellipsis">#{name}</div>\n<div class="product-promotion">\n#{jingxuan}\n#{pm_desc}\n</div>\n<div class="product-specifics theme-grayfont">#{specifics}#{attribute}</div>\n<div class="product-price-wrap">\n<span class="product-price-current">¥#{price}</span>\n#{market_price}\n</div>\n<div class="product-operates">\n<span class="product-operates-item del theme-spline" style="display: none"></span>\n<span class="product-operates-item amount" style="display: none">56</span>\n<span class="product-operates-item add theme-spline"></span>\n</div>\n</li>'};return t}(),e});
/*![m/utils.js]*/define("m/utils",["lib/base","m/main","partner/Partner"],function(a,t,e){var n="/static/bee/img/phone/default_pic_100x100-e06ff6a1.jpg",s={};s.renderProducts=function(){var a={opeWrapper:'<div class="product-operates product-operates-#{id}" data-pid="#{id}" data-showzero="#{showZero}">#{opeItem}</div>',opeDel:'<span class="product-operates-item del tap-action" data-tap="shopping|del,#{id}" data-id="#{id}" data-log=#{opeDelLogParams} #{countStyle}><span class="inner #{borderClass}"></span></span>\n<span class="product-operates-item amount" #{countStyle}>#{count}</span>',opeAdd:'<span class="product-operates-item add tap-action" data-tap="shopping|add,#{id}" data-id="#{id}" data-log=#{opeAddLogParams}><span class="inner #{borderClass} "></span></span>',product:'<li class="mod-product-item #{liTap} #{columnsClass} #{portraitClass} #{customClass}" data-tap="detail|#{id}" data-log=#{detailLogParams}>\n<div class="product-item-inner theme-spline">\n<div class="product-image #{imgTap}" data-tap="detail|#{id}" data-src="#{img}" data-log=#{detailLogParams}>\n<div class="scroller-lazyload product-image-img" data-src="#{img}"></div>\n</div>\n<div class="product-meta-wrap">\n<div class="product-name ui-ellipsis">#{name}</div>\n<div class="product-promotion">\n#{jingxuan}\n#{pm_desc}\n</div>\n<div class="product-specifics theme-grayfont ui-ellipsis">#{specifics}#{attribute}</div>\n<div class="product-price-wrap">\n<span class="product-price-current"><span class="price-yuan">¥</span>#{price}</span>\n#{market_price}\n</div>\n#{opeWrapper}\n</div>\n<div>\n</li>'},e=t.getShoppingCart(),n=function(t,n){var s=e.getProductById(t.id),i=s&&s.shoppingCount||0,n=n||{};return $.formatString(a.opeWrapper,t,{opeItem:t.number>0?$.formatString(n.hideDel?a.opeAdd:a.opeDel+a.opeAdd,t,{countStyle:i||n.showZero?"":'style="display:none;"',count:i,borderClass:i?"":"theme-spline",opeAddLogParams:JSON.stringify($.extend({actionType:"cartAdd"},n.logParams)),opeDelLogParams:JSON.stringify($.extend({actionType:"cartDel"},n.logParams))}):'<span class="product-restock">'+(1==t.cart_group_id?"已抢光":"补货中")+"</span>",showZero:n.showZero?1:0})},s=function(t,s){s=s||{},$.isNuomi&&!s.onlyOpe&&(s.hideDel=!0);var i=!$.isBoolean(s.isPortrait)||s.isPortrait,o=i?s.customClass:(s.customClass||"")+" theme-spline",r=i?"":"mod-product-item-portrait cf",d=function(t){e.addProductData(t);var d={hideDel:s.hideDel,showZero:s.showZero,logParams:s.extraLogParams||{}};return s.onlyOpe?n(t,d):$.formatString(a.product,{liTap:s.itemDetail?"tap-action":"",imgTap:s.itemDetail?"":"tap-action",opeWrapper:n(t,d),customClass:o,portraitClass:r+(1==t.is_xf?" product-item-had-embossed":""),detailLogParams:JSON.stringify($.extend({actionType:"detail"},s.extraDetailLogParams||{})),columnsClass:function(){var a=$.isNumber(s.columns)?s.columns:2;return 2!=a&&3!=a||!i?"":"mod-product-item-columns"+a},market_price:function(){var a="";return $.isNuomi&&t.number>0&&(2==s.columns||!s.columns)&&(a+=this.pm_desc()),t.market_price>t.price&&(a+='<span class="product-price-market theme-grayfont"><span class="price-yuan">¥</span>'+t.market_price+"</span>"),a},jingxuan:function(){var a=$.isDaojia58?"pm-intaglio":"pm-embossed";return"1"==t.is_xf?'<span class="'+a+'">精选</span>':""},pm_desc:function(){return t.had_pm&&t.pm_desc?'<span class="pm-intaglio">'+t.pm_desc+"</span>":"&nbsp;"}},t)};return $.isObject(t)?d(t):t.map(d).join("")};return s}(),s.renderOrderProduct=function(){var a={product:'<tr class="theme-spline spline-top">\n<td class="name ui-ellipsis">#{name}</td>\n<td class="count">x#{buy_num}</td>\n<td class="price">￥#{priceFloat}</td>\n</tr>',giftProduct:'<tr class="gift-tr">\n<td class="name ui-ellipsis"><span class="label-gift">赠<span class="theme-nuomi-hidden">品</span></span>&nbsp;#{name}</td>\n<td class="count" width="30px">x#{buy_num}</td>\n<td class="price" width="50px">&nbsp;</td>\n</tr>'};return function(t){var e=['<table class="mod-order-products">'];return $.each(t,function(t,n){$.each(n,function(t,n){e.push($.formatString(1==n.is_gift?a.giftProduct:a.product,n,{buy_num:n.goods_num||n.goods_nums,priceFloat:parseFloat(n.price||n.goods_price)}))})}),e.push("</table>"),e.join("")}}(),s.renderEmptyNotice=function(a,t,e){return $.formatString('<div class="empty-notice theme-grayfont"><div class="notice-icon"></div>#{msg}<br/><span class="theme-spline tap-action" #{showBtn} data-tap="#{dataTap}">#{btnText}</span></div>',{msg:a,btnText:t,dataTap:e||"empty",showBtn:t?"":'style="display:none;"'})};var i=0;return s.shoppingFly=function(a,t){if(a&&t){var e=a[0],n=t[0];if(e&&n){var s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),r=i++,d=s.left+s.width/2>o.left+o.width/2?"-":"",p=o.left+.5*o.width-s.left-.5*s.width,l=o.top+.5*o.height-s.top-.5*s.height;o.width&&o.height&&($($.formatString('<div id="mod-pub-shopping-fly-#{id}" class="mod-pub-shopping-fly" style="top:#{top}px;left:#{left}px;"><div class="shopping-fly-inner" style="width:#{width}px;height:#{height}px;background-image:url(#{img});"></div></div>',s,{img:a.data("src"),id:r})).appendTo("body"),setTimeout(function(){var a=$("#mod-pub-shopping-fly-"+r),t=a.find(".shopping-fly-inner");a.css({"-webkit-transform":"translateY("+l+"px)"}),t.css({"-webkit-transform":"translateX("+p+"px) scale(.3) rotate("+d+"90deg)",opacity:0}),setTimeout(function(){a.remove()},600)},10))}}},s.renderOrderImgs=function(a){var t={wrap:'<ul class="mod-order-imgs clearfix">\n#{products}\n#{dots}\n</ul>',product:'<li class="order-goods-li">\n<img src="#{img}" alt="#{name}" width=40 height=40 />\n</li>',dots:'<li class="order-goods-dot"></li><li class="order-goods-dot"></li><li class="order-goods-dot"></li>'},e=$.formatString,s=[],i="",o="";return a.order_goods.forEach(function(a){a.forEach(function(a){s.push(a)})}),s.length>4&&(o=t.dots,s.length=4),i=s.map(function(a){return e(t.product,{img:a.img||n},a)}).join(""),e(t.wrap,{dots:o,products:i},a)},s.appendHtmlContent=function(t,e,n){var s=[],i=[],o=-1,r=-1;n&&n(50),e=e.replace(/(<link\s.+?\/?>|<style(.|\n|\n\r|\r\n)+?<\/style>)/gim,function(a){return s.push(a),""}),e=e.replace(/<script(.|\n|\n\r|\r\n)+?<\/script>/gim,function(a){return a.indexOf("x-tmpl-mustache")!=-1?a:(i.push(a),"")});var d=function(){r++;var e,s;if(e=i[r])if(n&&n(75+r/i.length.length*25),e.split("\n").length>2)t.append(e),d();else{if(!(s=e.match(/src\s*=\s*['"]?([^'">\s]*)/)))throw"handle script error";a.loadJs({src:s[1],onload:d,onerror:d,parentNode:t})}else n&&n(100)},p=function(){var i,r;if(o++,i=s[o])if(n&&n(50+o/s.length*25),i.indexOf("style")<3)t.append(i),p();else{if(!(r=i.match(/href\s*=\s*['"]?([^'">\s]*)/)))throw"handle css error";a.loadCss({src:r[1],onload:p,onerror:p,parentNode:t})}else t.append(e),setTimeout(d,10)};p()},s.px1=function(){var a=e.getLogicConf("px1Conf"),t={UL:"li",OL:"li"};if(a){$.fn.__append=$.fn.append;var n=function(e){e=$(e);var n=function(a,e){if("TR"!=e.tagName&&"TABLE"!=e.tagName&&"FIELDSET"!=e.tagName){var n=$(e);n.data("px1")&&a!=-1||n.addClass("px1 "+i.map(function(a){return"px1-p-"+a}).join(" ")).__append(i.map(function(a){return $.formatString('<#{tagName} class="px1-c px1-c-#{p}"></#{tagName}>',{p:a,tagName:t[e.tagName]||"div"})}).join(""))}};for(var s in a){var i=a[s].split(" ");e.is(s)?n(-1,e[0]):e.find(s).each(n).data("px1",1)}},s=function(a){var t=$.fn[a];$.fn[a]=function(){var a=t.apply(this,arguments);return this.each(function(a,t){n(t)}),a}};s("html"),s("append"),s("prepend")}},s.renderTabs=function(a){var t='<li class="tab tab-type#{key} tap-action" data-key=#{key} data-tap="#{action}" style="width:#{width}">#{name}</li>',e=a.data,n=e.map(function(n){return $.formatString(t,{key:n.key,name:n.name,width:1/e.length*100+"%",action:a.action||"switchTab"})}).join(""),s=$(a.appendTo);s.html(n).addClass("tabs");var i=function(a){s.find(".tab").removeClass("active"),s.find(".tab-type"+a).addClass("active")};return i(a.active||e[0].key),s.on($.tapClick,".tab",function(){i($(this).data("key"))}),{activate:i,destroy:function(){s.off($.tapClick)}}},s.renderCouponList=function(a){if(a.data.length<1)return"";var t,e=a.selectedId,n=a.showCouponType,s=a.customCls||"",i={couponItem:'<li class="coupon-item coupon-item-enable-#{enable} tap-action #{selected}" data-tap="select|#{id}" data-pwd="#{card_pwd}">\n#{label}\n<div class="coupon-info-left">\n<div class="coupon-item-value">\n<div class="coupon-item-value-inner">\n<span class="sub">￥</span>#{valueStr}#{statusText}\n</div>\n</div>\n<span class="coupon-show-reason tap-action" data-tap="disabledReason|#{id},#{reasonLength}" style="display:#{showReasonDisplay}">查看原因</span>\n</div>\n<div class="coupon-info-right">\n<fieldset class="coupon-item-fieldset">\n<legend class="coupon-item-name">#{name}</legend>\n<div class="coupon-item-time ui-ellipsis">#{start_time}至#{end_time}</div>\n<div class="coupon-item-description">#{description}</div>\n</fieldset>\n</div>\n<div class="coupon-item-radius coupon-item-radius-left"></div>\n<div class="coupon-item-radius coupon-item-radius-right">\n<div class="icon-ok"></div>\n</div>\n<div class="coupon-sp"></div>\n</li>\n<li class="coupon-reason coupon-reason-#{disabled} tap-action" data-tap="hideReason" data-log="disableReasons">\n<ul class="coupon-disabled-reason">#{disabledReason}</ul>\n</li>'},o=a.data;return t=o.map(function(a){return a.disabled=a.disabled||0,$.formatString(i.couponItem,a,{label:3==a.type&&n?'<span class="label">积分券</span>':"",showReasonDisplay:a.disabled_reasons&&a.disabled_reasons.length?"inline":"none",reasonLength:a.disabled_reasons?a.disabled_reasons.length:0,selected:e&&e==a.id?"coupon-item-selected":"",statusText:function(){var t=!1;return 1==a.disabled?t="不可用":1==a.status?t="已使用":2==a.status?t="已过期":a.tag&&(t='<span class="theme-redfont">'+a.tag+"</span>"),t?'<br/><span class="status">'+t+"</span>":""},valueStr:function(){var t=parseFloat(a.value);return isNaN(t)?a.value:t},enable:void 0!==a.status?0==a.status:1!=a.disabled,disabledReason:function(){if(a.disabled_reasons&&a.disabled_reasons.length){var t=[];return $.each(a.disabled_reasons,function(a,e){t.push("<li>",e,"</li>")}),t.join("")}return""}})}).join(""),'<ul class="mod-coupon-list'+s+'">'+t+"</ul>"},s});
/*![m/lazylogic.js]*/setTimeout(function(){window._m_lazy_loaded()},10);
/*![m/ViewMgr.js]*/define("m/ViewMgr",["lib/EventObj","lib/Loading","lib/Scroller","partner/Partner","common/User"],function(t,e,i,n,s){var r=function(t){return function(){return this.containerNode?this.containerNode[t].apply(this.containerNode,arguments):$()}},a=function(t){return function(){return this.isShowing()?n[t].apply(n,arguments):this._dialogArgs={method:t,args:arguments},this}},o=function(t,e){if(!t)return{};e=e||"left",t=$.trim(t);var i,n={};return(i=t.match(/^(\w+)\[(.+)\]$/))?(n[e+"Icon"]=i[1]+" header-icon-textico",n[e+"Text"]=i[2]):(i=t.match(/^\[(.+)\]$/))?(n[e+"Icon"]="textext",n[e+"Text"]=i[1]):n[e+"Icon"]=t,n},h=function(t,e){e&&(t.containerNode.addClass("fix-passthrough"),setTimeout(function(){t.containerNode&&t.containerNode.removeClass("fix-passthrough")},800)),t.containerNode.css("display",e?"block":"none")},c={wrap:'<div id="mod-pageview-#{id}" class="mod-#{viewName} mod-pageview #{hadTitle} #{isRoot}" style="z-index:#{zIndex};display:block;" data-stack="#{viewMgrId}">#{titleHtml}#{contentHtml}</div>',title:'<header class="pub-header spline-bottom #{className}">\n<span class="tap-action header-icon header-left header-icon-#{leftIcon}" data-tap="#{leftTap}" data-log=#{leftTapLog}>#{leftText}</span>\n<div class="header-content ui-ellipsis tap-action" data-tap=\'titleTap\' data-log=#{titleTapLog}>#{titleContent}</div>\n<span class="tap-action header-icon header-right header-icon-#{rightIcon}" data-tap="#{rightTap}" data-log=#{rightTapLog}>#{rightText}</span>\n<div class="header-percent theme-bg"></div>\n</header>',titleTab:'<span class="title-tab-item title-tab-#{key} tap-action theme-border" data-tap="titleTab|#{key}">#{name}</span>',titleForm:'<form class="title-form" onsubmit="return false;">\n<input type="search" class="title-form-query" maxlength="10" placeholder="#{placeholder}">\n<input type="reset" class="title-form-reset">\n</form>'},l=0,d=function(t,e,i){i=i||0,this.id=++l,this.viewName=t,this.viewFn=e,this.deep=i,this.zIndex=100+i,this._listener=[],this._scrollers={},this.viewMgr=null,this.percent=0,this._dialogArgs=null};d.prototype={init:function(t){var e=this.viewFn(this),s=this;s.viewObj=e;var r=e.html.title,a=n.getLogicConf(this.viewName+"_title_overlay");$.isObject(a)&&(r=$.extend({},r,a));var h=r?"pageview-hadtitle":"";$("#mod-container").append($.formatString(c.wrap,this,{hadTitle:h,isRoot:1==s.viewMgr.getLength()?"pageview-isroot":"",titleHtml:h?$.formatString(c.title,r,{className:"theme-spline",titleContent:function(){if($.isString(r.contentHtml))return s._titleText=r.contentHtml,r.contentHtml;if($.isArray(r.contentHtml)){s._titleTabs=r.contentHtml,setTimeout(function(){s._titleTab(r.contentHtml[0].key)},10);var t=[,$.formatString(c.titleTab,r.contentHtml[0]),$.formatString(c.titleTab,r.contentHtml[1])];return t.join("")}if($.isObject(r.contentHtml)&&r.contentHtml.placeholder){s._titleText=r.contentHtml.text,s._titleInput=!0;var e="",i=function(){if(s.containerNode){var t=s.find(".title-form-query").val();t!=e&&(s.viewMethod("action_formQueryChange")(t),e=t),setTimeout(i,500)}};return setTimeout(i,800),$.formatString(c.titleForm,r.contentHtml)}},titleTapLog:JSON.stringify(r.titleTapLog),leftTap:r.left&&r.left.indexOf("[")?r.left.replace(/\[.+\]/,""):r.left,leftTapLog:JSON.stringify(r.leftTapLog),rightTap:r.right,rightTapLog:JSON.stringify(r.rightTapLog)},o(r.left,"left"),s._rightTitleBtn=o(r.right,"right")):"",contentHtml:e.html&&e.html.contentHtml})),this.containerNode=$("#mod-pageview-"+this.id),this.delegate(".tap-action",$.tapClick,function(t){t.preventDefault(),t.stopPropagation();var e=s.viewMethod("getTrackId")?s.viewMethod("getTrackId")():"";s.actionNode=$(this);var i=s.actionNode.attr("disabled");if(""!==i&&"true"!==i){var r=$(this).data("tap"),a=r.split("|"),o=a[0],h=a[1]?a[1].split(",").map(function(t){return decodeURIComponent(t)}):[];if("back"==o?s.finishView(null,!0):"changeView"==o?s.changeView(h[0]):"titleTab"==o?s._titleTab(h[0]):"exit"==o?n.exit():d._actionHandlers[o]?d._actionHandlers[o].apply(s,h):s.viewMethod("action_"+o).apply(this,h),$(this).data("log")){var c=$(this).data("log")||{};$.isString(c)&&(c={actionType:c});var l=c.action||e;l&&(delete c.action,base.clickLog(l,c))}}}),this.containerNode.find(".scroller").each(function(t,e){var n=$(e).data("scroller")||Math.random();s._scrollers[n]=new i(e,{imgLazyLoad:!0})}),this.viewMethod("init")(t),$.each(this._scrollers,function(t,e){e.refresh()}),this._partner_updateTitle()},isShowing:function(){return this.viewMgr.isShowing()&&this.viewMgr.getCurView()==this},headerLoading:function(t){if(t=parseInt(t)||0,0==t||t>this.percent||100==this.percent){this.percent=t;var e=!1,i=this;t<1?(t=0,e=!0):t>99&&(e=!0,setTimeout(function(){i.find(".header-percent").css("width",0)},800)),setTimeout(function(){i.find(".header-percent").css("width",t+"%")[e?"addClass":"removeClass"]("finish-percent")},10)}},setTitle:function(t){this.find(".header-content").html(t),this._titleText=t,this._partner_updateTitle()},setTitleRightBtn:function(t){var e=this.find(".header-right").removeClass("header-icon-"+this._rightTitleBtn.rightIcon);this._rightTitleBtn=o(t.right,"right"),e.html(this._rightTitleBtn.rightText||"").data("tap",t.rightTap||t.right).addClass("header-icon-"+this._rightTitleBtn.rightIcon),this._partner_updateTitle()},setContent:function(t){this.containerNode.html(t)},changeView:function(t,e){this.viewMgr.changeView(t,e)},replaceView:function(t,e){this.viewMgr.replaceView(t,e)},finishView:function(t,e){this.viewMgr.popView(t,e)},listen:function(t,e,i){var n=this;return t.on&&(this._listener.push([t,e,i]),t.on(e,i)),function(e,i){return n.listen(t,e,i)}},getScroller:function(t){if(t)return this._scrollers[t]||!1;for(var e in this._scrollers)return this._scrollers[e];return null},showLoading:function(t){return n.isSupport("showLoading")?(this._loadingText=t||"加载中",this._partner_showLoading()):e.show(t,this.containerNode),this},hideLoading:function(){return n.isSupport("showLoading")?this._partner_hideLoading():e.hide(this.containerNode),this},alert:a("alert"),confirm:a("confirm"),tip:a("tip"),popSelect:a("popSelect"),viewMethod:function(t){var e=this;return e.viewObj&&e.viewObj[t]?function(){var i=this&&this.tagName?this:e;return e.viewObj[t].apply(i,arguments)}:$.noop},find:r("find"),addClass:r("addClass"),removeClass:r("removeClass"),hasClass:r("hasClass"),append:r("append"),on:r("on"),delegate:r("delegate"),destroy:function(){this.viewMethod("onDestory")(),this.viewObj=null,$.each(this._listener,function(t,e){e[0].off(e[1],e[2])}),$.each(this._scrollers,function(t,e){e.destroy()}),this._scrollers=null,this._listener=null,this.containerNode.off().remove(),this.containerNode=null},update:function(){var t=this.viewMgr.getLength();return this[1==t?"addClass":"removeClass"]("pageview-isroot").css("z-index",100+t),h(this,this.isShowing()),this},_titleTab:function(t){t!=this._titleTabKey&&!1!==this.viewMethod("action_titleTab")(t)&&(this.find(".title-tab-item").removeClass("theme-bg"),this.find(".title-tab-"+t).addClass("theme-bg"),this._titleTabKey=t)},_onResume:function(){this._dialogArgs&&(n[this._dialogArgs.method].apply(n,this._dialogArgs.args),this._dialogArgs=!1);for(var t in this._scrollers)this._scrollers[t].isHidden=!1;return this._partner_updateTitle(),this._partner_showLoading(),this.viewMethod("onResume").apply(this,arguments)},_onBreak:function(){for(var t in this._scrollers)this._scrollers[t].isHidden=!0;return this.viewMethod("onBreak").apply(this,arguments)},_onBeforeBack:function(){return this.viewMethod("onBeforeBack").apply(this,arguments)},_partner_updateTitle:function(){var t,e=this;if(n.getLogicConf("hideHeader")){if((t=n.getLogicConf("hideHeaderExclude"))&&$.isInArray(t.viewNames,this.viewName))return n.setHeaderTitle(t.title),n.setHeaderRightIcon(),void this.addClass("hide-header-exclude");if(this._titleText&&$.isString(this._titleText)&&n.isSupport("setHeaderTitle")?n.setHeaderTitle($.htmlToText(this._titleText),this.viewMethod("action_titleTap")):this._titleTabs&&n.isSupport("setHeaderTabs")&&n.setHeaderTabs(this._titleTabs,function(t){e._titleTab(t)}),n.isSupport("setHeaderRightIcon"))if(this._rightTitleBtn&&this._rightTitleBtn.rightIcon&&!this._titleInput){var i=this._rightTitleBtn.rightIcon.split(" ")[0],s=!!this._rightTitleBtn.rightText&&$.htmlToText(this._rightTitleBtn.rightText);n.setHeaderRightIcon(i,s,function(){e.find(".pub-header .header-icon-"+i).trigger($.tapClick)})}else n.setHeaderRightIcon()}},_partner_showLoading:function(){this._loadingText&&this.isShowing()&&n.showLoading(this._loadingText)},_partner_hideLoading:function(){this._loadingText&&(this._loadingText=!1,n.hideLoading())}},d._actionHandlers={},d.regDefaultActionHandler=function(t,e){return d._actionHandlers[t]=e,d};var u={};n.isSupport("setOnBackFn")&&n.setOnBackFn(function(){for(var t in u)u[t].onPopstate()});var g=$.inherits(t,{constructor:function(e,i){t.call(this),this.name=e||"",this.isMain=!!i,this.stack=[],this._checkViews={},this._isShowing=!1,u[this.id]=this;var s=this;this.onPopstate=function(){s._isShowing&&(s.stack.length>1?(s.popView(null,!0),s._pushState()):1==s.stack.length&&(s.getCurView()._onBeforeBack()!==!1?s.fire("beforeExit",{},function(){n.isSupport("exit")?n.exit():history.back()}):s._pushState()))},n.isSupport("setOnBackFn")||$(window).on("popstate",this.onPopstate)},hasView:function(t){var e=!1;return this.stack.forEach(function(i){if(t==i.viewName)return e=!0,!1}),e},changeView:function(t,e){var i=this.getCurView(),s=this._getCheckView(t);return"verify"==s&&n.isSupportPartnerLogin()&&n.getLogicConf("partnerLoginDirectly")||i&&(i._onBreak(),h(i,!1)),this._pushView(t,e),this},replaceView:function(t,e){var i=this.getCurView();return"verify"==t&&n.isSupportPartnerLogin()&&n.getLogicConf("partnerLoginDirectly")||(i&&i.destroy(),this.stack.pop()),this._pushView(t,e),this},_getCheckView:function(t){for(var e in this._checkViews)if(this._checkViews[e](t))return e;return!1},_pushView:function(t,e){var i=this,r=this._getCheckView(t);if("verify"==r&&n.isSupportPartnerLogin()&&n.getLogicConf("partnerLoginDirectly")){var a=s.getInstance();return void((errmsg=a.isSnsLoginFailed())?n.alert("暂时无法为您自动登录"):a.snsLogin(function(s,r){s?i._pushView(t,e):r&&n.alert(r)}))}if(r)return void this._pushView(r,{targetView:t,args:e});var o=Bee.getMod("m/view_"+t),c=new d(t,o,this.stack.length);return c.viewMgrId=this.id,c.viewMgr=this,this.stack.push(c),this._isShowing=!0,c.init(e||{}),h(c,!0),g._onViewShow(c),this.deferFire("change"),this._pushState(),this},popView:function(t,e){var i=this.getCurView(),n=this.stack[this.stack.length-2];return i?e&&i._onBeforeBack()===!1?this:(i.destroy(),this.stack.pop(),this.deferFire("change"),n?(h(n,!0),n._onResume(i.viewName,t),g._onViewShow(n),i=null,this):this):this},getCurView:function(){return this.stack[this.stack.length-1]},getLength:function(){return this.stack.length},isShowing:function(){return this.stack&&this.stack.length&&this._isShowing},hide:function(){var t=this.getCurView();return t&&(t._onBreak(),h(t,!1)),this._isShowing=!1,this},show:function(t){this._isShowing=!0;var e=this.getCurView();return e&&(h(e,!0),e._onResume(null,t||null),g._onViewShow(e)),this},setCheckView:function(t,e){return $.isObject(t)?$.extend(this._checkViews,t):this._checkViews[t]=e,this},clearBefore:function(){for(var t=0,e=this.stack.length;t<e;t++){var i=this.stack[t];t!=e-1?i.destroy():(this.stack=[i],i.update())}return this.deferFire("change"),this},clear:function(){for(var t=0,e=this.stack.length;t<e;t++){var i=this.stack[t];i.destroy()}return this.stack=[],this.deferFire("change"),this},clearToRoot:function(){if(!(this.stack.length<2)){for(var t=this.stack.length,e=t-1;e>0;e--){var i=this.stack[e];i.destroy()}this.stack=[this.stack[0]];var n=this.stack[0].update();return n._onResume(null,null),g._onViewShow(n),this.deferFire("change"),this}},clearTo:function(t){for(var e,i=this.stack.length,n=this.stack.length,s=n-1;s>=0;s--){var r=this.stack[s];if(r.viewName==t){i=s,e=r;break}r.destroy()}if(e)return this.stack.length=i+1,e.update(),e._onResume(null,null),g._onViewShow(e),this.deferFire("change"),this},destroy:function(){delete u[this.id],$.each(this.stack,function(t,e){e.destroy()}),this.stack=this._checkViews=null,$(window).off("popstate",this.onPopstate),this.fire("destroy")},_pushState:function(){if(!n.isSupport("setOnBackFn")){var t=this;setTimeout(function(){!window.history.state&&window.history.pushState&&t.stack&&(!t.isMain||t.stack.length>1)&&window.history.pushState(1,"爱鲜蜂")},10)}}});return g.BaseView=d,g.setViewShowHandler=function(t){return g._onViewShowFn=t,this},g._onViewShow=function(t){g._onViewShowFn&&g._onViewShowFn(t)},g.getCurShowing=function(){for(var t in u)if(u[t].isShowing())return u[t];return!1},g});
/*![m/GoodsFavorite.js]*/define("m/GoodsFavorite",["lib/base","lib/EventObj","partner/Partner"],function(i,t,s){var n=i.onceExecMulitCallFn(function(){var t=this;i.ajaxPost("/data/goodsFavorite",{},function(i){t.done(i)})}),o=$.inherits(t,{constructor:function(){t.call(this),this.goodsList=[],this.isInited=!1},_fetchList:function(){var i=this;n(function(t){0==t.errno?(i.goodsList=t.data.col_list||[],i.fire("change")):(s.alert(t.errmsg),i.fire("error"))})},init:function(){this.isInited||(this._fetchList(),this.isInited=!0)},getList:function(){return this.goodsList},has:function(i){var t=this,s=t.getList();return s.some(function(t){return t.id==i})},get:function(i){var t=this,s=null,n=t.getList();return n.some(function(t){return t.id==i&&(s=t),t.id==i}),s},add:function(t){var n=this;return s.showLoading("正在收藏"),i.ajaxPost("submit/goodsFavoriteAdd",{id:t.id,zchtid:t.zchtid},function(o){s.hideLoading(),0==o.errno&&0==o.data.code?n.has(t.id)?($.isFunction(t.callback)&&t.callback({success:!0,col_id:o.data.col_id}),n.fire("change"),s.tip("收藏成功")):i.ajaxPost("/data/goodsFavorite",{},function(i){0==i.errno?(n.goodsList=i.data.col_list,s.tip("收藏成功"),n.fire("change"),$.isFunction(t.callback)&&t.callback({success:!0,col_id:o.data.col_id})):(s.alert(i.errmsg),$.isFunction(t.callback)&&t.callback({success:!1}),n.fire("error"))}):($.isFunction(t.callback)&&t.callback({success:!1}),s.alert(o.errmsg||o.data.msg))})},remove:function(t){var n=this,o=$.isArray(t.ids)?t.ids.join(","):t.ids;return s.showLoading("取消收藏"),i.ajaxPost("submit/goodsFavoriteRemove",{ids:o,type:t.type,zchtid:t.zchtid},function(i){s.hideLoading();var a=0==i.errno&&0==i.data.code;if(a){s.tip("已取消收藏");var e=o.split(","),c=n.getList().filter(function(i){return e.indexOf(i.col_id)<0});n.goodsList=c,n.fire("change")}else s.alert(i.errmsg||i.data.msg);$.isFunction(t.callback)&&t.callback({success:a})})},reset:function(){this.goodsList=[],this.isInited=!1}});return new o});
/*![m/Nav.js]*/define("m/Nav",["lib/EventObj","m/ViewMgr"],function(e,t){var i={item:'<li class="navs-item navs-item-#{key} #{current}" data-key="#{key}" style="width:#{percent}%;"><div class="navs-bubble"></div>#{title}</li>'},n=$.inherits(e,{constructor:function(t){e.call(this),this.navsConf={},this.containerNode=$(t),this.isInited=this.curKey=this.defKey=!1;var i=this;this.viewChangeHandler=function(){var e,t=this;t.name==i.curKey&&(1==t.getLength()&&(e=t.getCurView())&&i.navsConf[e.viewName]?(i.containerNode.css("display","block").find(".navs-current").removeClass("navs-current"),i.containerNode.find(".navs-item-"+e.viewName).addClass("navs-current")):i.containerNode.css("display","none"),0==t.getLength()&&i.switchNav())}},init:function(e,t){this.isInited=!0,this.render();var i=this.getNav(e);this.curKey=i.key,i.viewMgr.changeView(i.key,t||i.args);var n=this;return this.containerNode.delegate(".navs-item",$.tapClick,function(){var e=$(this).data("key");n.switchNav(e);var t;switch(e){case"home":t="home";break;case"menu":t="category";break;case"act":t="alike";break;case"cart":t="cart";break;case"mine":t="my"}base.clickLog("tab_action",{actionType:t})}),this},switchNav:function(e,t){if(e=e||this.defKey,e!=this.curKey){var i=this.getNav(e);return i?(this.getNav()&&this.getNav().viewMgr.hide(),0==i.viewMgr.getLength()?i.viewMgr.show().changeView(i.key,t||i.args):i.viewMgr.show(t),this.curKey=e,this.viewChangeHandler.call(i.viewMgr),this.deferFire("switch"),this):this}},render:function(){var e=this,t=[],n=0;return $.each(this.navsConf,function(){n++}),$.each(this.navsConf,function(s,a){e.curKey||(e.curKey=a.key),t[a.index]=$.formatString(i.item,a,{current:e.curKey==a.key?"navs-current":"",percent:100/n}),"bubble"in a&&setTimeout(function(){e.setNavBubble(s,a.bubble)},10)}),this.containerNode.html(t.join("")),this},setNav:function(e,i){this.defKey||(this.defKey=e),this.navsConf[e]&&"bubble"in this.navsConf[e]&&(i.bubble=this.navsConf[e].bubble),this.navsConf[e]=i;var n=this;return i.key=e,i.viewMgr=new t(e,e==this.defKey),i.viewMgr.on("beforeExit",function(e){n.curKey!==n.defKey&&(e.preventDefault(),n.switchNav())}),i.checkView&&$.each(i.checkView,function(e,t){i.viewMgr.on("change",n.viewChangeHandler).setCheckView(e,t)}),this.isInited&&this.render(),this},delNav:function(e){var t=this.navsConf[e];if(t)return t.viewMgr.un("change",this.viewChangeHandler).destroy(),delete this.navsConf[e],e==this.curKey&&(this.curKey=!1,this.switchNav(this.defKey)),this.render(),this},getNav:function(e){return e=e||this.curKey,this.navsConf[e]},setNavBubble:function(e,t){if(this.navsConf[e]){this.navsConf[e].bubble=t;var i,n,s=$("#mod-navs .navs-item-"+e+" .navs-bubble");return t===!0||((i=parseInt(t))?(i>99&&(i="99+"),n="num"):n=!1),n?(s.css("display","block").addClass("num-animate navs-bubble-"+n).html(i||""),setTimeout(function(){s.removeClass("num-animate")},100)):s.css("display","none"),this}}});return n});
/*![m/main.js]*/define("m/main",["partner/Partner","common/ShoppingCart","common/User","m/ViewMgr","m/Nav"],function(t,e,n,i,r){var a={cart:1,addredit:1,addrpoi:1,confirm:1,order:2,coupon:2,mine:2,shop:2,points:2};t.getLogicConf("delayVerifyWhenEnterAddrlist")||(a.addrlist=1);var o,s,c,d,u,f=!1,g={verify:function(t){if(c.isLogin())return!1;for(var e in a){var n=a[e];if(1===n&&t==e)return!0;if(2===n&&0===t.indexOf(e))return!0}return!1}},h=function(){d=new r("#mod-navs");var e=t.getLogicConf("hideNavsItems")||[],n=t.getLogicConf("extraNavsItems")||[],i=(t.getLogicConf("alwaysShowActNav"),[{title:"首页",index:10,key:"home"},{title:"闪送超市",index:20,key:"menu"},{title:"购物车",index:30,key:"cart"},{title:"我的",index:40,key:"mine"}].filter(function(t){return!$.isInArray(e,t.key)}).concat(n).sort(function(t,e){return t.index-e.index}));i.forEach(function(t){t.checkView=g,d.setNav(t.key,t)});var a=function(){if(!$.isInArray(e,"act")){var t=s.tmr_detail;t&&d.setNav("act",{title:t.name,index:25,checkView:g,args:{activityObj:t,isAutoload:!1}})}};"done"==s.status&&a(),s.on("progressing",function(t){"doing"==t.status||("done"==t.status?a():d.delNav("act"))})},l=function(){var n=Bee.getMod("m/utils",!0);n&&n.px1();var r=function(t,n){var i=e.getProductById(t),r=parseInt(n.data("showzero")),a=i&&i.shoppingCount||0,o=0!=a||r?"":"none",s=a?"removeClass":"addClass";n.find(".del").css("display",o).find(".inner")[s]("theme-spline"),n.find(".amount").html(a).css("display",o),n.find(".add .inner")[s]("theme-spline")};$.extend(i.BaseView.prototype,{switchNav:function(t,e){d.switchNav(t,e)},bindShoppingOpe:function(){var t=this;this.listen(e,"shoppingListChange",function(e){var n=e.pidsArr;n&&n.length?$.each(n,function(e,n){var i=t.find(".product-operates-"+n);i.length&&r(n,i)}):t.find(".product-operates").each(function(t,e){var n=$(this),i=n.data("id");r(i,n)})})},showCartBtn:function(){if(!this._hadShowCartBtn){this._hadShowCartBtn=!0;var t=this,n=function(){var n=e.cartInfoObj.totalCount;n?(t.find(".cart-btn-num").css("display","block").html(n).addClass("num-animate"),setTimeout(function(){t.find(".cart-btn-num").removeClass("num-animate")},100)):t.find(".cart-btn-num").css("display","none")};this.append('<div class="cart-btn theme-bg tap-action" data-tap="cart"><div class="cart-btn-num"></span></div>'),n(),e.on("shoppingListChange",n)}},getTrack:function(){var t=[];return $.each(this.viewMgr.stack,function(e,n){var i=n.viewMethod("getTrackId")();i&&t.push(i)}),t.join(",")}}),i.BaseView.regDefaultActionHandler("detail",function(t){this.changeView("detail",{id:t})}).regDefaultActionHandler("shopping",function(t,n){if("add"==t){var i=this.getTrack();if(e.addProduct(n,i)){var r=this.actionNode.parents(".mod-product-item").find(".product-image"),a=this._hadShowCartBtn?this.find(".cart-btn"):$("#mod-navs .navs-item-cart");r.length||(r=this.viewMethod("getProductImgNode")()),Bee.getMod("m/utils").shoppingFly(r,a)}}else"del"==t?e.deleteProduct(n):"delall"==t&&e.deleteProduct(n,!0)}).regDefaultActionHandler("cart",function(){this.viewMgr.hasView("cart")?this.viewMgr.clearTo("cart"):this.changeView("cart")}).regDefaultActionHandler("share",function(){t.share()}).regDefaultActionHandler("selectAddr",function(){var e=t.getLogicConf("showGetGpsBtnWhenSelectAddr");"cart"==this.viewName&&(e=!1),this.changeView("addrlist",{isSelect:!0,showGps:e})}),i.setViewShowHandler(function(e){var n=e.viewMethod("getShareObj")();t.setShare(n)})},v=base.onceExecMulitCallFn(function(){var e=this;t.getLocation(function(t){u=t,e.done(u)})}),p=function(t,e){s=t,o=e,c=n.getInstance(),c.on("statusChange",function(t){if(this.isLogin())o.init();else{var e=d.getNav("cart"),n=d.getNav("mine");e&&e.viewMgr.clear(),n&&n.viewMgr.clear(),d.switchNav(),o.logout()}}),l(),h(),v();var r=window.SYS_CONF;if(r){if(!r.frozenVersion&&!r.partner)return;base.addAjaxPublicParamsHandler(function(t){var e,n=i.getCurShowing();if(n&&(e=n.getCurView()))return"act"==e.viewName&&(delete t.frozenVersion,delete t.partner),t})}};return{init:p,initNavs:function(t,n){d.init(t,n);var i=function(){d.setNavBubble("cart",e.cartInfoObj.totalCount)};e.on("shoppingListChange",i),i()},getGPS:function(t){return t&&v(t),u||{}},getUser:function(){return c},getShop:function(){return s},getViewMgr:function(){return gViewMgr},getShoppingCart:function(){return e},getAddrMgr:function(){return o},getCurViewMgr:function(){var t=d.getNav();if(t)return t.viewMgr},getCurView:function(){return this.getCurViewMgr().getCurView()},getCheckView:function(){return g},isOrderStatusChanged:function(){return f},setOrderStatusChanged:function(t){f=t}}});
/*![m/OrderOperate.js]*/define("m/OrderOperate",["lib/base","lib/EventObj","partner/Partner","common/ShoppingCart"],function(e,t,o,r){var a={1:{action:"pay",logAction:"pay"},2:{action:"cancel",logAction:"cancel"},3:{action:"urge",logAction:""},4:{action:"welfare",logAction:"benefits"},5:{action:"drawback",logAction:""},6:{action:"complete",logAction:""},7:{action:"comment",logAction:"comment"},8:{action:"aftersale",logAction:""},9:{action:"delete",logAction:""},10:{action:"again",logAction:""}},i=$.inherits(t,{constructor:function(o,r){if(!o||!o.length)throw new Error("you must set a containerNode to delegate .order-action operate");r=r||{},t.call(this),this.getOrder=r.getOrder||$.noop;var i=this;o.delegate(".order-action",$.tapClick,function(t){t.stopPropagation();var o=$(this),n=o.data("orderid"),c=o.data("orderno"),s=o.data("action")||a[o.data("type")].action,d=a[o.data("type")].logAction;i["_"+s]&&(d&&e.clickLog(r.logAction,{actionType:d}),i["_"+s](n,c))})},_again:function(e,t){var a=this,i=a.getOrder(e,t).order_goods;o.showLoading(),r.again(i),o.hideLoading(),a.fire("operateSuccess",{isSuccess:!0,operation:"again"})},_share:function(e,t){o.share()},_cancelOrder:function(t,r,a,i){var n=this,c=n.getOrder(t,r).cancel_select_msg,s=[];c&&($.each(c,function(e,t){return s.push({name:t,key:e}),!0}),o.popSelect("请选择取消原因",s,function(c){o.showLoading("取消中"),e.ajaxPost("/submit/cancelOrderV2",{orderId:t,orderNo:r,ctype:c},function(e){o.hideLoading(),e.data.code<=200?o.alert(a,function(){n.fire("operateSuccess",{isSuccess:!0,operation:i})}):o.alert(e.data.msg||e.errmsg,function(){n.fire("operateSuccess",{isSuccess:!1,operation:i})})})}))},_cancel:function(e,t){var o=this,r=o.getOrder(e,t);r.cancel_select_msg_1?o.fire("openView",{order:r,operation:"cancel",view:"cancel"}):o._cancelOrder(e,t,"提交成功<br/>正在为您处理，请稍后","cancel")},_delete:function(t,r){var a=this;o.confirm("确定要删除订单吗？",function(){o.showLoading("删除中"),e.ajaxPost("/submit/deleteOrder",{orderId:t,orderNo:r},function(e){o.hideLoading();e.data;0==e.errno?(o.tip("删除成功"),a.fire("operateSuccess",{isSuccess:!0,operation:"delete"})):(o.tip(e.errmsg),a.fire("operateSuccess",{isSuccess:!1,operation:"delete"}))})})},_urge:function(t,r){o.showLoading("信息拉取中"),e.ajaxPost("/submit/urgeOrder",{orderId:t,orderNo:r},function(e){if(o.hideLoading(),0==e.errno){if(o.isSupport("callPhone"))return void o.callPhone(e.data.mobile);o.popSelect(e.data.msg,[{url:"tel:"+e.data.mobile,name:e.data.mobile,key:"tel"}],function(e){})}else o.alert(e.errmsg)})},_drawback:function(e,t){var o=this,r=o.getOrder(e,t);r.cancel_select_msg_1?o.fire("openView",{order:r,operation:"drawback",view:"cancel"}):o._cancelOrder(e,t,"申请成功<br/>感谢您对爱鲜蜂的支持<br/>期待您的下次购物")},_aftersale:function(e,t){this._cancelOrder(e,t,"申请成功<br/>感谢您对爱鲜蜂的支持<br/>期待您的下次购物")},_comment:function(e,t){var o=this,r=o.getOrder(e,t);o.fire("openView",{order:r,operation:"comment",view:"comment"})},_complete:function(t,r){var a=this;o.confirm("请收到货后再确认收货哦~",function(){return o.showLoading("确认中"),e.ajaxPost("/submit/completeOrder",{orderId:t,orderNo:r},function(e){o.hideLoading(),0==e.errno?a.fire("operateSuccess",{isSuccess:!0,operation:"complate"}):o.alert(e.errmsg)}),!1})},_welfare:function(t,r){return o.isSupport("share")?(o.showLoading(),void e.ajaxPost("/show/shareGetNewShare",{orderId:t,orderNo:r},function(e){if(o.hideLoading(),e=e.data,!e||0!=e.code)return void o.tip(e.msg);var t=(e.data.bg_img,e.data.share_url),r=e.data.share_img,a=e.data.share_title,i=e.data.share_intro;o.setShare({title:a||"粗线吧，鲜蜂侠！猛戳即可得红包，鲜蜂侠闪现！",link:t,imgUrl:r||"http://m.beequick.cn/static/bee/img/phone/sharecoupon/share-88aef73d.jpg",desc:i||"爱鲜蜂，红包无限送。有钱就是任性！",limitWeixin:1}),o.share(!0)})):void o.tip("当前环境不支持分享")},_pay:function(e,t,r){1==arguments.length&&(r=e,e=t=null);var a=this.getOrder(e,t),i=this;if(!a)return void o.alert("订单信息获取失败");var n=o.getSupportPays().filter(function(e){return 0!=e.typeid});if(0==n.length)o.alert("没有支持的支付方式");else if(1==n.length)this._doPay(n[0],a);else{for(var c=[],s={},d=0,l=n.length;d<l;d++){if(payObj=n[d],r&&payObj.key==r)return void this._doPay(payObj,a);s[payObj.key]=payObj,c.push({key:payObj.key,name:payObj.name})}o.popSelect("选择支付方式",c,function(e){i._doPay(s[e],a)})}},_doPay:function(e,t){var r=this;o.showLoading(e.name+"进行中"),e.pay(t,function(){o.hideLoading(),r.fire("operateSuccess",{isSuccess:!0,operation:"pay"})},function(e){o.hideLoading(),e?o.alert("支付失败："+e,function(){r.fire("operateSuccess",{isSuccess:!1,operation:"pay"})}):r.fire("operateSuccess",{isSuccess:!1,operation:"pay"})}),setTimeout(function(){o.hideLoading()},3e3)}});return i});
/*![m/view_about.js]*/define("m/view_about",["m/main"],function(t){var n={title:{left:"back",contentHtml:"关于我们"},contentHtml:'<div class="main">\n<div class="main-top">\n<h1 class="about-logo">爱鲜蜂</h1>\n<p class="about-weixin">微信：beequick24<p>\n</div>\n<div class="about-footer">\n<p class="about-company">北京众成汇通信息技术有限公司</p>\n<p class="about-copyright theme-grayfont">Copyright ( c ) 2014-2015 beequick<br/>all rights reserved</p>\n<p class="about-zizhi theme-grayfont">京ICP证150771号<br/>食品流通许可证编号：SP1101051510350669(1-1)</p>\n</div>\n<div>'};return function(t){return{html:n}}});
/*![m/view_act.js]*/define("m/view_act",["partner/Partner","activity/bridge_m","m/utils","m/main"],function(t,e,a,i){var d={title:{left:"back",right:"reload"},contentHtml:'<div class="main">\n<div class="toolbar">\n<div class="toolbar-addr ui-ellipsis tap-action" data-tap="selectAddr"></div>\n</div>\n<div class="error"></div>\n<div class="activity"></div>\n</div>'};return function(n){var o=!1,r=null,s=null,c=!1,l=function(){if(!o){o=!0;var t={},e="_bee_act_cb_"+parseInt(1e5*Math.random());r.ext_params&&(t=r.ext_params),n.setTitle(r.name),1!=r.hide_cart&&n.showCartBtn(),1==r.show_reload?n.removeClass("act-hidereload"):n.addClass("act-hidereload"),n.find(".activity").html(""),n.showLoading(),n.headerLoading(30),window[e]=g,$.ajax({url:"/show/active",type:"GET",data:$.extend(base.getAjaxPublicParams(),{shopId:i.getShop().shopId,id:r.id,actparams:r.actparams,cb:e},t),dataType:"text",success:function(t){u(t)},error:function(t,e){u(!1,e)}})}},u=function(t,e){var i=n.find(".activity");return!t||$.isString(t)&&($.trim(t).length<10||t.indexOf("<script")==-1)?(i.html(a.renderEmptyNotice("abort"==e?"网络错误":"亲们太热情，鲜蜂侠忙不过来了，等会再试吧")),n.hideLoading(),n.headerLoading(100),void(o=!1)):(o=!0,void a.appendHtmlContent(i,t,function(t){n.headerLoading(t),100==t&&(o=!1)}))},h=!1,g=function(a,i){h||Bee.virtualMod("activity/bridge",function(){return h?h:h=new e(a,n)});var d=Bee.getMod("activity/act_"+a,!0);d?(s=d,h.isAutoload=gIsAutoload,h.activityLoaded(a,i),d.init&&d.init(i),d.getShareObj&&t.setShare(d.getShareObj()),n.headerLoading(100),n.hideLoading()):(n.headerLoading(100),n.hideLoading())},v=function(t){return!t&&s&&s.onRefresh?void s.onRefresh():void l()},f=function(t,e){"verify"==t&&e&&e.isLogin?l():"addrlist"==t&&h.selectAddressCallback?(e&&e.addr?h.selectAddressCallback(!0,e.addr.id,e.addr):h.selectAddressCallback(!1),h.selectAddressCallback=null):c&&t&&m()},p=function(){var t=i.getShop().addrName||"加载中";n.find(".toolbar-addr").text(t)},m=function(){if(n.isShowing()){var t=i.getShop();"loading"==t.status?(n.showLoading(),p()):"done"==t.status?(n.removeClass("err-shop"),n.hideLoading(),p(),l()):(n.hideLoading(),n.addClass("err-shop"),n.find(".error").html(a.renderEmptyNotice(t.statusText,"换个地址试试","selectAddr")))}},b=function(t){r=t.activityObj,gIsAutoload=!!t.isAutoload,c=t.watchShopStatus,c?(n.addClass("mod-act-watchShop"),m(),n.listen(i.getShop(),"progressing",m)):l()};return{html:d,init:b,getTrackId:function(){return 0==n.deep?"preorder_action":"motiliny_action"},action_reload:v,getShareObj:function(){if(s&&s.getShareObj)return s.getShareObj()},onBeforeBack:function(){if(s&&s.onBackButton)return s.onBackButton(),!1},onResume:f,onDestory:function(){Bee.deleteMod("activity/act_"+r.id),s&&s.destroy&&s.destroy(),h&&h.destory(),s=r=null}}}});
/*![m/view_addredit.js]*/define("m/view_addredit",["common/AddrMgr","m/main","partner/Partner"],function(e,t,a){var d={title:{left:"back",right:"[保存]",rightTap:"save",contentHtml:"修改地址"},contentHtml:'<div class="main">\n<form class="edit-form block" onsubmit="return false;"></form>\n<div class="edit-save theme-btn-light tap-action" data-tap="save">保存</div>\n<div class="edit-del-wrap">\n<div class="edit-del theme-btn-light tap-action" data-tap="del">删除地址</div>\n</div>\n</div>'},n=$.isDaojia58?'<tr class="row-name theme-spline spline-list">\n<th>联系人</th>\n<td>\n<input class="addr-input" type="text" name="accept_name" value="#{accept_name}" maxlength="10" placeholder="收货人姓名"/>\n\n<span class="tap-action addr-gender addr-gender-2 theme-radio #{genderChecked2}" data-tap="setGender|2" data-value="2">女士</span>\n<span class="tap-action addr-gender addr-gender-1 theme-radio #{genderChecked1}" data-tap="setGender|1" data-value="1">先生</span>\n</td>\n</tr>':'<tr class="theme-spline spline-list">\n<th>联系人</th>\n<td>\n<input class="addr-input" type="text" name="accept_name" value="#{accept_name}" maxlength="10" placeholder="收货人姓名"/>\n</td>\n</tr>\n<tr class="theme-spline spline-list">\n<th>&nbsp;</th>\n<td>\n<span class="tap-action addr-gender addr-gender-1 theme-radio #{genderChecked1}" data-tap="setGender|1" data-value="1">先生</span>\n<span class="tap-action addr-gender addr-gender-2 theme-radio #{genderChecked2}" data-tap="setGender|2" data-value="2">女士</span>\n</td>\n</tr>',i={addr:'<table class="addr-edit" width="100%">'+n+'<tr class="row-phone theme-spline spline-list">\n<th>手机号码</th>\n<td>\n<input class="addr-input keyboard-fix" type="tel" name="telphone" value="#{telphone}" placeholder="鲜蜂侠联系您的电话" maxlength="11" />\n</td>\n</tr>\n<tr class="row-city theme-spline spline-list">\n<th>所在城市</th>\n<td class="more">\n<select class="addr-city-select keyboard-fix" name="city_id"><option value="">请选择城市</option</select>\n<span class="city-loading">&nbsp;</span>\n</td>\n</tr>\n<tr class="row-addr theme-spline spline-list">\n<th>所在地区</th>\n<td class="tap-action more" data-tap="selectPoi">\n<input class="addr-input addr-input-addrhead" type="text" name="address_0" value="#{getAddressHead}" placeholder="请选择您的住宅小区、大厦或学校" readonly/>\n</td>\n</tr>\n<tr class="row-addrdetail theme-spline spline-list">\n<th>详细地址</th>\n<td>\n<input class="addr-input keyboard-fix" type="text" name="address_1" value="#{getAddressTail}" placeholder="请输入楼号门牌号等详细信息" />\n</td>\n</tr></table>',cityOption:'<option value="#{area_id}" #{selected}>#{area_name}</option>'};return function(n){var r=!1,s=!1,l=function(){var a=n.find(".addr-city-select"),d=a.prop("disabled");a.prop("disabled",!1);var i,l=n.find(".edit-form").serializeForm();if(a.prop("disabled",d),l.gender=n.find(".addr-gender.checked").data("value"),l.accept_name?l.gender?l.telphone?l.telphone.match(/^1\d{10}$/)?!l.city_id||l.city_id<0?i="请选择城市":l.address_0?!r||r.isPoiVersion()||s?l.address_1||(i="请输入门牌号等详细信息"):i="请重新选择所在地区":i="请选择您收货地址的地区":i="请正确填写手机号":i="请填写手机号":i="请选择性别":i="请填写联系人姓名",i)return void n.tip(i);l.address=l.address_0.replace(/\s/g,"")+" "+l.address_1.replace(/\s/g,""),e.getAreaSel(function(e){$.each(e,function(e,t){t.area_id==l.city_id&&(l.city_name=t.area_name)})});var c={};r&&$.extend(c,r.toObject()),$.extend(c,l),s&&$.extend(c,s),n.showLoading("保存中"),t.getAddrMgr()[r?"updateAddr":"addNewAddr"](c,function(e,t){n.hideLoading(),e?n.finishView():n.tip(t)}),n.find("input").blur()},c=function(t){r=t.addr||!1;var d={random:parseInt(1e4*Math.random())};r?d["genderChecked"+r.gender]="checked":n.find(".edit-del").css("display","none"),$.isDaojia58&&n.find(".edit-save").removeClass("theme-btn-light").addClass("theme-btn-full"),n.find(".edit-form").html($.formatString(i.addr,r,d)),n.setTitle(r?"修改地址":"添加地址"),e.getAreaSel(function(e){a.getLogicConf("availableCities")&&(e=e.filter(function(e){return $.isInArray(a.getLogicConf("availableCities"),e.area_id)}));var t=!1;1==e.length?(t=!0,n.find(".addr-city-select").html($.formatString(i.cityOption,e[0],{selected:"selected"})).prop("disabled",!0)):n.find(".addr-city-select").html($.formatString(i.cityOption,{area_name:"请选择城市"})+e.map(function(e){var a=r.city_id==e.area_id;return r&&a&&(t=!0),$.formatString(i.cityOption,e,{selected:r&&a?"selected":""})}).join("")),t&&n.find(".addr-city-select").addClass("selected"),n.find(".city-loading").remove()}),n.listen(n.find(".keyboard-fix"),"blur",function(){setTimeout(function(){n.containerNode.css("display","none"),setTimeout(function(){n.containerNode.css("display","block")},1)},100)}),n.listen(n.find(".addr-city-select"),"change",function(){var e=this;$(e)[$(e).val()?"addClass":"removeClass"]("selected")})};return{html:d,init:c,onResume:function(e,t){"addrpoi"==e&&t&&(s=t,n.find(".addr-input-addrhead").val(t.name))},onDestory:function(){r=s=null},action_selectPoi:function(){var e=n.find(".addr-city-select"),t=e[0],a=(n.find(".addr-input-addrhead").val(),e.val());if(!a)return void n.tip("请先选择城市");var d=t.children[t.selectedIndex].innerHTML,i=r||{};n.changeView("addrpoi",{city:d,lng:s?s.lng:i.lng_map||i.lng,lat:s?s.lat:i.lat_map||i.lat})},action_save:l,action_del:function(){r&&r.id&&n.confirm("确定删除该地址吗？",function(){t.getAddrMgr().delAddr(r.id),n.finishView()})},action_setGender:function(e){n.find(".edit-form .addr-gender").removeClass("checked"),n.find(".edit-form .addr-gender-"+e).addClass("checked")}}}});
/*![m/view_addrlist.js]*/define("m/view_addrlist",["m/main","m/utils","partner/Partner"],function(d,e,t){var i={title:{left:"back",contentHtml:"我的地址"},contentHtml:'<div class="main scroller">\n<div>\n<div class="addr-gps block tap-action" data-tap="gps">定位到当前位置</div>'+e.renderEmptyNotice("您还没有地址哦~")+'<ul class="addr-list block"></ul>\n</div>\n</div>\n<div class="pub-footer addr-add theme-spline spline-top">\n<div class="tap-action theme-btn-big" data-tap="add">\n新增地址\n</div>\n</div>'},a={addr:'<li class="addr-item theme-spline spline-list">\n<div class="addr-desc tap-action #{isDefault}" data-tap="select|#{id}">\n<p class="ui-ellipsis">#{accept_name}&nbsp;&nbsp;&nbsp;#{telphone}</p>\n<p class="ui-ellipsis theme-grayfont">#{address}</p>\n</div>\n<div class="addr-edit tap-action" data-tap="edit|#{id}"></div>\n<div class="addr-del tap-action" data-tap="del|#{id}">删除</div>\n</li>'};return function(e){var n,s,r,l=function(){var d=r.getAddrList(),i=t.getLogicConf("availableCities"),n=[],s=r.getDefaultAddr();$.each(d,function(d,e){i&&!$.isInArray(i,e.city_id)||n.push($.formatString(a.addr,e,{isDefault:s&&e.id==s.id?"theme-border selected":""}))}),e.find(".main")[d.length?"removeClass":"addClass"]("addr-empty").find(".addr-list").html(n.join("")),e.getScroller().refresh()},c=function(t){n=!!t.isSelect,s=!!t.isReturn,r=d.getAddrMgr(),e.setTitle(n?"选择地址":"我的地址"),e.listen(r,"addrListChange",l),e.listen(e.getScroller(),"scroll",function(){e.find(".addr-item").removeClass("showdel")}),e.find(".addr-gps").css("display",t.showGps?"block":"none"),e.delegate(".addr-item","swipeLeft",function(){e.find(".addr-item").removeClass("showdel"),$(this).addClass("showdel")}),$.isDaojia58&&e.find(".pub-footer .theme-btn-big").removeClass("theme-btn-big").addClass("theme-btn-light"),l()},o=function(t){if(n)if(s){var i=r.getAddrById(t);e.finishView({addr:i})}else r.setDefaultAddr(t),d.getShop().setAddr(r.getAddrById(t)),e.finishView()},f=function(){n&&d.getGPS(function(t){t.success?(r.setDefaultAddr(),d.getShop().setAddr(t,!0),e.finishView()):e.alert("定位失败了<br/>请检查您的定位设置")})},p=function(d){var t=r.getAddrById(d);t&&e.changeView("addredit",{addr:t})},u=function(){e.changeView("addredit")},g=function(t){e.headerLoading(80),d.getAddrMgr().delAddr(t,function(){e.headerLoading(100)})},h=function(){n=r=null};return{init:c,html:i,getTrackId:function(){return"address_action"},action_select:o,action_gps:f,action_edit:p,action_add:u,action_del:g,onDestory:h}}});
/*![m/view_addrpoi.js]*/define("m/view_addrpoi",["m/main"],function(n){var e={title:{left:"back",contentHtml:{text:"地区选择",placeholder:"请输入地址"}},contentHtml:'<div class="main">\n<div class="baidu-map"></div>\n<div class="map-center"></div>\n<div class="pois-list scroller" data-scroller="pois">\n<ul class="pois-ul"></ul>\n</div>\n<div class="sug-list scroller" data-scroller="sug">\n<ul class="sug-ul"></ul>\n</div>\n</div>'},i={poisItem:'<li class="pois-item theme-spline spline-list tap-action" data-tap="selectPoi|#{name},#{addrEnc},#{lat},#{lng}">\n<p class="pois-item-name">#{name}</p>\n<span class="theme-grayfont">#{addr}</span>\n</li>',poisEmpty:'<li class="pois-item padding">您输入的地址无法识别</li>'},t={baiduJs:"http://api.map.baidu.com/api?v=2.0&ak=epx2GlGrgjgEizwW8iYsHwQZ&callback=",maxZoomLevel:19};return function(a){var o,l,s,d=function(){delete window[o];var e=a.find(".baidu-map")[0];l=new BMap.Map(e,{enableMapClick:!1,minZoom:1,maxZoom:t.maxZoomLevel}),l.disablePinchToZoom(),l.disableScrollWheelZoom(),l.disableDoubleClickZoom();var i,d=n.getGPS(),c=s.lng||d.longitude,m=s.lat||d.latitude;i=m&&c?new BMap.Point(c,m):s.city,l.centerAndZoom(i,t.maxZoomLevel),l.addControl(new BMap.NavigationControl),l.addEventListener("moveend",r),r()},r=$.throttle(500,function(){var n=l.getCenter();n.lng&&n.lat?base.getAddressInfoByPoint(n.lat,n.lng,function(n,e){a.find(".pois-ul").html(e.length?e.map(function(n){return $.formatString(i.poisItem,n,{addrEnc:encodeURIComponent(n.addr),lng:n.point.x,lat:n.point.y})}).join(""):i.poisEmpty),a.getScroller("pois").refresh()},1):setTimeout(r,800)},!0),c=function(n){return n?void base.getPlaceAddress(s.city,n,function(n){a.find(".sug-list").css("display","block").find(".sug-ul").html(n.length?n.map(function(n){return $.formatString(i.poisItem,n,{addrEnc:encodeURIComponent(n.address),addr:n.address,lng:n.location.lng,lat:n.location.lat})}).join(""):i.poisEmpty),a.getScroller("sug").refresh()}):void a.find(".sug-list").css("display","none")},m=function(n,e,i,t){a.finishView({name:n,addr:e,addr_for_dealer:e,lat:i,lng:t})},p=function(n){if(s=n,window.BMap)return void d();var e=parseInt(1e3*Math.random()),i=document.createElement("script");o="_bee_initMap_"+e,window[o]=d,i.src=t.baiduJs+o,document.body.appendChild(i)};return{html:e,init:p,onDestroy:function(){l=null},action_selectPoi:m,action_formQueryChange:c}}});
/*![m/view_bootstrap.js]*/define("m/view_bootstrap",function(){var t={title:{contentHtml:""},contentHtml:""};return function(n){var e=function(t){n.changeView(t.viewName,t.args)},i=function(){n.viewMgr.destroy()};return{html:t,init:e,getTrackId:function(){return"boot_action"},onResume:i}}});
/*![m/view_cart.js]*/define("m/view_cart",["partner/Partner","m/utils","m/main"],function(e,t,a){var i={title:{left:"back",contentHtml:"购物车"},contentHtml:'<div class="main main-top scroller">\n<div>\n<div class="receive block tap-action" data-tap="selectAddr" data-log="address">\n地址加载中。。。\n</div>\n<div class="cart-groups-wraper">\n</div>\n</div>\n</div>'},s={addrEmpty:'<span class="theme-redfont">鲜蜂侠需要您的精确坐标</span>',addr:$.isDaojia58?'<div class="addr">\n<div class="ui-ellipsis">#{getFullAddress}</div>\n<div>#{accept_name}&emsp;#{telphone}</div>\n</div>':'<table class="addr-table" width="100%">\n<tr>\n<th width="28%">收<span class="ui-hidden">a</span>货<span class="ui-hidden">a</span>人</td>\n<td>#{accept_name}&nbsp;#{getGenderName}</td>\n<td width="17%" rowspan="3" class="more">修改</td>\n</tr>\n<tr>\n<th>电<span class="ui-hidden">中中</span>话</td>\n<td>#{telphone}</td>\n</tr>\n<tr>\n<th>收货地址</td>\n<td>#{getFullAddress}</td>\n</tr>\n</table>',groupCart:$.isDaojia58?'<div class="cart-group">\n<div class="block">\n<p class="group-receive theme-spline spline-bottom more">#{receive}</p>\n<p class="theme-grayfont group-proptext theme-spline spline-bottom ui-ellipsis">#{propText}</p>\n<table class="group-list" width="100%" style="table-layout:fixed;">#{itemList}</table>\n</div>\n<div class="block">\n<div class="group-comment">\n<div class="comment-wrapper">\n<input class="group-comment-input group-comment-input-#{groupId}" type="text" maxlength="100" value="#{commentVal}" placeholder="请填写您的其他需求" />\n</div>\n</div>\n<div class="group-addOnBtn theme-spline spline-top tap-action theme-redfont more" data-group="#{groupId}" data-tap="add_on|#{groupId}" data-log=#{logParams}  style="display:none">去凑单</div>\n\n<div class="group-footer theme-spline spline-top">\n<div class="group-btn theme-btn #{btnClass} ui-float-right tap-action" data-tap="cartOk|#{groupId}" data-log="subOrder" disabled="#{disabled}">#{btnText}</div>\n共：<span class="theme-redfont">￥<span class="price-num">#{price}</span></span>\n</div>\n</div>\n</div>':'<div class="cart-group cart-group-#{groupId} block">\n<div class="theme-grayfont theme-bg-decorate group-name">#{name}</div>\n<span class="group-addOnBtn theme-border-red theme-redfont tap-action" data-tap="add_on|#{groupId}" data-group="#{groupId}" data-log=#{logParams} style="display:none">凑单专区</span>\n\n\n<p class="theme-grayfont group-proptext ui-ellipsis ">#{propText}</p>\n<p class="group-receive theme-spline spline-list more">收货时间&nbsp;&nbsp;#{receive}</p>\n<div class="group-comment theme-spline spline-top spline-bottom">\n收货备注&nbsp;&nbsp;\n<div class="comment-wrapper">\n<input class="group-comment-input group-comment-input-#{groupId}" type="text" maxlength="100" value="#{commentVal}" placeholder="可输入100字以内特殊要求内容" />\n</div>\n</div>\n<table class="group-list" width="100%" style="table-layout:fixed;">#{itemList}</table>\n<div class="group-footer theme-spline spline-top">\n<div class="group-btn #{btnClass} ui-float-right tap-action" data-tap="cartOk|#{groupId}" disabled="#{disabled}">#{btnText}</div>\n<span class="selectAll-#{isAllSelected} tap-action" data-tap="selectAll|#{groupId}">全选</span>\n共：<span class="theme-redfont">￥#{price}</span>\n</div>\n</div>',groupItem:$.isDaojia58?'<tr class="group-item group-item-disabled-#{disabled} theme-spline spline-list">\n<td class="group-item-name ui-ellipsis">#{name}</td>\n<td class="group-item-price" width="50px">￥#{price}</td>\n<td class="mod-product-ope group-item-ope" width="30%">\n#{ope}\n<div class="product-shopope-delall product-delall tap-action" data-tap="shopping|delall,#{id}"></div>\n</td>\n</tr>':'<tr class="group-item group-item-disabled-#{disabled} theme-spline spline-list tap-action" data-tap="viewDetail|#{id}">\n<td class="group-item-checkbox #{selectedClass} tap-action" style="width:5rem" data-tap="toggleProduct|#{id}"></td>\n<td style="width:5rem">\n<div class="group-item-img-wrap">\n<div class="group-item-img" style="background-image: url(#{img})"></div>\n<div class="maskText">#{maskText}</div>\n</div>\n</td>\n<td>\n<div class="group-item-name ui-ellipsis">#{name}</div>\n<div class="group-item-price" width="50px">￥#{price}</div>\n<div class="mod-product-ope group-item-ope" width="30%">\n#{ope}\n<div class="product-shopope-delall product-delall tap-action" data-tap="shopping|delall,#{id}"></div>\n</div>\n</td>\n</tr>',groupItemDisabled:'<tr class="group-item-disabled theme-spline spline-list"><td colspan="3">#{disabledText}</td></tr>',groupReceiveExt:$.isDaojia58?' <span class="group-receive-ext">请选择收货时间</span>':' <span class="ui-float-right group-receive-ext">&nbsp;#{ext}</span>',groupReceiveText:'<span class="theme-redfont group-receive-select-text group-receive-select-text-#{groupId}">#{receiveText}</span>'};return function(d){var n,r,o=function(e){"loading"==r.status?d.showLoading():(l(),p(),d.hideLoading())},p=$.throttle(100,function(){var e=r.getUserAddr();e&&!r.isDealer?d.find(".receive").removeClass("padding").html($.formatString(s.addr,e)):d.find(".receive").addClass("padding").html(s.addrEmpty)}),l=$.throttle(100,function(){if(d.isShowing()){if(!r.dealer||"error"==r.status||"unsupport"==r.status){var e=r.statusText||"当前地址错误";return $.isDaojia58&&"unsupport"!=r.status&&(e="亲，定位失败了，手动选个地址吧~"),d.find(".cart-groups-wraper").html(t.renderEmptyNotice(e,"换个地址试试","selectAddr")),d.find(".receive, .group-addOnBtn").css("display","none"),void d.getScroller().refresh()}d.find(".receive").css("display","block");var a=n.getCartInfo(),i=[],o=function(e,a){i.push($.formatString(s.groupCart,e,{disabled:!e.isOk,btnClass:e.isOk?"theme-bg":"",groupId:a,logParams:0==a?"flash_sentMore":"tomorrow_sentMore",commentVal:d.find(".group-comment-input-"+a).val(),itemList:function(){var a=['<tr style="height:0;" class="layout-fix"><td style="width:5rem"></td><td style="width:5rem"></td><td></td></tr>'];return $.each(e.shoppingList,function(e,i){i.showDisableText&&i.disabled&&($.isDaojia58||a.push($.formatString(s.groupItemDisabled,i))),a.push($.formatString(s.groupItem,{ope:t.renderProducts(i,{hideDel:!1,showZero:!0,onlyOpe:!0}),img:i.app_mimg||i.img,selectedClass:i.isSelected&&1!=i.disabled?"selected":""},i)),i.showDisableText&&i.disabled&&$.isDaojia58&&a.push($.formatString(s.groupItemDisabled,i))}),a.join("\n")},receive:function(){var e,t=[],i=r.dealer.business[a],n=d.find(".group-receive-select-"+a),o=n.val();return t.push($.formatString(s.groupReceiveExt,i)),t.push('<select class="group-receive-select group-receive-select-',a,'" data-groupId="',a,'">'),$.each(i.str,function(a,i){t.push($.formatString('<optgroup label="#{day}">',i)),$.each(i.time,function(a,s){var d=(0==i.dateid?"":i.day+" ")+s,n=o==d;e&&!n||(e=(0==i.dateid?"":i.day+"")+s),t.push($.formatString('<option value="#{val}" data-dateid="#{dateid}" data-time=#{timeStr} data-dateidStr="#{day}" #{selected}>#{timeStr}</option>',i,{selected:n?"selected":"",timeStr:s,val:d}))}),t.push("</optgroup>")}),t.push("</select>"),t.push($.formatString(s.groupReceiveText,{receiveText:e,groupId:a})),t.join("")}}))},p=!1;a.shoppingList.length&&(o(a,0),p=!0),$.each(a.groups,function(e,t){var i=a[t];i&&i.shoppingList&&i.shoppingList.length&&(p=!0,o(i,t.replace("group","")))}),p?d.removeClass("empty"):(i.push(t.renderEmptyNotice("亲，购物车空空的耶~","去逛逛")),d.addClass("empty")),$.isBaidumap&&i.push('<p class="theme-redfont baidumap '+(p?"":"baidumap-empty")+'">由百度地图与爱鲜蜂联合提供服务</p>'),i.push('<div class="navs-holder"></div>'),d.find(".cart-groups-wraper").html(i.join("\n"));var l=d.find(".group-addOnBtn");r.getUserAddr()&&l.each(function(e,t){$(t).data("group")<1e4&&$(t).css("display","block")}),d.getScroller().refresh()}}),c=function(t){var a=r.getUserAddr(),i=d.find(".group-receive-select-"+t),s=i[0],o=$(i.find("option")[s.selectedIndex]),p=o.data("dateid"),l=o.data("time"),c=o.data("dateidstr");if(!a||r.isDealer)return void d.alert("请选择您的收货地址");var u={idformat:n.getIdformat(!0,t),pid_dealers:n.getPidDealers(!0,t),priceformat:n.getPriceformat(!0,t),addrId:a.id,dateid:p,datestr:l,cart_group_id:t,enabled_pay:e.getSupportPays().map(function(e,t){return e.typeid}).join(",")};r.designated_dealerid&&(u.designated_dealerid=r.designated_dealerid),d.showLoading("验证中"),base.ajaxPost("/submit/checkOrder",u,function(e){d.hideLoading(),0==e.errno?d.changeView("confirm",{order:e.data,params:$.extend({dateidName:c,datestrName:l,comment:d.find(".group-comment-input-"+t).val()},u)}):6005==e.errno&&e.data.limit_goods&&e.data.limit_goods.length?n.setLimitGoods(e.data.limit_goods,!0):d.alert(e.errmsg)})},u=function(e){if(r){var t=r.getUserAddr();if(t){var i=a.getShoppingCart().getShoppingList(!1,e).map(function(e){return e.product_id}).join(","),s={cd_cityid:r.dealer.cityid,location:t.lng+","+t.lat,zchtid:r.dealer.zchtid,cart_group_id:e,pids:i};d.changeView("addon",s)}}},g=function(e){n=a.getShoppingCart(),r=a.getShop(),d.listen(r,"progressing",o),d.listen(n,"shoppingListChange",l),o(),l(),d.delegate(".group-receive-select","change",function(e){var t=$(e.target),a=t.val(),i=t.data("groupid"),s=d.find(".group-receive-select-text-"+i);s.text(a)})};return{html:i,init:g,getTrackId:function(){return"cart_action"},onResume:function(){l()},onDestory:function(){n=r=null},action_cartOk:c,action_empty:function(){1==d.viewMgr.getLength()?d.switchNav():d.viewMgr.clearToRoot()},action_toggleProduct:function(e){var t=$(this);if(!t.parent(".group-item").hasClass("group-item-disabled-1")){var a=!t.hasClass("selected");n.setSelected(e,a)}},action_selectAll:function(e){var t=$(this);e=e||0,allSelected=!t.hasClass("selectAll-true"),n.setSelected("group"+e,allSelected)},action_viewDetail:function(e){var t=n.getProductById(e);t.disabled||d.changeView("detail",{id:e})},action_add_on:u}}});
/*![m/view_shop.js]*/define("m/view_shop",["m/main","m/utils"],function(e,d){var i={title:{left:"back",contentHtml:"店铺收藏",right:"[编辑]",rightTap:"edit"},contentHtml:'<div class="main scroller">\n<div>'+d.renderEmptyNotice("您还没有收藏店铺哦~")+'<ul class="addr-list block"></ul>\n</div>\n</div>\n<div class="pub-footer addr-add theme-spline spline-top">\n<div class="tap-action theme-btn-big" data-tap="add">\n+&nbsp;新增店铺\n</div>\n</div>'},t={addr:'<li class="addr-item theme-spline spline-list">\n<div class="addr-desc tap-action" data-tap="select|#{id}">\n<p class="ui-ellipsis addr-name">#{name}&nbsp;</p>\n<p class="ui-ellipsis addr-time theme-grayfont">营业时间:#{workbegin}--#{workend}</p>\n<p class="ui-ellipsis addr-addr theme-grayfont">#{address}</p>\n</div>\n<div class="addr-del tap-action" data-tap="del|#{id}">删除</div>\n</li>'};return function(d){var n,a={},s=!1,l=function(e){var i=[];$.each(e,function(e,d){a[d.id]=d.dealer_info,i.push($.formatString(t.addr,d,{name:d.dealer_info.name,workbegin:d.dealer_info.WorkBegin,workend:d.dealer_info.WorkEnd,address:d.dealer_info.address}))}),d.find(".main")[i.length?"removeClass":"addClass"]("addr-empty").find(".addr-list").html(i.join("")),d.getScroller().refresh()},o=function(){n.getFavShops(function(e){l(e.fav_list)})},r=function(i){gIsSelect=!!i.isSelect,gIsReturn=!!i.isReturn,n=e.getAddrMgr(),d.listen(d.getScroller(),"scroll",function(){d.find(".addr-item").removeClass("showdel")}),d.find(".addr-gps").css("display",i.showGps?"block":"none"),d.delegate(".addr-item","swipeLeft",function(){d.find(".addr-item").removeClass("showdel"),$(this).addClass("showdel")}),o()},c=function(e){s=!s,$(".mod-shop .addr-item")[s?"addClass":"removeClass"]("showdel"),d.setTitleRightBtn({right:s?"[完成]":"[编辑]",rightTap:"edit"})},p=function(e){base.ajaxPost("/submit/delShop",{fav_id:e},function(e){0==e.errno?(l(e.data.fav_list),a=e.data.fav_list):d.alert("移除失败，请稍后重试")})},f=function(){d.changeView("shopadd")},m=function(i){e.getShop().setAddr(a[i]),e.getShop().designated_dealerid=a[i].zchtid,d.switchNav(),d.viewMgr.clearToRoot()},h=function(){gIsSelect=n=null},u=function(){o()};return{init:r,html:i,action_edit:c,action_select:m,action_add:f,action_del:p,onDestory:h,onResume:u}}});
/*![m/view_shopadd.js]*/define("m/view_shopadd",["m/main","partner/Partner","m/utils"],function(a,e,t){var d={title:{left:"back",right:"scanact[扫一扫]",contentHtml:"新增店铺"},contentHtml:'<div class="main scroller">\n<div><div class="addr-loc"></div>\n<p class="addr-title theme-grayfont">附近的店铺</p>\n<ul class="addr-list block"></ul>\n</div>\n</div>'},i={loc:'<div class="theme-spline ui-ellipsis spline-list more tap-action" data-tap="selectAddress">#{address}</div>',addr:'<li class="addr-item theme-spline spline-list">\n<div class="addr-desc">\n<p class="ui-ellipsis addr-name">#{name}&nbsp;</p>\n<p class="ui-ellipsis addr-time theme-grayfont">营业时间:#{WorkBegin}--#{WorkEnd}</p>\n<p class="ui-ellipsis addr-addr theme-grayfont">#{address}</p>\n</div>\n<div class="addr_option">\n<div class="addr_dist">#{distance}</div>\n<div class="addr_fav_btn #{disable}" data-tap="addShop|#{id}">#{text}</div>\n</div>\n</li>'},n=a.getShop(),s=(n.dealer.longitude||n.dealer.lng)+","+(n.dealer.latitude||n.dealer.lat);return function(a){var t,l=function(e){base.ajaxPost("/submit/favNearby",{location:e},function(e){if(0==e.errno&&e.data&&e.data.dealers){var t=[];$.each(e.data.dealers,function(a,e){e.distance=parseFloat(e.distance).toFixed(2)+"km",e.disable=0==e.is_fav?"tap-action theme-bg":"disabled",e.text=0==e.is_fav?"+收藏":"已收藏",t.push($.formatString(i.addr,e))}),a.find(".main")[t.length?"removeClass":"addClass"]("addr-empty").find(".addr-list").html(t.join("")),a.getScroller().refresh()}})},r=function(e){a.find(".header-icon-scanact").on($.tapClick,m),l(s),base.getAddressInfoByPoint(n.dealer.latitude||n.dealer.lat,n.dealer.longitude||n.dealer.lng,function(e){var t=(e.street||"定位地址")+"附近",d=$.formatString(i.loc,{address:t});a.find(".addr-loc").html(d)})},o=function(e){base.ajaxPost("/submit/addShop",{zchtid:e},function(e){0==e.errno&&e.data.new_fav?(a.alert("收藏成功"),l(s)):a.alert("收藏失败，请稍后重试")})},c=function(){gIsSelect=t=null},f=function(){a.changeView("addrpoi",{lng:n.dealer.longitude||n.dealer.lng,lat:n.dealer.latitude||n.dealer.lat})},p=function(e){if(0==e.indexOf("activity://")){var t=base.jsonDecode(e.replace("activity://",""));if(!t)return;t&&t.ext_params&&(t.ext_params.bigids=n.bigids,t.ext_params.cityid=n.cityid),a.changeView("act",{activityObj:t})}e.indexOf("weixin.qq.com/q/")>-1&&base.ajaxPost("/submit/addShop",{qrcode:e},function(e){0==e.errno&&e.data.new_fav?(a.alert("收藏成功，您可以在此店下单了"),n.setAddr(e.data.new_fav.dealer_info),n.designated_dealerid=e.data.new_fav.dealer_id,a.switchNav(),a.viewMgr.clearToRoot()):a.alert(e.data.errmsg)})},u=function(e,t){"addrpoi"==e&&t.lat&&t.lng&&(l(t.lng+","+t.lat),a.find(".addr-loc").html($.formatString(i.loc,{address:t.name})))},m=function(){e.isSupport("scanQR")?e.scanQR(function(a){a.success&&p(a.result)}):a.alert("当前环境不支持扫描二维码")};return{init:r,html:d,action_addShop:o,action_selectAddress:f,onDestory:c,onResume:u}}});
/*![m/view_confirm.js]*/define("m/view_confirm",["lib/base","partner/Partner","m/main","m/utils","common/Dialog"],function(e,t,o,a,n){var i={title:{left:"back",contentHtml:"结算付款"},contentHtml:'<div class="main scroller"></div>\n<div class="pub-footer confirm-footer theme-spline spline-top">\n<div class="padding-left">应付金额：<span class="theme-redfont">￥</span><span class="total theme-redfont"></span></div>\n<div class="confirm-btn theme-bg tap-action" data-tap="submit">确定下单</div>\n</div>'},r=['<ul class="pay-list block padding-left">\n<h3 class="theme-spline spline-list theme-grayfont">选择支付方式</h3>\n#{payList}\n</ul>','<div class="block padding-left selcoupon-wrap">\n<div class="more tap-action spline-bottom theme-border-gray" data-tap="selectCoupon" data-log="coupons">\n优惠券\n<span class="ticketName ui-float-right ui-colorred">#{couponValStr}</span>\n</div>\n<div class="more tap-action theme-nuomi-hidden" data-tap="selectPointsTicket">\n积分券\n<span class="ticketName ui-float-right ui-colorred">#{ticketValStr}</span>\n</div>\n</div>','<div class="block padding-left">\n<h3 class="theme-grayfont">商品明细</h3>\n<div>\n#{productList}\n</div>\n</div>'];$.isNuomi&&r.reverse();var d={frame:r.concat('<div class="block padding-left">\n<h3 class="theme-spline spline-bottom theme-grayfont">费用明细</h3>\n<div class="confirm-amount">#{feeList}</div>\n</div>').join(""),amountItem:'<p>#{text}<span class="ui-float-right">￥#{valueFloat}</span></p>',pay:'<li class="pay-item #{payClass} #{defaultPay} pay-item-#{key} theme-spline spline-list" data-tap="selectPay|#{key}">\n<span class="pay-icon pay-icon-#{key}" #{icon}></span>\n#{payTitle}&nbsp;<span class="limit-words">#{limitWords}</span>\n#{msg}\n</li>'};return function(r){var s,p,l,c=!1,u=!1,m=null,f=null,y=function(e){var o=parseInt(e.propid),n=parseInt(e.point_propid),i=e.coupon_list||[],p=0,l=e.point_coupon_list;ticketPropUsableCount=0,$.each(i,function(e,t){p+=1==t.disabled?0:1,o&&t.id==o&&(m=t,s.propcode=m.card_pwd)}),$.each(l,function(e,t){ticketPropUsableCount+=1==t.disabled?0:1,n&&t.id==n&&(f=t,s.point_propcode=f.card_pwd)}),o||(m=null,s.propcode=""),n||(f=null,s.point_propcode=""),$.isDaojia58&&(m=f=null,s.propcode="",s.point_propcode=""),r.find(".main").html($.formatString(d.frame,e,{couponValStr:m?"已优惠￥"+parseFloat(m.value):p?p+"张可用优惠券":'<span class="theme-grayfont">暂无可用优惠券</span>',ticketValStr:f?"已优惠￥"+parseFloat(f.value):ticketPropUsableCount?ticketPropUsableCount+"张可用积分券":'<span class="theme-grayfont">暂无可用积分券</span>',payList:function(){var o={};$.each(e.pay,function(e,t){o[t.type]=t});var a=[];return $.each(u=t.getSupportPays(),function(e,t){var n,i=t.typeid,r=o[i]||{};c||1==r.disabled?c&&c.typeid==r.type&&1==r.disabled&&(c=!1):c=t,n=t.key==c.key,n&&(s.pay_platform=t.typeid,s.pay_type=t.typeid?1:0),a.push($.formatString(d.pay,{icon:"weibo"!=t.key&&r.icon?'style="background-image:url('+r.icon+');"':"",key:t.key,payTitle:"weibo"==t.key?t.name:r.title||t.name,idx:e,defaultPay:n?"icon-ok":"",payClass:1==r.disabled?"pay-limit":"tap-action",limitWords:r.disabled_msg||"",msg:o.msg||""}))}),a.join("")},feeList:function(){var t=[];return $.each(e.fee_list,function(e,o){t.push($.formatString(d.amountItem,{text:o.text,valueFloat:parseFloat(o.value)}))}),t.join("\n")},productList:a.renderOrderProduct(e.goods)})),r.find(".confirm-footer .total").html(parseFloat(parseFloat(e.order_amount).toFixed(2))),r.getScroller().refresh()},g=function(a,n,i,d){r.showLoading(n||"校验中");var c=$.extend({},s,a),u=o.getShop();"pay_type"in a&&(delete c.propcode,delete c.point_propcode),c.enabled_pay=t.getSupportPays().map(function(e,t){return e.typeid}).join(","),u.designated_dealerid&&(c.designated_dealerid=c.designated_dealerid),e.ajaxPost("/submit/checkOrder",c,function(e){r.hideLoading(),0==e.errno?(s=c,p=e.data,l=p.order_hash||l,i&&i(),y(e.data)):(r.tip(e.errmsg),d&&d(e.errno))})},h=function(e){var o=t.getPay(e);c&&o==c||g({pay_type:o.typeid?1:0,pay_platform:o.typeid},"正在验证商品信息",function(){c=t.getPay(e)})},v=function(){r.changeView("couponPicker",{couponList:p.coupon_list||[],propid:!!m&&m.id,type:"coupon"})},_=function(){r.changeView("couponPicker",{couponList:p.point_coupon_list||[],propid:!!f&&f.id,type:"pointsTicket"})},b=function(){if(!c)return void r.alert("请选择支付方式");var t=c,a=o.getShop(),i=o.getGPS(),d=o.getAddrMgr().getAddrById(s.addrId),p={postscript:s.comment||"",propcode:m?m.card_pwd:"",point_propcode:f?f.card_pwd:"",paytype:t.typeid?1:0,pay_platform:t.typeid,pidtrack:e.jsonEncode(o.getShoppingCart().getTrackInfo()),order_hash:encodeURIComponent(l),location_hash:a.location_hash,display_dealer:a.shopId,display_addr:d.address,display_gps:d.lng+","+d.lat,display_time:a.dealer.timestamp||parseInt(Date.now()/1e3),location_conan:i&&i.success?i.longitude+","+i.latitude:"",location_time:i&&i.timestamp?i.timestamp/1e3:""};a.designated_dealerid&&(p.designated_dealerid=a.designated_dealerid),$.extend(p,s),r.showLoading("提交订单中"),e.ajaxPost("/submit/makeOrder",p,function(a){if(r.hideLoading(),0==a.errno&&a.data.verify){var i=null,d=function(){if(!$(".dialog-content .dialog-input-btn").hasClass("disable")){var t=60;return e.ajaxPost("/submit/voiceCode",{},function(e){0==e.errno?($(".dialog-content .dialog-input-btn").addClass("disable").text("60s"),i=setInterval(function(){t--,$(".dialog-content .dialog-input-btn").text(t+"s"),0==t&&($(".dialog-content .dialog-input-btn").removeClass("disable").text("立即获取"),clearInterval(i))},1e3)):r.alert(e.errmsg)}),!1}},p=function(t){return clearInterval(i),e.ajaxPost("/submit/voiceVerify",{code:$(".dialog-content .dialog-verify-code").val()},function(e){0==e.errno?b():r.alert(e.errmsg)}),!1};return void n.verify("语音验证","为保证鲜蜂侠顺利的为您服务，我们会验证您的手机号码。请留意010-52255400的免费来电。",d,p)}if(0==a.errno){var l=a.data,c={orderId:l.orderid,orderNo:l.orderno,from:"confirm"};if(o.getShoppingCart().reset(s.cart_group_id),0!=t.typeid&&(c.payKey=t.key),$.isDaojia58){if(!l.dj_info)return void r.alert("同步到家订单失败");c.djOrderId=l.dj_info.dj_order_id}r.changeView("order",c)}else r.alert(a.errmsg)})},k=function(e,t){if("couponPicker"==e&&t){"coupon"==t.type&&(m=null),"pointsTicket"==t.type&&(f=null);var o={},a="coupon"==t.type?"propcode":"point_propcode";o[a]=t.coupon?t.coupon.card_pwd:"without",g(o,null,null,function(e){t.couponCountChanged&&6010==e&&(o[a]="",g(o))})}else"order"!=e&&"orderlist"!=e||("home"==r.viewMgr.name?r.viewMgr.clearToRoot():(r.viewMgr.clear(),r.switchNav()))},P=function(e){s=e.params,p=e.order,l=p.order_hash,y(p)};return{html:i,init:P,getTrackId:function(){return"submitorder_action"},onResume:k,onDestory:function(){c=u=s=p=m=null},action_selectPay:h,action_selectCoupon:v,action_selectPointsTicket:_,action_submit:b}}});
/*![m/view_coupon.js]*/define("m/view_coupon",["m/utils"],function(n){var t=[{key:"0",name:"未使用"},{key:"1",name:"已使用"},{key:"2",name:"已过期"}],e={title:{left:"back",contentHtml:"我的优惠券",right:"[使用规则]",rightTap:"rules",rightTapLog:"rules"},contentHtml:'<div class="main">\n<ul class="tabs theme-border-gray"></ul>\n<div class="coupon-bind">\n<form class="coupon-bind-form" onsubmit="return false;">\n<div class="inputwrap theme-spline">\n<input type="text" maxlength="10" class="inputwrap-input" placeholder="请输入优惠券号码" />\n<input type="submit" class="inputwrap-button theme-bg" value="绑定"/>\n</div>\n</form>\n</div>\n<div class="coupon-scroller scroller theme-spline spline-top">\n<ul class="coupon-list"></ul>\n</div>\n</div>'};return function(i){var o,a,r,s=function(){r=n.renderTabs({data:t,action:"switchTab",active:o,appendTo:i.find(".tabs")}),c(o)},c=function(e){o=e;var r=a["is_"+e]||[];r.length<1?i.find(".main").addClass("empty"):i.find(".main").removeClass("empty");var s=r.length>0?n.renderCouponList({data:r,selectedId:!1,showCouponType:!0}):e==t[0].key?n.renderEmptyNotice("您还没有券哦","兑换积分券","cashPointsTicket"):n.renderEmptyNotice("您还没有券哦");i.find(".coupon-list").html(s),i.getScroller().refresh()},u=function(n){o=n.type||t[0].key,i.showLoading(),base.ajaxPost("/submit/couponMy",{},function(n){i.hideLoading(),0==n.errno?(a=n.data,s()):i.tip(n.errmsg)}),i.delegate(".coupon-bind-form","submit",function(){var n=i.find(".inputwrap-input").val();if(n)return base.ajaxPost("/submit/couponBind",{propcode:n},function(n){0==n.errno?(i.find(".inputwrap-input").val(""),i.tip("绑券成功！"),i.replaceView("coupon",{type:o})):i.tip(n.errmsg)}),!1})};return{html:e,init:u,getTrackId:function(){return"coupon_action"},onDestory:function(){a=null},action_rules:function(){i.changeView("iframe",{title:"使用规则",url:"/show/couponrules"})},action_switchTab:function(){c($(this).data("key"))},action_cashPointsTicket:function(){i.changeView("pointsShop")}}}});
/*![m/view_couponPicker.js]*/define("m/view_couponPicker",["m/utils"],function(n){var t={title:{left:"back",contentHtml:"",right:"[使用规则]",rightTap:"rules",rightTapLog:"rules"},contentHtml:'<div class="main">\n<div class="header">\n<div class="coupon-bind spline-bottom theme-border-gray">\n<form class="coupon-bind-form" onsubmit="return false;">\n<div class="inputwrap theme-spline">\n<input type="text" maxlength="10" class="inputwrap-input" placeholder="请输入优惠券号码" />\n<input type="submit" class="inputwrap-button theme-bg" value="绑定"/>\n</div>\n</form>\n</div>\n<div class="coupon-nouse-wrap">\n<div class="coupon-nouse tap-action coupon-style" data-tap="select">不使用<span class="couponTypeStr"></span></div>\n</div>\n</div>\n<div class="coupon-scroller scroller theme-spline spline-top">\n<div>\n<div class="coupon-list-wrap"></div>\n</div>\n</div>\n<div class="footer tap-action theme-spline spline-top" data-tap="cashPoints" data-log="goExchangeSelect">\n<div class="theme-btn-big">兑换积分券</div>\n</div>\n</div>'};return function(e){var o,i,s,a=!1,c=!1,r=function(){e.find(".main").addClass("main-"+i+(o.length>0?"":" empty"));var t;t=o.length<1?"coupon"==i?n.renderEmptyNotice("还没有优惠券哦"):n.renderEmptyNotice("还没有积分券哦","兑换积分券","cashPoints"):n.renderCouponList({data:o,selectedId:c,showCouponType:!1}),e.find(".coupon-list-wrap").html(t),e.getScroller().refresh()},p=function(){"pointsTicket"==i&&e.changeView("pointsTicketCash")},u=function(n,t){if("coupon"!=i&&"pointsTicketCash"==n&&t&&t.ticket){var e=t.ticket;a=!0,o.push(e),r()}},l=function(n){o=n.couponList,c=n.propid,i=n.type,s="coupon"==i?"优惠券":"积分券",e.setTitle(s),e.find(".couponTypeStr").text(s),r(),"coupon"==i&&e.delegate(".coupon-bind-form","submit",function(){var n=e.find(".inputwrap-input").val();if(n)return e.showLoading(),base.ajaxPost("/submit/couponBind",{propcode:n},function(n){e.hideLoading(),0==n.errno?(setTimeout(function(){e.tip("绑券成功！")},500),e.find(".inputwrap-input").val(""),$.each(n.data,function(n,t){$.isArray(o)&&o.splice(0,0,t)}),r(),a=!0,e.getScroller().refresh(),e.getScroller().scrollTo(0,0)):e.tip(n.errmsg)}),!1})};return{html:t,init:l,onResume:u,getTrackId:function(){return"coupon_action"},onDestory:function(){o=null},action_rules:function(){e.changeView("iframe",{title:"使用规则",url:"/show/couponrules"+("coupon"==i?"":"#score"),webview:!1})},action_select:function(n){if(!$(this).hasClass("coupon-item-enable-false")){var t={coupon:!1,type:i,couponCountChanged:a};$.each(o,function(e,o){if(o.id==n)return t.coupon=o,c=n,!1}),e.finishView(t)}},action_disabledReason:function(n,t){var o=$(this).parents(".coupon-item").next(".coupon-reason");parseInt(o.data("shown"))?o.css("height",0).data("shown",0):o.css("height",1.5*parseInt(t)+.2+"rem").data("shown",1),setTimeout(function(){e.getScroller().refresh()},600)},action_hideReason:function(){$(this).css("height",0).data("shown",0)},action_cashPoints:p,onBeforeBack:function(){if(a&&!c)return e.finishView({coupon:!1,type:i,couponCountChanged:!0}),!1}}}});
/*![m/view_detail.js]*/define("m/view_detail",["lib/base","partner/Partner","m/utils","m/main","m/GoodsFavorite"],function(e,i,t,a,o){var n={title:{left:"back",contentHtml:"",right:i.isSupport("share")?"[分享]":void 0,rightTap:i.isSupport("share")?"share":void 0,rightTapLog:i.isSupport("share")?"share":""},contentHtml:'<div class="main scroller mod-productDetail">\n</div>\n<div class="footer-cart-circle theme-spline"></div>\n<div class="pub-footer footer mod-product-ope padding-left theme-spline spline-top">\n<div class="favor tap-action" data-tap="favor">收藏</div>\n<div class="operates"></div>\n</div>'};return function(r){var s,d=function(){r.find(".footer .favor")[a.getUser().isLogin()&&o.has(s)?"addClass":"removeClass"]("selected")},c=function(n){s=n.id,r.listen(a.getUser(),"statusChange",function(e){this.isLogin()?o.init():o.reset()}),r.listen(o,"change",d),d(),r.headerLoading(80),$.isDaojia58?r.setTitle("生活超市"):n.name&&r.setTitle(n.name);var c=a.getShop();e.ajaxLoad(r.find(".main"),"/show/productDetail",{from:"vv",id:n.id,shopId:c.shopId,bigids:c.bigids,simulate_mobile:$.isSimulateMobile?"true":""},function(){r.headerLoading(100);var o=r.find(".product-detail-"+n.id).html(),s=e.jsonDecode(o),d=s.imgs&&s.imgs[0]||s.app_mimg;s&&($.isDaojia58?r.setTitle("生活超市"):n.name||r.setTitle(s.name),r.showCartBtn(),r.bindShoppingOpe(),r.find(".footer .operates").html("添加商品："+t.renderProducts(s,{showZero:!0,hideDel:!1,onlyOpe:!0})),r.find(".mod-banner-wrap").css("background-image","url("+d+")").data("src",d),a.getShoppingCart().addProductData(s),i.setShare({title:"爱鲜蜂-各种新鲜闪电送达",description:"#爱鲜蜂# "+s.name,imgUrl:s.app_mimg,link:"http://m.beequick.cn/show/productDetail?id="+s.id+"&shopId="+c.shopId}),r.find("img").on("load",function(){r.getScroller().refresh()}).each(function(e,i){var t=$(i),a=t.data("src");a&&(i.src=a)}))})};return{init:c,html:n,getTrackId:function(){return"goods_action"},getProductImgNode:function(){return r.find(".mod-banner-wrap")},action_favor:function(e){if(!a.getUser().isLogin())return void r.changeView("verify");var i=!$(this).hasClass("selected");if(i)o.add({id:s,zchtid:a.getShop().shopId,callback:function(e){d()}});else{var t=o.get(s);if(!t)return void r.alert("获取当前商品信息失败");o.remove({ids:t.col_id,type:0,callback:function(e){d()}})}}}}});
/*![m/view_mine.js]*/define("m/view_mine",["partner/Partner","m/main"],function(e,a){var t=[{key:"pointsShop",name:"积分商城",logActionType:"clickPointsMall"},{key:"coupon",name:"优惠券",logActionType:"coupons"},{key:"addrlist",name:"收货地址",logActionType:"address"},{key:"aftersale",name:"客服/反馈",logActionType:"custServiceFeedback"},{key:"about",name:"关于我们"}],n=4,i=[{key:"11",name:"待付款",logActionType:"unPaidOrder"},{key:"12",name:"待收货",logActionType:"unRecOrder"},{key:"15",name:"待评价",logActionType:"unElvOrder"},{key:"17",name:"退款/售后",logActionType:"afterSaleOrder"}];e.isSupport("share")&&t.push({key:"share",name:"分享给朋友"});var o={contentHtml:$.formatString('<div class="main">\n<div class="userinfo theme-bg tap-action" data-tap="member" data-log="clickUserCenter">\n<div class="user">\n<p class="user-phone"></p>\n<p class="user-level theme-redfont"></p>\n</div>\n</div>\n<div class="favorite theme-bg">\n<div class="item goodsFavorite tap-action" data-tap="item|goodsFavorite"><span class="item-inner">商品收藏<span></div>\n<div class="split"></div>\n<div class="item shopFavorite tap-action" data-tap="item|shop" data-log="myCollectStore"><span class="item-inner">店铺收藏</span></div>\n</div>\n<div class="mine-content scroller">\n<div>\n<div class="block mine-order">\n<div class="tap-action theme-spline spline-bottom more padding" data-tap="order|0" data-log="order">\n<span class="theme-grayfont ui-float-right">查看全部订单</span>\n我的订单\n</div>\n<ul class="order-types cf">\n#{orderTypes}\n</ul>\n</div>\n<div class="block">\n<table width="100% mine-items">\n#{items}\n</table>\n</div>\n\n<div class="logout theme-btn-light tap-action" data-tap="logout">退出当前帐号</div>\n<div class="navs-holder"></div>\n</div>\n</div>\n</div>',{orderTypes:i.map(function(e){return $.formatString('<li class="order-type order-type-#{key} tap-action" data-tap="order|#{key}" data-log="#{logActionType}">#{name}</li>',e)}),items:function(){var e=[];return $.each(t,function(a,t){a%n==0&&e.push("<tr>"),e.push($.formatString('<td class="mine-item mine-item-#{key} tap-action" width="#{width}%" data-tap="#{dataTap}" data-log="#{logActionType}">#{name}</td>',t,{width:100/n,dataTap:"share"==t.key?"share":"item|"+t.key})),a%n==n-1&&e.push("</tr>")}),e.join("")}})};return function(e){var t,n=function(){e.headerLoading(80),base.ajaxPost("/data/memberCenter",{},function(a){e.headerLoading(100);$.formatString;0==a.errno&&a.data&&200==a.data.code?(t=a.data.data,e.find(".user-phone").text(t.username),e.find(".user-level").text(t.name)):0==a.errno&&a.data&&200!=a.data.code?e.alert(a.data.msg):e.alert(a.errmsg)})},i=function(e){n()},r=function(a){"share"==a||e.changeView(a)},s=function(a){var a=a||0;e.changeView("orderlist",{type:a})};return{html:o,init:i,getTrackId:function(){return"my_action"},action_item:r,action_order:s,action_member:function(){$.isAndroid&&$.isBestpay||(t?e.changeView("member",{member:t}):e.alert("获取会员信息失败"))},onResume:function(e,a){"pointsShop"==e&&a&&a.pointsChanged&&n()},action_logout:function(){e.showLoading("退出中"),a.getUser().logout(function(){e.hideLoading()})}}}});
/*![m/view_orderlist.js]*/define("m/view_orderlist",["partner/Partner","m/main","m/utils","m/OrderOperate"],function(e,r,t,n){var a=[{key:"0",name:"全部订单"},{key:"11",name:"待付款"},{key:"12",name:"待收货"},{key:"15",name:"待评价"},{key:"17",name:"退款/售后"}],o={title:{left:"back",right:"reload",contentHtml:"我的订单",className:"theme-spline"},contentHtml:'<div class="main">\n<ul class="tabs cf theme-spline"></ul>\n<div class="orders-wrap scroller">\n<ul class="orders">\n</ul>\n<div class="placeholder" style="display:none"></div>\n</div>\n</div>'},d={tab:'<li class="tab tab-type#{key} tap-action" data-tap="tabTap|#{key}"">#{name}</li>',order_btn:'<span class="order-action order-action-#{type} theme-bg"\ndata-type="#{type}"\ndata-orderid="#{orderid}"\ndata-orderno="#{orderno}">\n#{text}\n</span>',order:'<li class="order tap-action" data-tap="order_detail|#{id},#{order_no}">\n<div class="order-header">\n<span class="order-status">#{textStatus}</span>\n<span class="order-time">#{create_time}</span>\n</div>\n#{products}\n<div class="order-count">共#{buy_num}件商品&emsp;¥#{order_amount}</div>\n<div class="order-footer #{hideFooterClass}">\n#{btns}\n</div>\n</li>'};return function(e){var i,s,c,l=0,p=!1,u=[],m=!1,f=function(){var r=a.map(function(e){return $.formatString(d.tab,e)}).join("");e.find(".tabs").html(r),h(s)},h=function(r){s=r,l=0,p=!1,e.find(".tab").removeClass("theme-color theme-border-red-decorate"),e.find(".tab-type"+s).addClass("theme-color theme-border-red-decorate"),e.find(".orders").empty(),e.find(".placeholder").css("display","none"),u=[],g()},g=function(){p||(0==l?e.showLoading():e.headerLoading(80),m=!0,base.ajaxPost("/data/getOrderList",{type:s,pageIndex:l+1,itemsPerPage:10},function(r){if(m=!1,0==l?e.hideLoading():e.headerLoading(100),0==r.errno){var n=r.data;n.length<10&&(p=!0),l++,u=u.concat(n);var a=$.formatString,o=n.map(function(e){var r="",n=e.buttons||[],o="",i="order-footer-hide";return r=t.renderOrderImgs(e),n.length>0&&(i=""),o=n.map(function(r){return a(d.order_btn,{orderid:e.id,orderno:e.order_no},r)}).join(""),a(d.order,{products:r,hideFooterClass:i,btns:o},e)}).join("");if(u.length){var s="append";n.length&&n.length==u.length&&(s="html"),e.find(".orders")[s](o),p&&e.find(".placeholder").css("display","block")}else e.find(".orders").html(t.renderEmptyNotice("还没有订单哦"));i.refresh()}else e.alert(r.errmsg)}))},v=function(){e.replaceView("orderlist",{type:s})},y=function(){r.isOrderStatusChanged()&&(r.setOrderStatusChanged(!1),v())},b=function(t){i=e.getScroller(),s=t.type||a[0].key,f(),c=new n(e.find(".orders-wrap"),{logAction:"order_action",getOrder:function(e,r){var t=!1;return $.each(u,function(r,n){if(n.id==e)return t=n,!1}),t}}),e.listen(c,"operateSuccess",function(t){var n=t.isSuccess,a=t.operation;n&&(r.setOrderStatusChanged(!0),"delete"==a?e.finishView():"again"==a?(e.switchNav("cart"),e.viewMgr.clearToRoot()):v())}),e.listen(c,"openView",function(r){var t=r.order,n=r.operation,a=r.view;e.changeView(a,{order:t,operation:n})}),e.listen(i,"scroll",function(e){m||p||!this.isBottom(this.wrapperWidth)||g()})};return{html:o,init:b,getTrackId:function(){return"order_action"},onResume:y,action_tabTap:h,action_reload:v,action_order_detail:function(r,t){e.changeView("order",{orderId:r,orderNo:t})},onDestory:function(){c=null}}}});
/*![m/view_order.js]*/define("m/view_order",["partner/Partner","m/OrderOperate","m/utils","m/main"],function(e,t,n,a){var r={title:{left:"back",right:"reload",contentHtml:[{key:"timeline",name:"订单状态"},{key:"detail",name:"订单详情"}]},contentHtml:'<div class="main scroller"></div>\n<div class="pub-footer order-footer theme-spline spline-top"></div>\n<div class="order-welfare tap-action" data-tap="welfare">\n<div class="welfare-close tap-action" data-tap="welfareClose"></div>\n</div>'},i={main:'<ol class="order-tabpanel mod-order-timeline">#{status}</ol>\n<div class="order-tabpanel mod-order-detail" style="display:none">\n<div class="block nuomi-item daojia58-item detail-timeline more tap-action" data-tap="titleTab|timeline">\n<span class="ui-colorred ui-float-right">#{curStatusTitle}</span>\n订单状态\n</div>\n<div class="block">\n<table class="detail-table">\n<tr>\n<th>订单号</th>\n<td>#{order_no}</td>\n</tr>\n<tr>\n<th>收货码</th>\n<td>#{checknum}</td>\n</tr>\n<tr>\n<th>下单时间</th>\n<td>#{create_time}</td>\n</tr>\n<tr>\n<th>收货时间</th>\n<td>#{accept_time}</td>\n</tr>\n<tr>\n<th>支付方式</th>\n<td>#{payMethod}</td>\n</tr>\n</table>\n</div>\n<div class="block">\n<table class="detail-table">\n<tr>\n<th>收货人</th>\n<td><span class="ui-float-right">#{telphone}</span>#{accept_name}</td>\n</tr>\n<tr>\n<th>收货地址</th>\n<td>#{address}</td>\n</tr>\n</table>\n</div>\n<div class="block block-detail">\n<h3 class="products-title theme-grayfont">费用明细</h3>\n#{products}\n<ul class="fee-list theme-spline spline-top">#{feeList}</ul>\n<div class="fee-total theme-spline spline-top cf">\n<span class="ui-float-right">\n实付&nbsp;&nbsp;&nbsp;&nbsp;<span class="theme-redfont">￥#{real_amount_float}</span>\n</span>\n</div>\n</div>\n<div class="block-tel">\n<span class="theme-grayfont">若有疑问，请</span>&nbsp;<a class="theme-redfont" href="tel:4008484842">联系客服 400-8484-842</a>\n<br />\n</div>\n<div class="block-company" style="display:none">\n<span class="logo"></span>\n本服务由58到家合作商 (爱鲜蜂) 提供\n</div>\n</div>',fee:'<li><span class="ui-float-right">￥#{valueFloat}</span>#{text}</li>',step:'<li class="step theme-spline spline-bottom">\n<div class="step-time">#{status_time}</div>\n<div class="step-container">\n<span class="step-title">#{status_title}</span>\n<p class="step-desc">#{status_desc}</p>\n</div>\n</li>',btn:'<span class="order-action order-action-#{type} theme-bg"\ndata-type="#{type}"\ndata-orderid="#{orderid}"\ndata-orderno="#{orderno}">\n#{text}\n</span>'};return function(o){var s,d,l,c,p,f=function(e){p=e,o.find(".order-tabpanel").hide(),o.find(".mod-order-"+e).show(),o.find(".main")["timeline"==e?"addClass":"removeClass"]("tab-timeline"),s.refresh()},u=function(){var t=c.payKey,a={orderid:c.orderId,orderno:c.orderNo};$.isDaojia58&&(a={djOrderId:c.djOrderId}),o.showLoading(),base.ajaxPost("/data/getOrderDetail",a,function(a){if(0==a.errno){l=a.data;var r,p,u,m,h=l.status_timeline,v=l.detail_buttons||[],b="",y=l.fee_list,_="",w=l.order_goods,g="noFooter";$.isDaojia58&&(v=v.filter(function(e){return 9!=e.type&&4!=e.type}));var k=$.formatString;r=h.map(function(e){return k(i.step,{status_desc:e.status_desc.replace(/%(\S+)%[：:]\{(\S+)\}/,'$1：<a class="phone ui-colorred" href="tel:$2">$2</a>').replace("\\n","<br/>")},e)}),$.isDaojia58&&(r=r.reverse()),r=r.join(""),v.length>0&&(g=""),p=v.map(function(e){return 9==e.type?(b=k(i.btn,{orderid:l.id,orderno:l.order_no},e),""):k(i.btn,{orderid:l.id,orderno:l.order_no},e)}).join(""),p=b+p,_=y.map(function(e){return k(i.fee,e,{valueFloat:parseFloat(e.value)})}).join(""),u=n.renderOrderProduct(w),m=k(i.main,{curStatusTitle:h[0]&&h[0].status_title||"",status:r,feeList:_,real_amount_float:parseFloat(l.order_amount),payMethod:0==l.pay_type?"货到付款":"在线支付",products:u},l),o.containerNode.addClass(g).find(".main").html(m),o.find(".order-footer").html(p),$.isNuomi&&f("detail"),$.isDaojia58&&(f("detail"),o._titleTab("detail"),o.find(".block-tel").css("display","none"),o.find(".block-company").css("display","block")),s.refresh(),t&&1==l.pay_type&&1!=l.pay_status?d._pay(t):c.welfare&&e.isSupport("share")&&!e.getLogicConf("hideWelfare")&&o.find(".order-welfare").css("display","block")}else o.alert(a.errmsg);o.hideLoading()})},m=function(e){"confirm"==e.from&&$("body").addClass("order-making"),c=e,s=o.getScroller(),u(),d=new t(o.find(".order-footer"),{logAction:"order_detail_action",getOrder:function(){return l}}),o.listen(d,"operateSuccess",function(e){var t=e.isSuccess,n=e.operation;if(t)if(a.setOrderStatusChanged(!0),"delete"==n)o.finishView();else if("again"==n)o.switchNav("cart"),o.viewMgr.clearToRoot();else{var r=$.extend({},c);delete r.payKey,c.payKey&&"pay"==n&&(r.welfare=!0),o.replaceView("order",r)}"pay"==n&&$("body").removeClass("order-making")}),o.listen(d,"openView",function(e){var t=e.order,n=e.operation,a=e.view;o.changeView(a,{order:t,operation:n})}),window.localStorage&&window.localStorage.removeItem("PAY_REDIRECT")},h=function(e,t){var t=$.extend({},c);delete t.payKey,o.replaceView("order",t)};return{html:r,init:m,getTrackId:function(){return"order_detail_action"},onResume:h,onDestroy:function(){$("body").removeClass("order-making")},onBeforeBack:function(){return(window.location.href.indexOf("forward")>0||$.isDaojia58)&&"boot"==o.viewMgr.name?(e.isSupport("exit")?e.exit():history.back(),!1):($.isNuomi||$.isDaojia58)&&"timeline"==p?(o._titleTab("detail"),!1):void 0},action_titleTab:f,action_reload:function(){var e=$.extend({},c);delete e.payKey,o.replaceView("order",e)},action_welfare:function(){d._welfare(c.orderId,c.orderNo),o.find(".order-welfare").css("display","none")},action_welfareClose:function(){o.find(".order-welfare").css("display","none")}}}});
/*![m/view_msg.js]*/define("m/view_msg",function(){var n={title:{left:"back",contentHtml:[{key:"sys",name:"系统消息"},{key:"user",name:"用户消息"}]},contentHtml:'<div class="main"></div>'};return function(t){var e=function(n){},i=function(n){};return{html:n,init:i,action_titleTab:e}}});
/*![m/view_aftersale.js]*/define("m/view_aftersale",["m/main"],function(e){var i={title:{left:"back",contentHtml:"帮助中心"},contentHtml:'<div class="main scroller">\n<div>\n<div class="block padding-left">\n<div class="item item-idea theme-spline spline-list more tap-action" data-tap="changeView|idea" data-log="feedback">\n<div class="title">意见反馈</div>\n<div class="desc theme-grayfont">1-2个工作日内反馈</div>\n</div>\n<div class="item item-help theme-spline spline-list more tap-action" data-tap="qa" data-log="question">\n<div class="title">常见问题</div>\n<div class="desc theme-grayfont">配送时间、优惠券和退款流程等</div>\n</div>\n<a class="item item-phone theme-spline spline-list tap-action" href="tel:4008484842" style="display:block;" data-tap="call">\n<div class="title">客服电话</div>\n<div class="desc">400-8484-842</div>\n</a>\n</div>\n</div>\n</div>'};return function(e){var t=function(e){};return{init:t,html:i,getTrackId:function(){return"cust_service_feedback_action"},action_qa:function(){e.changeView("iframe",{url:"/show/webview?p=qa",title:"常见问题",webview:!0})},action_call:function(){base.clickLog("cust_service_feedback_action",{actionType:"custServiceMobile"})}}}});
/*![m/view_home.js]*/define("m/view_home",["lib/Performance","lib/NewSlider","partner/Partner","m/main","m/utils"],function(t,e,a,i,n){var s={title:{left:a.getLogicConf("isFullScreen")?"exit":a.isSupport("scanQR")?"scanact[扫一扫]":void 0,right:"search[搜&nbsp;索&nbsp;]",rightTap:"changeView|search",contentHtml:"加载中",titleTapLog:"address",className:"theme-bg theme-border"},contentHtml:'<div class="main scroller">\n<div class="home-content">\n<div class="main-acts acts-empty"></div>\n<div class="main-hot scroller-firstin" data-offset="300">\n<fieldset class="theme-spline spline-top">\n<legend class="theme-grayfont">鲜蜂热卖</legend>\n</fieldset>\n<ul class="main-hot-list cf"></ul>\n<div class="main-hot-footer theme-grayfont tap-action" data-tap="switchNav|menu">点击查看全部商品</div>\n</div>\n<div class="navs-holder"></div>\n</div>\n<div class="home-error"></div>\n</div>'},o={distance:'<div class="home-distance tap-action" data-tap="distance"><span class="ui-float-right">╳</span>当前收货地址不在您的附近</div>',longTap:"爱鲜蜂线下配送点：<br/>#{number}(#{WorkBegin}-#{WorkEnd})",business:{wrap:'<div class="home-business block #{orderCls}">#{blocks}</div>',subBlock:'<ul class="business-sub business-sub-#{type}">#{subBlockItems}</ul>',subBlockItem:'<li class="business-sub-item tap-action theme-spline #{cls}" #{jump} #{log}><div class="business-sub-item-inner theme-spline" style="background-image:url(#{img});">#{content}</div></li>'}},c={focus:{type:"focus",tpl:'<div class="acts-focus">#{act_rows}</div>',item_tpl:'<div class="acts-focus-item tap-action" #{jump} data-log="focus" style="background-image:url(#{img});"></div>'},icon:{tpl:'<ul class="block acts-icon theme-spline cf">#{act_rows}</ul>',item_tpl:'<li class="acts-icon-item tap-action" #{jump} data-log="icon" >\n<div class="acts-icon-item-img" style="background-image:url(#{img})"></div>\n<p class="acts-icon-item-name">#{name}</p>\n</li>'},headline:{tpl:'<div class="block acts-headline cf">\n<span class="acts-headline-head" style="background-image:url(#{head_img})">鲜蜂头条</span>\n<ul class="acts-headline-list theme-spline theme-grayfont">#{act_rows}</ul>\n</div>',item_tpl:'<li class="acts-headline-item ui-ellipsis tap-action" #{jump} data-log="headline">\n<span class="pm-embossed">#{title}</span>\n<span class="acts-headline-item-text">#{content}</span>\n</li>',item_tpl_opts:{title:function(t,e){return e.headline_detail.title},content:function(t,e){return e.headline_detail.content}}},brand:{tpl:'<ul class="block acts-brand cf">#{act_rows}</ul>',item_tpl:'<li class="acts-brand-item theme-spline tap-action" #{jump} data-log="brand" style="background-image:url(#{img})"></li>'},scene:{tpl:'<ul class="block acts-scene cf">#{act_rows}</ul>',item_tpl:'<li class="acts-scene-item theme-spline tap-action" #{jump} data-log="scene" style="background-image:url(#{img})"></li>'},category:{tpl:'<ul class="acts-category cf">#{act_rows}</ul>',item_tpl:'<li class="block acts-category-item">\n<div class="acts-category-item-header cf">\n<span class="acts-category-item-header-title" style="color:##{titleColor};border-color:##{titleColor}">#{title}</span>\n<span class="acts-category-item-header-more theme-grayfont tap-action more" data-tap="category|#{category_id}" data-log="categoryBanner_clickMore">更多<span class="theme-spacer"></span></span>\n</div>\n<div class="acts-category-item-banner tap-action scroller-lazyload" #{jump} data-log="categoryBanner" data-src="#{img}"></div>\n<ul class="acts-category-item-goodsList cf">#{goods}</ul>\n</li>',item_tpl_opts:{title:function(t,e){return e.category_detail.name},titleColor:function(t,e){return e.category_detail.category_color},goods:function(t,e){return n.renderProducts(e.category_detail.goods,{customClass:"theme-spline",columns:3,hideDel:!0,extraLogParams:{modularType:"categoryBanner"}})},category_id:function(t,e){return 2==e.target_type?"act":e.category_detail.category_id}}}},r=!1;return function(l){function d(t){var n=$.formatString,s=t.map(function(t){if("business"==t.type)return v(t);var e=c[t.type];if(!e)return"";if(t&&t.act_rows&&t.act_rows.length>0){var s,o=function(){var a=e.tpl_opts||{},i={};for(key in a)$.isFunction(a[key])?i[key]=a[key].bind(a,t):i[key]=a[key];return i}();if((s=a.getLogicConf("home_"+t.type+"_filter"))&&(t.act_rows=t.act_rows.filter(function(t){return s(t,i.getShop())}),!t.act_rows.length))return"";"brand"==t.type&&(t.act_rows.length-=t.act_rows.length%3);var r=t.act_rows.map(function(a){var i=function(){var i=e.item_tpl_opts||{},n={};for(key in i)$.isFunction(i[key])?n[key]=i[key].bind(i,t,a):n[key]=i[key];return n.jump=' data-tap="jump|'+a.activity.id+","+a.activity.jptype+'" ',n}();return n(e.item_tpl,i,a.activity)}).join("");return n(e.tpl,{act_rows:r},o,t)}return""}).join("");l.find(".main-acts").removeClass("acts-empty").html(s),l.find(".main-hot").addClass("scroller-firstin").find(".main-hot-list").empty(),m&&m.destroy(),p&&p.destroy(),m=new e({wrap:l.find(".acts-focus"),slideSelect:".acts-focus-item"}),p=new e({wrap:l.find(".acts-headline-list"),slideSelect:".acts-headline-item",isVertical:!0,size:"2.2rem",interval:4500}),l.getScroller().refresh().scrollTo()}function u(t){t.dealer&&base.ajaxPost("/data/homeHotProducts",{location:(t.dealer.longitude||t.dealer.lng)+","+(t.dealer.latitude||t.dealer.lat),bigids:t.dealer.bigids,zchtid:t.dealer.zchtid},function(t){if(0==t.errno&&t.data.length){var e=n.renderProducts(t.data,{extraLogParams:{modularType:"hot"}});l.find(".main-hot").css("display","block").find(".main-hot-list").html(e),l.getScroller().refresh()}else l.find(".main-hot").css("display","none")})}var m,p,g=!1,f=function(t){if(!$.isNuomi){if(r)return void(l.find(".home-distance").remove().length&&l.getScroller().refresh());var e=t.getUserAddr();e&&(r=!0,i.getGPS(function(t){if(t.success){var a=base.distanceOfTwoPoints(t.longitude,t.latitude,e.lng,e.lat);a<2e3||(l.find(".home-content").prepend(o.distance),l.getScroller().refresh())}}))}},h=function(e){var a=i.getShop();if("loading"==a.status)l.showLoading();else if("done"==a.status){var s=a.act_info;l.removeClass("haderr"),l.hideLoading(),d(s,l),f(a),t.makeTime("listShow").addData("cityid",a.dealer.cityid).report()}else l.addClass("haderr"),l.hideLoading(),"unsupport"==a.status?l.find(".home-error").html(n.renderEmptyNotice(a.statusText,"换个地址试试","selectAddr")):l.find(".home-error").html(n.renderEmptyNotice(a.statusText))},y=function(t,e,a){if(!a||"chead"==e||"cgoods"==e)return"";var i={operationId:t};switch(a.activity?i.subjectId=a.activity.id:a[e+"detail"]&&(i.categoryId=a[e+"detail"].category_id),e){case"cactivity":i.actionType="operationCategoryBig";case"cicons":i.actionType="operationCategorySmall";case"cscene":i.actionType="operationCategorySmall"}return"data-log="+JSON.stringify(i)},v=function(t){if(1==t.act_rows.length)return"";var e=$.formatString,a=t.act_rows[0].act_rows[0].chead_detail.cms_id;return e(o.business.wrap,{blocks:function(){return t.act_rows.map(function(t){var i=t.type;return e(o.business.subBlock,{type:i,subBlockItems:function(){return t.act_rows.map(function(t){var s,c=t[i+"_detail"],r=c.target_type,l=t.activity,d=c.img,u="",m="";return r&&(s="11"==r&&l?l.id:"12"==r?c.category_id:void 0,u=[' data-tap="jump|',s,",",r,'" '].join("")),"cgoods"==i?(d="about:blank",u="",m=c.goods.map(function(i){if("1"==i.dtype){var s,c=i.target_type;return s="11"==c&&t.more_activity?t.more_activity.id:"12"==c?i.id:void 0,e(o.business.subBlockItem,{img:i.img,jump:[' data-tap="jump|',s,",",c,'" '].join(""),content:"",cls:"business-sub-cgoods-item goods-more",log:{actionType:"operationGoodsClickMore",operationId:a,jumpType:c}})}return n.renderProducts(i,{customClass:"business-sub-cgoods-item theme-spline",columns:3,hideDel:!0,extraLogParams:{operationId:a},extraDetailLogParams:{operationId:a}})}).join(""),m='<ul class="cf goodsList">'+m+"</ul>"):"cicons"==i&&(m='<div class="ui-ellipsis">'+c.name+"</div>"),e(o.business.subBlockItem,{img:d,jump:u,content:m,cls:"",log:y(a,i,t)})}).join("")}})}).join("")}})},_=function(){var t=i.getShop().addrName||"加载中";a.getLogicConf("hideHeader")&&a.isSupport("setHeaderTitle")&&2==a.setHeaderTitle.length&&(t+=" ▾"),l.setTitle('<span class="title-addrname">'+t+"</span>")},b=function(t){var e=i.getShop();_(),l.listen(i.getShop(),"progressing",h),l.listen(e,"addrNameChange",function(){_()}),l.listen(l.getScroller(),"firstin",function(){u(i.getShop(),l)}),h(),l.bindShoppingOpe(),l.find(".header-content").on("longTap",function(t){l.alert($.formatString(o.longTap,e.dealer)),t.stopPropagation(),t.preventDefault()}),a.getLogicConf("hideNavs")&&l.showCartBtn(),window.home_changeView=function(t,e){l.changeView(t,e)},window.handleScanResult=w},w=function(t){if(0==t.indexOf("activity://")){var e=base.jsonDecode(t.replace("activity://","")),a=i.getShop();if(!e)return;e&&e.ext_params&&(e.ext_params.bigids=a.bigids,e.ext_params.cityid=a.cityid),l.changeView("act",{activityObj:e})}t.indexOf("weixin.qq.com/q/")>-1&&base.ajaxPost("/submit/addShop",{qrcode:t},function(t){0==t.errno&&t.data.new_fav?(l.alert("收藏成功，您可以在此店下单了"),i.getShop().setAddr(t.data.new_fav.dealer_info),i.getShop().designated_dealerid=t.data.new_fav.dealer_id):l.alert(t.data.errmsg)})},k=function(){a.isSupport("scanQR")?a.scanQR(function(t){t.success&&w(t.result)}):l.alert("当前环境不支持扫描二维码")},S=function(){m&&m.destroy(),p&&p.destroy(),m=null,p=null};return{html:s,init:b,getTrackId:function(){return g||"home_action"},onResume:function(){g=!1,l.getScroller().refresh()},onDestory:S,action_jump:function(t,e){if(11==e){var a=i.getShop().getActivityById(t);a.trackid&&(g=a.trackid),l.changeView("act",{activityObj:a})}else 12==e?l.switchNav("menu",{categoryId:t}):13==e&&l.switchNav("act")},action_switchNav:function(t){l.switchNav(t)},action_category:function(t){"act"==t?l.switchNav(t):l.switchNav("menu",{categoryId:t})},action_titleTap:function(){l.changeView("addrlist",{isSelect:!0,showGps:!0})},action_distance:function(){$(this).remove(),l.getScroller().refresh()},action_scanact:k}}});
/*![m/view_idea.js]*/define("m/view_idea",["m/main"],function(e){var t={title:{left:"back",contentHtml:"意见反馈"},contentHtml:'<div class="main theme-bg-white"></div>'},a={form:'<form class="idea-form" onsubmit="return false">\n<p class="idea-form-desc">您的批评和建议能帮助我们更好完善产品，请留下您的宝贵意见！</p>\n<ul class="idea-form-types cf">\n#{feedback_types}\n</ul>\n<input type="hidden" name="type"/>\n<textarea class="theme-bg-gray theme-spline" name="comment" placeholder="请输入宝贵意见(300字以内)"></textarea>\n<button class="idea-submit theme-bg theme-border tap-action" type="submit" maxlength="2" data-tap="submit">提交</button>\n</form>',feedback_type:'<li><span class="idea-form-type theme-spline theme-grayfont tap-action" data-tap="select_type|#{id}">#{comments}</span></li>'};return function(e){function n(t){var a=$(this),n=e.find(".idea-form-type"),i=e.find('input[name="type"]');n.removeClass("theme-bg theme-border"),i.val()==t?i.val(""):(i.val(t),a.addClass("theme-bg theme-border"))}function i(){var t=e.find('input[name="type"]').val(),a=e.find("textarea").val();return a?a.length<5?void e.tip("这里要给我们五个字以上的建议哦"):t?(e.showLoading("正在发送"),void base.ajaxPost("/submit/feedback",{ftid:t,msg:a},function(t){e.hideLoading(),0==t.errno?(e.tip("您的意见已收到，感谢您的支持！"),e.finishView(null,!0)):e.alert(t.errmsg)})):void e.tip("请您选择反馈类型"):void e.tip("您还没有给我们写下意见呢")}var m=function(){e.showLoading(),base.ajaxGet("/data/feedbackTypes",{},function(t){var n=$.formatString;if(0==t.errno){var i=$.map(t.data,function(e){return n(a.feedback_type,e)}).join(""),m=n(a.form,{feedback_types:i});e.find(".main").html(m)}else e.alert(t.errmsg);e.hideLoading()})};return{init:m,html:t,action_submit:i,action_select_type:n}}});
/*![m/view_iframe.js]*/define("m/view_iframe",["lib/base","m/utils"],function(t,n){var i={title:{left:"back",contentHtml:"加载中"},contentHtml:'<div class="main"><iframe class="iframe"></iframe></div>'};return function(e){var l,a=!1,o=function(i){a=!!i.webview,i.title?e.setTitle(i.title):a||(l.onload=function(){e.setTitle(this.title)}),a?t.ajaxLoad(function(t){e.headerLoading(50),n.appendHtmlContent(e.find(".main").html(""),t,function(t){e.headerLoading(t)})},i.url,{}):(l=e.find(".iframe")[0],l.src=i.url)},r=function(){a||(l.onload=null,l=null)};return{html:i,init:o,onDestory:r}}});
/*![m/view_menu.js]*/define("m/view_menu",["partner/Partner","m/main","m/utils","lib/Scroller","lib/NewSlider"],function(t,e,a,i,r){var s={title:{right:"search[搜&nbsp;索&nbsp;]",rightTap:"changeView|search",contentHtml:"加载中",className:"theme-bg theme-border"},contentHtml:'<div class="main">\n<div class="toolbar"></div>\n<div class="focus"></div>\n\n<div class="main-content theme-spline spline-top">\n<div data-scroller="categories" class="categories-wrap scroller">\n<ul class="categories"><ul>\n</div>\n<div data-scroller="productList" class="productList-wrap scroller">\n<ul class="productList"></ul>\n</div>\n<div class="product-filter tap-action" data-tap="expandFilter">\n<ul class="filter-titles theme-spline spline-bottom"></ul>\n<ul class="filter-items cf"></ul>\n</div>\n<div class="menu-error"></div>\n</div>\n</div>'},o={toolbar:'<div class="addr ui-ellipsis tap-action" data-tap="titleTap">#{addr}</div>\n<div class="search tap-action" data-tap="changeView|search"></div>',focusItem:'<div class="focus-item tap-action" #{jump} style="background-image:url(#{img});"></div>',category:'<li class="categories-item theme-spline tap-action categories-item#{id}" data-categoryId=#{id} data-tap="categoryTap|#{id}" data-log="categoryClick" #{flagBg}>#{name}</li>',filterTitle:'<li class="filter-title filter-title-sub tap-action" data-tap="expandFilter|sub" data-log="secondCategoryOpen">#{name}&nbsp;</li><li class="filter-title filter-title-sort tap-action" data-tap="expandFilter|sort" data-log="sortOpen">#{sortName}&nbsp;</li>',filterItem:'<li class="filter-item filter-item-#{type} tap-action #{className}" data-tap="categoryTap|#{categoryId},#{subIdx},#{sortIdx}" data-log="#{logActionType}">#{name}</li>',navsHolder:'<li class="navs-holder"></li>',filterHolder:'<li class="filter-holder"></li>'},n=[{name:"综合排序"},{name:"销量最高",fn:function(t,e){return parseInt(e.product_num)-parseInt(t.product_num)}},{name:"价格最低",fn:function(t,e){return parseFloat(t.price)-parseFloat(e.price)}},{name:"价格最高",fn:function(t,e){return parseFloat(e.price)-parseFloat(t.price)}}];return function(i){var d,c,l,u=null,p=!1,f={},m=[],g={},h=null,v=function(){var e=u.addrName||"加载中";$.isDaojia58&&i.find(".toolbar").html($.formatString(o.toolbar,{addr:e})),t.getLogicConf("hideHeader")&&t.isSupport("setHeaderTitle")&&2==t.setHeaderTitle.length&&(e+=" ▾",$.isDaojia58&&(e="闪送超市")),i.setTitle('<span class="title-addrname">'+e+"</span>"),"loading"==u.status?i.showLoading("解析中"):i.hideLoading()},y=function(e){if(!(e&&e.categories&&e.categories.length&&e.products))return i.addClass("haderr"),i.removeClass("hadproduct"),void i.find(".menu-error").html(a.renderEmptyNotice("抱歉，当前区域暂不支持闪送服务","换个地址试试","selectAddr"));var r,s=$.formatString;m=e.categories,f={},g={};var n=t.getLogicConf("hideCates")||[];r=e.categories.map(function(t){if($.isInArray(n,t.id))return"";var a;if($.isObject(t.cids)){a=[];for(var i in t.cids)a.push(t.cids[i])}else a=$.isArray(t.cids)?t.cids:[];return g[t.id]=a,f[t.id]={cids:a,name:t.name,products:e.products[t.id]},s(o.category,t,{flagBg:t.flag?'style="background-image:url('+t.flag+');"':""})}).join(""),r+=o.navsHolder,i.find(".categories").html(r),C()},b=function(t,e){var r=[],s={isPortrait:!1,itemDetail:!0},n=Math.max(100*(e-1)+20,0),d=100*e+20,c=t.length;for(0==n&&r.push(o.filterHolder);n<d&&n<c;n++)r.push(a.renderProducts(t[n],s));n==c?r.push(o.navsHolder):setTimeout(function(){b(t,e+1)},e?50:500),i.find(".productList").append(r.join("\n")),0==e||d>=c?i.getScroller("productList").refresh().scrollTo(0,0):d>=c&&i.getScroller("productList").refresh()},C=function(t,e,a){!t&&d&&(t=d),f[t]||(t=m[0].id),d=t,e=e||0,a=a||0,i.find(".categories-item").removeClass("theme-border-decorate"),i.find(".categories-item"+t).addClass("theme-border-decorate"),i.find(".productList").html("");var r,s,c=f[t].products;g[t]&&g[t][e]?(r=g[t][e],s=parseInt(r.id),s&&(c=c.filter(function(t){return t.child_cid==s}))):r={id:0,name:"全部分类"};var l;(l=n[a].fn)&&(c=c.map(function(t){return t}).sort(l)),b(c,0),i.find(".product-filter").removeClass("expand expand-sub expand-sort"),i.find(".filter-titles").html($.formatString(o.filterTitle,r,{categoryId:t,sortName:n[a].name})),i.find(".filter-items").html(g[t].map(function(i,r){return $.formatString(o.filterItem,i,{categoryId:t,subIdx:r,type:"sub",sortIdx:a,logActionType:"secondCategoryClick",className:r==e?"theme-border":""})}).concat(n.map(function(i,r){return $.formatString(o.filterItem,i,{categoryId:t,subIdx:e,type:"sort",sortIdx:r,logActionType:{0:"sortComprehensiveClick",1:"sortSalesClick",2:"sortPriceLowestClick",3:"sortPriceHighestClick"}[r],className:r==a?"theme-border":""})})).join(""))},I=function(){if(!u||u.shopId===p)return!1;if(p=u.shopId,i.showLoading(),i.find(".toolbar,.focus").css("opacity",0),"done"==u.status)i.removeClass("haderr"),base.ajaxGet("/data/getCategoryProduct",{zchtid:u.shopId,bigids:u.dealer.bigids},function(t){0==t.errno?(i.addClass("hadproduct"),y(t.data)):i.alert(t.errmsg),i.hideLoading(),i.find(".toolbar,.focus").css("opacity",1)});else if("error"==u.status||"unsupport"==u.status)if(i.hideLoading(),i.addClass("haderr"),i.removeClass("hadproduct"),"unsupport"==u.status)i.find(".menu-error").html(a.renderEmptyNotice(u.statusText,"换个地址试试","selectAddr"));else{var t=$.isDaojia58?"亲，定位失败了，手动选个地址吧~":u.statusText;i.find(".menu-error").html(a.renderEmptyNotice(t,"手动选择地址","selectAddr"))}return!0},x=function(){if(t.getLogicConf("showActsInMenu")&&u.act_info){var e=u.act_info.filter(function(t){return"category"==t.type})[0];if(!(e&&e.act_rows&&e.act_rows.length>0))return void i.find(".main").removeClass("hasFocus");var a=e.act_rows.map(function(t,e){return e>2?"":$.formatString(o.focusItem,{jump:' data-tap="jump|'+t.activity.id+","+t.activity.jptype+'" '},t.activity)}).join("");i.find(".main").addClass("hasFocus"),i.find(".focus").html(a),h=new r({wrap:i.find(".focus"),slideSelect:".focus-item"})}},w=function(a){d=a.categoryId,u=e.getShop(),c=i.getScroller("categories"),l=i.getScroller("productList"),i.listen(u,"progressing",function(){v(),x(),i.isShowing()&&I()}),v(),x(),I(),i.bindShoppingOpe(),t.getLogicConf("hideNavs")&&i.showCartBtn()},S=function(){u=null,h&&h.destroy(),h=null};return{init:w,html:s,getTrackId:function(){return"category_action"},onDestory:S,action_titleTap:function(){i.changeView("addrlist",{isSelect:!0,showGps:!0})},action_categoryTap:C,action_expandFilter:function(t){var e=i.find(".product-filter"),a=e.hasClass("expand-"+t);e.removeClass("expand expand-sort expand-sub"),t&&!a&&i.find(".product-filter").addClass("expand expand-"+t)},onResume:function(t,e){I()||(e&&e.categoryId?C(e.categoryId):i.getScroller("productList").refresh())},action_jump:function(t,a){if(1==a){var r=e.getShop().getActivityById(t);r.trackid&&(gTrackId=r.trackid),i.changeView("act",{activityObj:r})}else 4==a&&i.switchNav("menu")}}}});
/*![m/view_mine.js]*/define("m/view_mine",["partner/Partner","m/main"],function(e,a){var t=[{key:"pointsShop",name:"积分商城",logActionType:"clickPointsMall"},{key:"coupon",name:"优惠券",logActionType:"coupons"},{key:"addrlist",name:"收货地址",logActionType:"address"},{key:"aftersale",name:"客服/反馈",logActionType:"custServiceFeedback"},{key:"about",name:"关于我们"}],n=4,i=[{key:"11",name:"待付款",logActionType:"unPaidOrder"},{key:"12",name:"待收货",logActionType:"unRecOrder"},{key:"15",name:"待评价",logActionType:"unElvOrder"},{key:"17",name:"退款/售后",logActionType:"afterSaleOrder"}];e.isSupport("share")&&t.push({key:"share",name:"分享给朋友"});var o={contentHtml:$.formatString('<div class="main">\n<div class="userinfo theme-bg tap-action" data-tap="member" data-log="clickUserCenter">\n<div class="user">\n<p class="user-phone"></p>\n<p class="user-level theme-redfont"></p>\n</div>\n</div>\n<div class="favorite theme-bg">\n<div class="item goodsFavorite tap-action" data-tap="item|goodsFavorite"><span class="item-inner">商品收藏<span></div>\n<div class="split"></div>\n<div class="item shopFavorite tap-action" data-tap="item|shop" data-log="myCollectStore"><span class="item-inner">店铺收藏</span></div>\n</div>\n<div class="mine-content scroller">\n<div>\n<div class="block mine-order">\n<div class="tap-action theme-spline spline-bottom more padding" data-tap="order|0" data-log="order">\n<span class="theme-grayfont ui-float-right">查看全部订单</span>\n我的订单\n</div>\n<ul class="order-types cf">\n#{orderTypes}\n</ul>\n</div>\n<div class="block">\n<table width="100% mine-items">\n#{items}\n</table>\n</div>\n\n<div class="logout theme-btn-light tap-action" data-tap="logout">退出当前帐号</div>\n<div class="navs-holder"></div>\n</div>\n</div>\n</div>',{orderTypes:i.map(function(e){return $.formatString('<li class="order-type order-type-#{key} tap-action" data-tap="order|#{key}" data-log="#{logActionType}">#{name}</li>',e)}),items:function(){var e=[];return $.each(t,function(a,t){a%n==0&&e.push("<tr>"),e.push($.formatString('<td class="mine-item mine-item-#{key} tap-action" width="#{width}%" data-tap="#{dataTap}" data-log="#{logActionType}">#{name}</td>',t,{width:100/n,dataTap:"share"==t.key?"share":"item|"+t.key})),a%n==n-1&&e.push("</tr>")}),e.join("")}})};return function(e){var t,n=function(){e.headerLoading(80),base.ajaxPost("/data/memberCenter",{},function(a){e.headerLoading(100);$.formatString;0==a.errno&&a.data&&200==a.data.code?(t=a.data.data,e.find(".user-phone").text(t.username),e.find(".user-level").text(t.name)):0==a.errno&&a.data&&200!=a.data.code?e.alert(a.data.msg):e.alert(a.errmsg)})},i=function(e){n()},r=function(a){"share"==a||e.changeView(a)},s=function(a){var a=a||0;e.changeView("orderlist",{type:a})};return{html:o,init:i,getTrackId:function(){return"my_action"},action_item:r,action_order:s,action_member:function(){$.isAndroid&&$.isBestpay||(t?e.changeView("member",{member:t}):e.alert("获取会员信息失败"))},onResume:function(e,a){"pointsShop"==e&&a&&a.pointsChanged&&n()},action_logout:function(){e.showLoading("退出中"),a.getUser().logout(function(){e.hideLoading()})}}}});
/*![m/view_msg.js]*/define("m/view_msg",function(){var n={title:{left:"back",contentHtml:[{key:"sys",name:"系统消息"},{key:"user",name:"用户消息"}]},contentHtml:'<div class="main"></div>'};return function(t){var e=function(n){},i=function(n){};return{html:n,init:i,action_titleTab:e}}});
/*![m/view_cancel.js]*/define("m/view_cancel",["m/main","lib/Storage"],function(e,n){var i={title:{left:"back",contentHtml:"取消订单"},contentHtml:'<div class="mod-cancel main main-top scroller">\n<form class="cancel-form" onsubmit="return false;">\n<ul class="id-hasReceived hasReceived block">\n<li class="tap-action line theme-spline" data-tap="chose_hasReceived|0">我没收到货</li>\n<li class="tap-action line" data-tap="chose_hasReceived|1">我收到货了</li>\n</ul>\n<div class="id-chose-reason block line line-arrow-down tap-action" data-tap="chose_reason">请选择理由</div>\n<input class="id-hidden-hasReceived" type="hidden" name="uapt_goods"/>\n<input class="id-hidden-reason" type="hidden" name="ctype"/>\n<div class="theme-btn-full tap-action" data-tap="submit">提交</div>\n</form>\n</div>'},a={option:'<option value="#{key}">#{item}</option>'};return function(n){var t,d=function(){function e(e,n){var t=[];for(var d in n)t.push(i(a.option,{key:d,item:n[d]}));e.html(t.join(""))}var i=$.formatString;e(n.find(".cancelReason1"),t.cancel_select_msg),e(n.find(".cancelReason2"),t.cancel_select_msg_1),n.find(".cancel-reason1").show()},o=function(e){$(this).siblings().removeClass("line-selected"),$(this).addClass("line-selected"),n.find(".id-hidden-hasReceived").val(e)},s=function(){n.find(".id-hidden-reason").val("");var e,i=n.find(".id-hidden-hasReceived").val();if("0"==i)e=t.cancel_select_msg;else{if("1"!=i)return void n.tip("请选择取消类型");e=t.cancel_select_msg_1}var a=[];for(var d in e)a.push({key:d,name:e[d]});n.popSelect("请选择取消原因",a,function(i){n.find(".id-chose-reason").html(e[i]),n.find(".id-hidden-reason").val(i)},function(){n.find(".id-chose-reason").html("请选择理由")})},c=function(){var i=n.find(".id-hidden-hasReceived").val(),a=n.find(".id-hidden-reason").val();return i?a?(n.showLoading("提交中"),void base.ajaxPost("/submit/cancelOrderV2",{orderId:t.id,orderNo:t.order_no,ctype:a,uapt_goods:i},function(i){0==i.errno?(n.tip("提交成功，正在为您处理，请稍后"),e.setOrderStatusChanged(!0),n.finishView()):n.alert(i.errmsg),n.hideLoading()})):void n.tip("请选择取消原因"):void n.tip("请选择取消类型")},l=function(e){t=e.order,d()};return{html:i,init:l,action_chose_hasReceived:o,action_chose_reason:s,action_submit:c}}});
/*![m/view_comment.js]*/define("m/view_comment",["lib/Storage","m/main","m/utils"],function(a,t,s){var n={1:"很差",2:"不满意",3:"一般",4:"满意",5:"很满意"},e={title:{left:"back",contentHtml:"评价"},contentHtml:'<div class="main scroller">\n\n</div>'},i={main:'<div class="comment-container">\n<div class="order theme-grayfont">\n<span class="attr">订<span class="blank"></span>单<span class="blank"></span>号</span>\n<span>#{order_no}</span>\n<br/>\n<span class="attr">下单时间</span>\n<span>#{create_time}</span>\n</div>\n<div class="order-imgs">#{imgs}</div>\n<div class="order-stars clearfix">\n<div class="comment-title">请您评价</div>\n<ul class="star-list">\n<li class="star empty tap-action" data-star="1" data-tap="star_tap"></li>\n<li class="star empty tap-action" data-star="2" data-tap="star_tap"></li>\n<li class="star empty tap-action" data-star="3" data-tap="star_tap"></li>\n<li class="star empty tap-action" data-star="4" data-tap="star_tap"></li>\n<li class="star empty tap-action" data-star="5" data-tap="star_tap"></li>\n</ul>\n<div class="star-label theme-grayfont"></div>\n</div>\n<ul class="tags tags-bad" style="display:none">#{badTags}</ul>\n<ul class="tags tags-good" style="display:none">#{goodTags}</ul>\n<form class="id-comment-form" onsubmit="return false;">\n<textarea class="id-textarea" name="msg" rows="5" placeholder="您可以从商品质量，配送，服务态度等方面来发表评价（200子以内）" ></textarea>\n<input class="id-hidden-star" type="hidden" name="star"/>\n<input class="id-hidden-tags" type="hidden" name="tag"/>\n<div class="theme-btn-full tap-action" data-tap="submit">提交评价</div>\n</form>\n</div>',tag:'<li class="comment-tag theme-border-gray theme-grayfont tap-action" data-tap="select_tag|#{id}">#{comments}</li>'};return function(a){var r,d,l=function(){a.showLoading(),base.ajaxGet("/data/feedbackCommentTags",{},function(t){0==t.errno?(d={good:[],bad:[]},t.data.forEach(function(a){"11100"==a.star?d.bad.push(a):"00011"==a.star&&d.good.push(a)}),o()):a.alert(t.errmsg),a.hideLoading()})},o=function(){if(r&&d){var t,n,e,l=$.formatString;t=s.renderOrderImgs(r),e=d.good.map(function(a){return l(i.tag,a)}).join(""),n=d.bad.map(function(a){return l(i.tag,a)}).join("");var o=l(i.main,{imgs:t,badTags:n,goodTags:e},r);a.find(".main").html(o)}},m=function(){var t=$(this),s=parseInt(t.data("star")),e=a.find(".id-hidden-star").val();if(s!=e){a.find(".star").each(function(a,t){targetClass=s<parseInt($(t).data("star"))?"empty":"full",$(t).removeClass("empty full").addClass(targetClass)}),s<4?a.find(".tags-bad").show().siblings(".tags").hide():a.find(".tags-good").show().siblings(".tags").hide();var i,r="selected theme-bg theme-border theme-color-white",d="theme-border-gray theme-grayfont";s<4&&e>3?i=a.find(".tags-good li"):s>3&&e<4&&(i=a.find(".tags-bad li")),i&&(i.removeClass(r).addClass(d),a.find(".id-hidden-tags").val("")),a.find(".star-label").text(n[t.index()+1]),a.find(".id-hidden-star").val(s)}},c=function(t){var s=$(this),n="selected theme-bg theme-border theme-color-white",e="theme-border-gray theme-grayfont",i=a.find(".id-hidden-tags");vals=i.val().split(",").filter(function(a){return""!==a}),s.hasClass(n)?(s.removeClass(n).addClass(e),vals=vals.filter(function(a){return a!=t})):(s.addClass(n).removeClass(e),vals.push(t)),i.val(vals.join(","))},g=function(){var s=a.find(".id-hidden-star").val(),n=a.find(".id-hidden-tags").val(),e=a.find(".id-textarea").val();return s?(a.showLoading("提交中"),void base.ajaxPost("/submit/orderComment",{orderId:r.id,orderNo:r.order_no,star:s,tags:n,comments:e},function(s){0==s.errno?(a.tip("评价成功！"),t.setOrderStatusChanged(!0),a.finishView()):a.alert(s.errmsg),a.hideLoading()})):void a.tip("请选择评价等级")},p=function(a){r=a.order,l()};return{html:e,init:p,onDestory:function(){r=d=null},action_star_tap:m,action_select_tag:c,action_submit:g}}});
/*![m/view_search.js]*/define("m/view_search",["lib/Storage","m/utils","m/main"],function(t,s,i){var e={title:{left:"back",right:"[搜索]",rightTap:"submit",contentHtml:{text:"搜索",placeholder:"请输入商品名称"}},contentHtml:'<div class="main scroller" data-scrollerId="main">\n<div>\n<div class="sug">\n<span class="sug-label">热门搜索</span>\n<ul class="sug-list sug-list-hot cf"></ul>\n<span class="sug-label history-node">历史记录</span>\n<ul class="sug-list sug-list-history cf history-node"></ul>\n<div class="tap-action sug-clear history-node" data-tap="clear">清空历史</div>\n</div>\n<div class="result">\n<div class="result-none-notice result-none-node">\n<h5>暂时没搜到“<span class="search-words"></span>”相关商品</h5>\n您可以更换其他关键词试试看\n</div>\n<div class="result-content">\n<span class="sug-label result-none-node">大家都在买</span>\n<ul class="result-list mod-product-cube  mod-pub-product cf"></ul>\n</div>\n<p class="result-nomore">无更多商品</p>\n</div>\n</div>\n</div>'},a={sugItem:'<li class="sug-item tap-action" data-tap="search|#{name},#{source}">#{name}</li>'},r={INPUT:0,HOT:1,HISTORY:2},n=function(s,i){this.view=s,this.postParam=i,this.storage=new t("search");var e=this.storage.get("history");this.historys=e?e.split(","):[],this.isSearchState=!1};return n.prototype={search:function(t,s){this.isSearchState=!0,this.curIndex=0,this.hasNext=!0,this.query=t,this.source=s,this._addHistory(t),this.view.find(".search-words").text(t),s!=r.INPUT&&this.view.find(".search-query").val(t),this._loadData()},_loadData:function(){if(this.hasNext&&!this.isLoadingData&&this.isSearchState){this.isLoadingData=!0;var t=this;0==this.curIndex?this.view.showLoading("搜索中"):this.view.headerLoading(80),base.ajaxPost("/submit/search",$.extend(this.postParam,{index:t.curIndex,query:t.query,source:t.source}),function(s){return t.isLoadingData=!1,0==t.curIndex?t.view.hideLoading():t.view.headerLoading(100),s.errno?(t.view.tip(s.errmsg),t.hasNext=!1,void(t.hasResult=!1)):s.data&&s.data.activity&&s.data.activity.id?void t.view.changeView("act",{activityObj:s.data.activity}):(t.hasNext=parseInt(s.data.has_next),t.hasResult=1!=s.data.type,t.goods=s.data.goods,t._renderResult(),void(t.curIndex+=1))})}},_renderResult:function(){this.view.removeClass("state-sug"),this.view.addClass("state-result"),this.view.find(".result")[this.hasResult?"removeClass":"addClass"]("result-none"),this.view.find(".result-list")[0==this.curIndex?"html":"append"](s.renderProducts(this.goods)),this.view.find(".result-nomore").css("display",this.hasNext?"none":"block"),this.view.getScroller().refresh(),0==this.curIndex&&this.view.getScroller().scrollTo()},renderSug:function(){this.view.removeClass("state-result"),this.view.addClass("state-sug");var t=this;this.isSearchState=!1,this.view.showLoading(),base.ajaxGet("/data/searchHot",this.postParam,function(s){t.view.hideLoading();var i;s.errno&&(i="水果,精选,饮料,零食".split(",")),i=s.data&&s.data.hotquery?s.data.hotquery:i,i.length=i.length-i.length%3,t._renderLabelList(t.view.find(".sug-list-hot"),i,r.HOT),t._renderLabelList(t.view.find(".sug-list-history"),t.historys,r.HISTORY),t.historys.length?t.view.removeClass("no-history"):t.view.addClass("no-history"),t.view.getScroller().refresh().scrollTo()})},clearHistory:function(){this.view.addClass("no-history"),this.historys=[],this.storage.set("history","")},_renderLabelList:function(t,s,i){var e,r,n=[];for(e=0,r=s.length;e<r;e++)n.push($.formatString(a.sugItem,{name:s[e],source:i}));t.html(n.join(""))},_addHistory:function(t){this.view.removeClass("no-history");var s=!1;return 1==this.historys.length?s=t==this.historys[0]:this.historys.sort(function(i,e){return i==t?(s=!0,-1):e==t?(s=!0,1):0}),s||this.historys.unshift(t),this.historys.length>10&&(this.historys.length=10),this.storage.set("history",this.historys.join(",")),this._renderLabelList(this.view.find(".sug-list-history"),this.historys,r.HISTORY),this.view.getScroller().refresh().scrollTo(),this.historys}},function(t){var s,a=function(t,i){s.search(t,i)},o=function(){var i=$.trim(t.find(".title-form-query").val());i&&(s.search(i,r.INPUT),t.find(".title-form-query")[0].blur())},h=function(e){var a=i.getShop();s=new n(t,{shopId:a.shopId,bigids:a.dealer.bigids}),s.renderSug(),t.bindShoppingOpe(),t.listen(t.getScroller(),"scroll",function(t){s.isSearchState&&this.isBottom(this.wrapperWidth)&&s._loadData()}),t.delegate(".title-form","submit",o),t.delegate(".main",$.tapClick,function(){t.find(".title-form-query")[0].blur()}),t.showCartBtn()},l=function(){s=null};return{html:e,init:h,getTrackId:function(){return"search_action"},onDestory:l,action_search:a,action_submit:o,action_clear:function(){s.clearHistory()}}}});
/*![m/view_verify.js]*/define("m/view_verify",["partner/Partner","m/main"],function(i,n){var e={title:{left:"back",contentHtml:"验证手机"},contentHtml:'<div class="main">\n<form id="autocomplete-form" class="mod-order-common login-form" onsubmit="return false;">\n<div class="pic theme-bg">\n<p class="pic-word">为了方便您及时查询订单信息，鲜蜂侠需要验证您的手机号为查询帐号</p>\n</div>\n<div class="inputs block">\n<div class="padding-small theme-spline spline-bottom">\n<input name="phone" id="autocomplete-phone" class="phone login-input-phone login-input fix-undo" type="tel" placeholder="手机号码" />\n<span class="submit login-send theme-bg">获取验证码</span>\n</div>\n<div class="padding-small">\n<input type="number" class="code login-input-code login-input fix-undo" placeholder="短信验证码" />\n</div>\n</div>\n<p class="login-voice-wrap">收不到短信？使用<span class="ui-bluelink login-voice-link">语音验证码</span></p>\n<div type="button" class="theme-btn-full login-submit">确定</div>\n</form>\n</div>'};return function(t){var o=function(e){var o,l,s=n.getUser();return i.isSupportPartnerLogin()?void((l=s.isSnsLoginFailed())?t.alert("暂时无法为您自动登录"+($.isString(l)?"\n"+l:""),function(){t.finishView({isLogin:!1})}):s.snsLogin(function(i,n){i&&e.targetView?t.replaceView.call(t,e.targetView,e.args):i||!i&&!n?t.finishView({isLogin:i}):t.alert(n,function(){t.finishView({isLogin:i})})})):(s.bindLogin(t.find(".main"),function(){e.targetView?t.replaceView.call(t,e.targetView,e.args):t.finishView({isLogin:!0})}),t.delegate(".login-input","focus",function(){clearTimeout(o),t.find(".pic").addClass("pic-hide")}),t.delegate(".login-input","blur",function(){o=setTimeout(function(){t.find(".pic").removeClass("pic-hide")},2e3)}),void t.find(".header-icon-back").css("display","block"))};return{html:e,init:o}}});
/*![m/view_addon.js]*/define("m/view_addon",["m/utils"],function(t){var n={title:{left:"back",contentHtml:"凑单专区",className:"theme-spline"},contentHtml:'<div class="main">\n<ul class="tabs cf theme-spline"></ul>\n<div class="products-wrap scroller">\n<ul class="products clearfix">\n</ul>\n<p class="nomore" style="display:none">无更多商品</p>\n</div>\n</div>'},e={tab:'<li class="tab tab-#{index} tap-action" data-tap="tabTap|#{index}"" style="width:#{width}" data-log=#{logParams}>#{name}</li>'};return function(a){var r,o,i=[],d=function(){var t=i.map(function(t,n,a){return $.formatString(e.tab,{name:t.tab,index:n,width:100/a.length+"%",logParams:JSON.stringify({actionType:0==r.cart_group_id?"flash_price_range":"tomorrow_price_range",priceId:t.tab})})}).join("");a.find(".tabs").html(t),s(0)},s=function(n){a.find(".tab").removeClass("theme-color theme-border-red-decorate"),a.find(".tab-"+n).addClass("theme-color theme-border-red-decorate");var e=i[n].goods_list;if(e&&e.length){var r=t.renderProducts(e);a.find(".products").html(r),a.find(".nomore").css("display","block")}else a.find(".products").html(t.renderEmptyNotice("暂无相关商品，换个价格试试吧")),a.find(".nomore").css("display","none");o.scrollTo(0,0),o.refresh()},l=function(){a.showLoading(),base.ajaxPost("/data/getAddOnGoods/",r,function(t){0==t.errno?(i=t.data,d()):a.alert(t.errmsg),a.hideLoading()})},c=function(t){r=t,o=a.getScroller(),a.bindShoppingOpe(),a.showCartBtn(),l()};return{html:n,init:c,getTrackId:function(){return"gather_order_action"},action_tabTap:s,onDestory:function(){i=null}}}});
/*![m/view_pointsShop.js]*/define("m/view_pointsShop",["lib/ProgressRing"],function(t){var n={title:{left:"back",contentHtml:"积分商城"},contentHtml:'<div class="main scroller">\n\n</div>'},e={main:'<div class="block">\n<div class="ring-wrap theme-border-gray">\n<p class="theme-grayfont usable-point">可用积分<br/>\n<span class="#{pointsNumClass} usable-point-num">#{usable_point}</span>\n</p>\n</div>\n<ul class="menus cf">\n<li class="menu-detail tap-action theme-border-gray theme-grayfont" data-tap="pointsDetail">积分明细</li><li\nclass="menu-records tap-action theme-border-gray theme-grayfont" data-tap="changeView|pointsCashingRecords" data-log="exchangeRecord">兑换记录</li><li\nclass="menu-rules tap-action theme-border-gray theme-grayfont" data-tap="pointsRules" data-log="pointsRule">积分规则</li>\n</ul>\n</div>\n<ul class="block tickets cf">#{tickets}</ul>',ticket:'<li class="theme-border-gray tap-action" data-id="#{id}" data-tap="ticketDetail" data-log="pointsDetail" style="background-image:url(#{url})">\n<p class="ticket-name">#{name}</p>\n<p class="ticket-price theme-redfont">#{point}积分</p>\n</li>'};return function(i){var a,o,s,c=!1,l=function(){i.headerLoading(80),base.ajaxPost("/data/pointsShop",{},function(n){i.headerLoading(100);var c,l,r,p=$.formatString;0==n.errno?(o=c=n.data.usable_point||0,s=l=n.data.point_ticket||[],r=l.map(function(t){return p(e.ticket,t)}).join(""),i.find(".main").html(p(e.main,{tickets:r,usable_point:c,pointsNumClass:0!=c?"theme-redfont":"theme-grayfont"})),a=new t({appendTo:i.find(".ring-wrap"),size:14,empty:0==c})):i.alert(n.errmsg)})},r=function(t){l()};return{html:n,init:r,getTrackId:function(){return"points_mall_action"},action_pointsDetail:function(){i.changeView("pointsDetail",{usable_point:o})},action_pointsRules:function(){i.changeView("iframe",{title:"积分规则",url:"/show/pointRule",webview:!1})},action_ticketDetail:function(){for(var t,n=$(this).data("id"),e=0;e<s.length;e++)if(n==s[e].id){t=s[e];break}i.changeView("pointsTicket",{ticket:t})},onDestory:function(){a=null},onResume:function(t,n){"pointsTicket"==t&&n&&n.cashSuccess&&(c=!0,l())},onBeforeBack:function(){if(c)return i.finishView({pointsChanged:!0}),!1}}}});
/*![m/view_pointsDetail.js]*/define("m/view_pointsDetail",["lib/ProgressRing","m/utils"],function(e,t){var i={title:{left:"back",contentHtml:"积分明细"},contentHtml:'<div class="main">\n<div class="header"></div>\n<div class="scroller"></div>\n</div>'},n={header:'<div class="tip-notice-closable tap-action #{hideNoticeClass}" data-tap="closeNotice">#{clear_remind}</div>\n<div class="ring-wrap theme-border-gray">\n<p class="theme-grayfont usable-point">当前积分<br/>\n<span class="#{pointsNumClass} usable-point-num">#{usable_point}</span>\n</p>\n</div>',scrollContent:'<div>\n<div class="details">\n<div class="details-title title-legend theme-border-gray-decorate">积分详情</div>\n<ul class="details-list">#{details}</ul>\n</div>\n#{emptyNotice}\n</div>',detail:'<li class="details-item theme-border-gray spline-bottom tap-action" data-tap="ticketDetail|#{id}">\n<div class="row">\n<div class="details-item-title">#{title}</div>\n<div class="details-item-points theme-redfont">#{point}</div>\n</div>\n<div class="row theme-grayfont">\n<div class="details-item-content">#{content}</div>\n<div class="details-item-time">#{app_time}</div>\n</div>\n</li>'};return function(a){var s,l,d=function(){a.headerLoading(80),base.ajaxPost("/data/pointsDetail",{},function(i){a.headerLoading(100);var d,o=$.formatString;if(0==i.errno){d=i.data.list||[],0==d.length&&a.find(".main").addClass("empty");var r=l.usable_point,c={details:d.map(function(e){return o(n.detail,e)}).join(""),emptyNotice:d.length>0?"":t.renderEmptyNotice("还没有积分哦，赶快去购物吧~"),usable_point:r,pointsNumClass:0==r?"theme-grayfont":"theme-redfont",hideNoticeClass:i.data.clear_remind?"":"notice-hide"};a.find(".header").html(o(n.header,c,i.data)),a.find(".scroller").html(o(n.scrollContent,c,i.data)),a.getScroller().refresh(),s=new e({appendTo:a.find(".ring-wrap"),size:14,empty:0==l.usable_point})}else a.alert(i.errmsg)})},o=function(e){l=e,d()};return{html:i,init:o,action_closeNotice:function(){$(this).css("display","none"),a.getScroller().refresh()},onDestory:function(){s=null}}}});
/*![m/view_pointsCashingRecords.js]*/define("m/view_pointsCashingRecords",["m/utils"],function(e){var n={title:{left:"back",contentHtml:"兑换记录"},contentHtml:'<div class="main scroller">\n</div>'},t={record:'<li class="record theme-border-gray spline-bottom">\n<div class="inner">\n<div class="row">\n<div class="record-title">#{exchange_title}</div>\n<div class="record-costs theme-redfont">#{point}</div>\n</div>\n<div class="record-content theme-grayfont">#{exchange_content}</div>\n<div class="record-time theme-grayfont">#{app_time}</div>\n</li>\n</div>'};return function(r){var i=function(n){r.headerLoading(80),base.ajaxPost("/data/pointsCashingRecords",{},function(n){r.headerLoading(100);var i,o=e.renderEmptyNotice("您还没有兑换过商品哦~");0==n.errno?(i=n.data.list||[],i.length&&(o=i.map(function(e){return $.formatString(t.record,e)}).join(""),o='<ul class="records">'+o+"</ul>"),r.find(".main").html(o),r.getScroller().refresh()):r.alert(n.errmsg)})};return{html:n,init:i}}});
/*![m/view_pointsTicketCash.js]*/define("m/view_pointsTicketCash",["common/Dialog"],function(n){var a={title:{left:"back",contentHtml:"积分券兑换"},contentHtml:'<div class="main scroller">\n\n</div>'},t={main:'<div class="theme-border-gray">\n<div class="usable_point spline-bottom theme-grayfont theme-border-gray">当前可用积分：<span>#{usable_point}</span></div>\n<ul class="ticketList">#{tickets}</ul>\n</div>',ticket:'<li class="ticket tap-action" data-tap="cash|#{id}">\n<div class="value">\n<span class="value-inner theme-bg">\n<span class="unit">￥</span>#{value}\n</span>\n</div>\n<div class="layout-center">\n<span class="cost">需#{point}积分</span>\n<span class="description theme-grayfont">#{description}</span>\n</div>\n<div class="split"></div>\n<span class="btn-cash">立<br/>即<br/>兑<br/>换</span>\n</li>'};return function(n){var i,s=function(){n.headerLoading(80),base.ajaxPost("/data/pointsShop",{},function(a){n.headerLoading(100);var s,e,o,r=$.formatString;0==a.errno?(s=a.data.usable_point||0,0==s&&n.find(".main").addClass("disabled"),i=e=a.data.point_ticket||[],o=e.map(function(n){return r(t.ticket,{value:parseInt(n.value,10)},n)}).join(""),n.find(".main").html(r(t.main,{tickets:o,usable_point:s}))):n.alert(a.errmsg)})},e=function(a){if(!n.find(".main").hasClass("disabled")){var t=i.filter(function(n){return n.id==a})[0];if(t){var s="积分兑换<br/>此次需要消耗"+t.point+"积分，确认兑换吗？";n.confirm(s,function(){n.showLoading(),base.ajaxPost("/submit/pointsTicketCash",{id:a},function(a){n.hideLoading(),setTimeout(function(){var i=a.errmsg;return 0==a.errno&&200==a.data.code?(i="兑换成功！<br/>已成功兑换一张"+t.name+"，可在我的优惠券中查看",void n.alert(i,function(){n.finishView({ticket:a.data.data.coupon_info})},"朕知道了")):0==a.errno&&200!=a.data.code?(i=a.data.msg,void n.tip(i)):void n.alert(i,"朕知道了")},500)})})}}},o=function(n){s()};return{html:a,init:o,action_cash:e}}});
/*![m/view_pointsRules.js]*/define("m/view_pointsRules",["lib/ProgressRing"],function(t){var n={title:{left:"back",contentHtml:"积分商城"},contentHtml:'<div class="main scroller">\n\n</div>'},e={main:'<div class="block">\n<div class="ring-wrap theme-border-gray">\n<p class="theme-grayfont usable-point">可用积分<br/>\n<span class="theme-redfont usable-point-num">#{usable_point}</span>\n</p>\n</div>\n<ul class="menus cf">\n<li class="menu-detail tap-action theme-border-gray theme-grayfont" data-tap="changeView|pointsDetail">积分明细</li><li\nclass="menu-records tap-action theme-border-gray theme-grayfont" data-tap="changeView|pointsCashingRecords">兑换记录</li><li\nclass="menu-rules tap-action theme-border-gray theme-grayfont" data-tap="changeView|pointsRules">积分规则</li>\n</ul>\n</div>\n<ul class="block tickets cf">#{tickets}</ul>',ticket:'<li class="theme-border-gray tap-action" data-tap="ticketDetail|#{id}"\nstyle="background-image:url(#{url})">\n<p class="ticket-name">#{name}</p>\n<p class="ticket-price theme-redfont">#{point}积分</p>\n</li>'};return function(a){var i,s=function(){base.ajaxPost("/data/pointsShop",{},function(n){var s,r,l,o=$.formatString;0==n.errno&&(s=n.data.usable_point||0,r=n.data.point_ticket||[],l=r.map(function(t){return o(e.ticket,t)}).join(""),a.find(".main").html(o(e.main,{tickets:l,usable_point:s})),i=new t({appendTo:a.find(".ring-wrap"),size:14}),a.getScroller.refresh())})},r=function(t){s()};return{html:n,init:r,onDestory:function(){i=null}}}});
/*![m/view_pointsTicket.js]*/define("m/view_pointsTicket",["common/Dialog"],function(t){var n={title:{left:"back",contentHtml:"加载中"},contentHtml:'<div class="main scroller">\n\n</div>'},e={main:'<div class="block">\n<div class="ticket-img theme-border-gray" style="background-image:url(#{url})"></div>\n<div class="theme-border-gray cash-wrap">\n<span class="costs theme-redfont">#{point}积分</span>\n<span class="btn-cash #{enableClass} tap-action" data-tap="cash" data-log="exchange">#{cashBtnText}</span>\n</div>\n<dl class="theme-grayfont ticket-meta">\n<dt>商品名称:</dt>\n<dd>#{name}</dd>\n<dt>兑换流程</dd>\n<dd>#{flow}</dd>\n<dt>注意事项:</dt>\n<dd>#{declare}</dd>\n</dl>\n<dl class="important">\n<dt class="theme-border-gray-decorate">重要说明</dt>\n<dd class="theme-border-gray theme-grayfont">#{important_note}</dd>\n</dl>\n</div>'};return function(t){var a,i=function(){var n=$.formatString(e.main,{flow:a.flow.split("\n").join("<br/>"),declare:a.declare.split("\n").join("<br/>"),important_note:a.important_note.split("\n").join("<br/>"),enableClass:1==a.enable_point_exch?"theme-bg":"theme-bg-gray disabled",cashBtnText:1==a.enable_point_exch?"立即兑换":"积分不足"},a);t.find(".main").html(n),t.setTitle(a.name),t.getScroller().refresh()},d=function(){if(!$(this).hasClass("disabled")){var n="积分兑换<br/>此次需要消耗"+a.point+"积分，确认兑换吗？";t.confirm(n,function(){t.showLoading(),base.ajaxPost("/submit/pointsTicketCash",{id:a.id},function(n){t.hideLoading(),setTimeout(function(){var e=n.errmsg;return 0==n.errno&&200==n.data.code?(e="兑换成功！<br/>已成功兑换一张"+a.name+"，可在我的优惠券中查看",void t.alert(e,function(){t.finishView({cashSuccess:!0})},"朕知道了")):0==n.errno&&200!=n.data.code?(e=n.data.msg,void t.tip(e)):void t.alert(e,"朕知道了")},500)})})}},o=function(t){a=t.ticket,i()};return{html:n,init:o,getTrackId:function(){return"points_detail_action"},action_cash:d}}});
/*![m/view_member.js]*/define("m/view_member",function(){var e={title:{left:"back",contentHtml:"会员中心"},contentHtml:'<div class="main scroller">\n\n</div>'},t={1:"成长值",2:"成长攻略",3:"特权",4:"会员等级说明"},s={main:'<div>\n<div class="tip-notice">#{level_time}</div>\n<div class="header">\n<div class="profile"></div>\n<p class="currentPoints">#{current_score}／#{last_score}</p>\n<div class="levels">\n<div class="levels-axis1"><div class="progress theme-bg"></div></div>\n<div class="levels-iScroller">\n<div class="levels-list cf">\n<div class="progress theme-bg"><div class="before theme-bg"></div></div>\n#{levels}\n</div>\n</div>\n</div>\n<p class="">#{dif_score}</p>\n</div>\n<div class="strategies">\n<div class="strategies-title title-legend theme-border-gray-decorate">会员攻略</div>\n<ul class="strategies-list">#{strategies}</ul>\n</div>\n</div>',strategy:'<li class="strategy strategy-types#{types} theme-border-gray tap-action" data-tap="toggleStrategy">\n<p class="strategy-name">#{name}</p>\n<p class="strategy-content theme-grayfont">#{contents}</p>\n</li>',level:'<span class="levels-item" data-start="#{lower_bound}">#{name}</span>'};return function(n){var l,i,r,a,o,d=function(){for(var e=o[o.length-1],t=1;t<o.length;t++){var s=parseInt(o[t].lower_bound);if(a<s){e=o[t-1];break}}return e},c=function(){function e(){var e=s.position().left,v=d(),p=parseInt(v.id)-1,f=e;t.eq(0).addClass("theme-bg animate-pulse"),function(d){var g=function(){0!=n.find(".levels-iScroller").size()&&(i=new iScroll(n.find(".levels-iScroller")[0],{hScroll:!0,vScroll:!1,bounce:!1,hideScrollbar:!0}),s.css("left",e),n.find(".levels-iScroller .progress").width(e-f+l/2),n.find(".levels-iScroller .progress .before").css({width:c/2-l/2,left:l/2-c/2,display:"block"}),n.find(".levels-axis1 .progress").css("display","none"),i.scrollTo(f-e,0,0))};if(d>p){if(d==o.length)return void g();var m=(a-parseInt(v.lower_bound))/(parseInt(o[p+1].lower_bound)-parseInt(v.lower_bound));return f-=m*r,void s.animate({translate3d:f-e+"px, 0, 0"},{duration:700*m,complete:function(){g()}})}var u=t.eq(d);f=e-u.position().left;var h=arguments.callee;s.animate({translate3d:-u.position().left+"px, 0, 0"},{duration:700,complete:function(){u.addClass("theme-bg animate-pulse"),h(d+1)}})}(1)}var t=n.find(".levels-item"),s=n.find(".levels-list"),l=t.width(),r=l+120,c=$("body").width();t=t.css("marginRight",r-l),s.width(r*o.length-r+c),n.find(".levels-axis1 .progress").animate({width:"50%"},{duration:700,complete:e})},v=function(){var e,i,d,v,p=$.formatString,f=r;a=parseInt(f.current_score),o=e=f.level||[],i=f.strategy||[],d=e.map(function(e){return p(s.level,e)}).join(""),v=i.map(function(e){var n=e.contents.split("\n").join("<br/>");return p(s.strategy,{name:t[e.types],contents:n},e)}),n.find(".main").html(p(s.main,{levels:d,strategies:v},f)),l.refresh(),c()},p=function(){var e=$(this);e.hasClass("expand")?e.removeClass("expand"):e.addClass("expand")},f=function(e){l=n.getScroller(),r=e.member,v()};return{html:e,init:f,action_toggleStrategy:p,onDestory:function(){i&&i.destroy()}}}});
/*![m/view_goodsFavorite.js]*/define("m/view_goodsFavorite",["m/main","m/utils","m/GoodsFavorite"],function(t,e,n){var i={title:{left:"back",contentHtml:"商品收藏",right:"[编辑]",rightTap:"edit"},contentHtml:'<div class="main scroller">\n<div>'},s={main:'<ul class="scroller-inner products">\n#{products}\n</ul>\n<div class="footer spline-top theme-border-gray">\n<span class="selectAll tap-action" data-tap="selectAll">全选</span>\n<span class="theme-btn tap-action" data-tap="delete">删除</span>\n</div>',product:'<div class="product-item-wrap spline-list #{selectedClass} theme-border-gray tap-action" data-tap="select|#{col_id}" >\n<span class="checkbox"></span>\n#{product}\n</div>'};return function(a){var l=[],o=!1,c=[],r=function(){l.length<1||(o=!o,c=[],f())},d=function(t){if(o){var e=!$(this).hasClass("selected");e?c.indexOf(t)<0&&c.push(t+""):c=c.filter(function(e){return e!=t}),f()}},u=function(){if(o){var t=!$(this).hasClass("selected");c=t?l.map(function(t){return t.col_id}):[],f()}},p=function(){n.remove({ids:c.join(","),zchtid:t.getShop().shopId,type:1})},f=function(){var t,n=$.formatString;return l.length<1?(a.find(".main").html(e.renderEmptyNotice("还没有收藏商品哦")),void a.find(".header-right").css("display","none")):(t=n(s.main,{products:l.map(function(t){return n(s.product,{selectedClass:c.indexOf(t.col_id)>=0?"selected":"",product:e.renderProducts(t,{isPortrait:!1,itemDetail:!0})},t)}).join("")}),a.find(".main").html(t)[o?"addClass":"removeClass"]("editStatus"),a.find(".header-right").css("display","block").text(o?"完成":"编辑"),a.find(".mod-product-item")[o?"removeClass":"addClass"]("tap-action"),a.find(".selectAll")[c.length==l.length?"addClass":"removeClass"]("selected"),void a.getScroller().refresh())},m=function(){a.isShowing()&&(l=n.getList(),c=c.filter(function(t){return n.has(t)}),f())},h=function(){n.init(),m(),a.listen(n,"change",function(){m()})};return{init:h,html:i,onResume:m,action_edit:r,action_select:d,action_selectAll:u,action_delete:p}}});
